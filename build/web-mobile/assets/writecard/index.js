window.__require=function t(e,n,r){function o(a,c){if(!n[a]){if(!e[a]){var s=a.split("/");if(s=s[s.length-1],!e[s]){var d="function"==typeof __require&&__require;if(!c&&d)return d(s,!0);if(i)return i(s,!0);throw new Error("Cannot find module '"+a+"'")}a=s}var p=n[a]={exports:{}};e[a][0].call(p.exports,function(t){return o(e[a][1][t]||t)},p,p.exports,t,e,n,r)}return n[a].exports}for(var i="function"==typeof __require&&__require,a=0;a<r.length;a++)o(r[a]);return o}({lettertracingbackcard:[function(t,e,n){"use strict";cc._RF.push(e,"acec3FaEClIN4cjiOVY6VX8","lettertracingbackcard");var r=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__decorate||function(t,e,n,r){var o,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(a=(i<3?o(a):i>3?o(e,n,a):o(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0}),n.LetterTracingBackCard=void 0;var i=cc._decorator.ccclass,a=cc.Color,c=t("../../../common/scripts/util"),s=t("./writecard"),d=t("../../../common/scripts/helper"),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._sound=null,e._textNode=null,e}return r(e,t),e.prototype.onLoad=function(){var t=this;this._WriteCard=this.node.parent.getComponent(s.WriteCard);var e=this.node.getChildByName("imageFace");null!=e&&(this._image=e.getChildByName("image")),this._textNode=this.node.getChildByName("textNode"),this.node.parent.on(d.CONFIG_LOADED,function(){t._optionText=t._WriteCard.currentConfig.options[t.optionIndex];var e=t._WriteCard.currentConfig.images[t.optionIndex],n=t._WriteCard.currentConfig.sounds[t.optionIndex];t._textNode.getComponent(cc.Label).string=t._optionText,t._textNode.color=d.DEFAULT_FONT_COLOR,t.loadImage(e),t.loadSounds(n)})},e.prototype.loadImage=function(t){var e=this;t&&c.Util.loadTexture(t,function(t){t&&(e._image.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t))})},e.prototype.loadSounds=function(t){var e=this;c.Util.loadGameSound(t.toLowerCase(),function(t){e._sound=t,e.node.emit("soundLoaded")})},Object.defineProperty(e.prototype,"optionIndex",{get:function(){return this._optionIndex},set:function(t){this._optionIndex=t},enumerable:!1,configurable:!0}),e.prototype.animateText=function(){(new cc.Tween).target(this._textNode).to(.1,{color:a.RED},{progress:null,easing:"sineOut"}).to(.15,{scale:1.25},{progress:null,easing:"sineOut"}).to(.15,{scale:1},{progress:null,easing:"sineOut"}).to(.1,{color:d.DEFAULT_FONT_COLOR},{progress:null,easing:"sineOut"}).start()},e.prototype.pronounce=function(){this._sound&&(this._soundID=c.Util.play(this._sound,!1))},e.prototype.onDestroy=function(){cc.audioEngine.stopAllEffects()},e=o([i],e)}(cc.Component);n.LetterTracingBackCard=p,cc._RF.pop()},{"../../../common/scripts/helper":void 0,"../../../common/scripts/util":void 0,"./writecard":"writecard"}],lettertracingfrontcard:[function(t,e,n){"use strict";cc._RF.push(e,"a753819skdEkpyGIbDDs8N8","lettertracingfrontcard");var r=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__decorate||function(t,e,n,r){var o,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(a=(i<3?o(a):i>3?o(e,n,a):o(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0}),n.LetterTracingFrontCard=void 0;var i=cc._decorator.ccclass,a=cc._decorator.property,c=t("./writecard"),s=t("../../../common/scripts/util"),d=t("../../../common/scripts/helper"),p=t("../../../common/Tracing/scripts/tracing-container"),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._tracingContainer=null,e._traceGraphics=null,e._sound=null,e}return r(e,t),e.prototype.onLoad=function(){var t=this;this._WriteCard=this.node.parent.getComponent(c.WriteCard),this._tracingContainer=cc.instantiate(this.tracingContainerPrefab),this.node.parent.on(d.CONFIG_LOADED,function(){t.setAlphabetToDisplay(t._WriteCard.currentConfig.traceText),t.loadSounds(t._WriteCard.currentConfig.traceText),t.subScribeToTracingEvents()})},e.prototype.subScribeToTracingEvents=function(){var t=this;this.node.on(d.TRACING_FINISHED,function(e){e.stopPropagation(),t.tracingFinished()}),this.node.on(d.TRACING_CORRECT,function(e){e.stopPropagation(),t.node.parent.emit("correct")}),this.node.on(d.TRACING_WRONG,function(e){e.stopPropagation(),t.node.parent.emit("wrong")})},e.prototype.setAlphabetToDisplay=function(t){var e=this;this._tracingContainerComponent=this._tracingContainer.getComponent(p.default),this._tracingContainerComponent.tracingLetter=t,this._tracingContainerComponent.traceGenerationMode=!1,this.node.addChild(this._tracingContainer),this._tracingContainer.setPosition(new cc.Vec2(-256,-350)),this._tracingContainer.zIndex=100,this._traceGraphics=this._tracingContainerComponent.traceGraphics,this._tracingContainerComponent._traceGraphicsComponent.adjustedScale=c.LETTER_TRACING_CARD_SCALE,this.node.on("cardEnabled",function(t){e._optionIndex===t&&e._traceGraphics.emit("enabledGraphics")})},e.prototype.loadSounds=function(t){var e=this;s.Util.loadsLetter(t.toLowerCase(),function(t){e._sound=t,e.node.emit("soundLoaded")})},e.prototype.pronounce=function(){try{this._sound&&(this._soundID=s.Util.play(this._sound,!1))}catch(t){}},e.prototype.tracingFinished=function(){var t=this;this.pronounce(),this.clearGraphics(),this.scheduleOnce(function(){var e=new cc.Event.EventCustom(c.LETTER_TRACING_CARD_EVENT,!0);e.setUserData({elementIndex:t.optionIndex}),t.node.dispatchEvent(e)},1)},e.prototype.clearGraphics=function(){this._tracingContainerComponent._traceGraphicsComponent.clear()},e.prototype.onDestroy=function(){cc.audioEngine.stopAllEffects()},Object.defineProperty(e.prototype,"optionIndex",{get:function(){return this._optionIndex},set:function(t){this._optionIndex=t},enumerable:!1,configurable:!0}),o([a(cc.Prefab)],e.prototype,"tracingContainerPrefab",void 0),e=o([i],e)}(cc.Component);n.LetterTracingFrontCard=u,cc._RF.pop()},{"../../../common/Tracing/scripts/tracing-container":void 0,"../../../common/scripts/helper":void 0,"../../../common/scripts/util":void 0,"./writecard":"writecard"}],writecard:[function(t,e,n){"use strict";cc._RF.push(e,"26b91PcY09KPpsuUF+lBa66","writecard");var r=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__decorate||function(t,e,n,r){var o,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(a=(i<3?o(a):i>3?o(e,n,a):o(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0}),n.WriteCard=n.LETTER_TRACING_CARD_EVENT=n.LETTER_TRACING_CARD_SCALE=void 0;var i=cc._decorator.ccclass,a=cc._decorator.property,c=t("../../../common/scripts/lib/config"),s=t("./lettertracingbackcard"),d=t("./lettertracingfrontcard"),p=t("../../../common/scripts/lib/error-handler"),u=t("../../../common/scripts/helper");n.LETTER_TRACING_CARD_SCALE=.85,n.LETTER_TRACING_CARD_EVENT="hideFrontCardAndShowBackCard";var l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._letterTracingCardContainer=null,e._frontCard=null,e._backCard=null,e._frontCards=[],e._backCards=[],e}return r(e,t),e.prototype.onLoad=function(){var t=this;cc.director.getCollisionManager().enabled=!1,this._currentConfig=this.processConfiguration(c.default.getInstance().data[0]),this.node.on(n.LETTER_TRACING_CARD_EVENT,function(e){e.stopPropagation();var n=e.getUserData();t.hideFrontCardAndShowBackCard(n)}),this.buildUI()},e.prototype.buildUI=function(){if(null!==this._currentConfig){console.log("current config",this._currentConfig),this._letterTracingCardContainer=this.node,this._letterTracingCardContainer.scale*=n.LETTER_TRACING_CARD_SCALE,this.node.width=cc.winSize.width,this.node.height=cc.winSize.height;for(var t=this._currentConfig.options.length||0,e=0;e<t;e++)this.renderCard(e);this.node.emit(u.CONFIG_LOADED);var r=this.node.getChildByName(this._originalFrontCardName+"0");this.emitCardEnabledEvent(r,0)}},e.prototype.renderCard=function(t){this._frontCard=cc.instantiate(this.frontCardPrefab),this._originalFrontCardName=this._frontCard.name,this._frontCard.name=this._frontCard.name+t,this._frontCard.getComponent(d.LetterTracingFrontCard).optionIndex=t,this._backCard=cc.instantiate(this.backCardPrefab),this._originalBackCardName=this._backCard.name,this._backCard.name=this._backCard.name+t,this._backCard.getComponent(s.LetterTracingBackCard).optionIndex=t,this.node.addChild(this._frontCard),this.node.addChild(this._backCard),this._backCard.active=!1,this._frontCard.opacity=0===t?255:0,this._frontCard.setPosition(0,0),this._backCard.setPosition(0,0),this._frontCards.push(this._frontCard),this._backCards.push(this._backCard)},e.prototype.emitCardEnabledEvent=function(t,e){t.opacity=255,t.emit("cardEnabled",e)},e.prototype.processConfiguration=function(t){void 0===t&&(t=[]);var e=[].concat.apply([],t),n=e[0],r=e[1],o=e[2],i=e[3],a=e[4],c=e[5],s=e[6],d=e[7],p=e[8],u=e[9];return{level:n,workSheet:r,problemNo:o,traceText:i,options:[a,d,e[10]],images:[c,p,e[11]],sounds:[s,u,e[12]]}},Object.defineProperty(e.prototype,"currentConfig",{get:function(){return this._currentConfig},enumerable:!1,configurable:!0}),e.prototype.hideFrontCardAndShowBackCard=function(t){var e=this,n=t.elementIndex,r=this.node.getChildByName(this._originalFrontCardName+n),o=this.node.getChildByName(this._originalBackCardName+n);(new cc.Tween).target(r).to(.5,{opacity:0},{progress:null,easing:"sineOut"}).call(function(){o.active=!0,o.scale=0,(new cc.Tween).target(o).to(.5,{scale:1},{progress:null,easing:"sineOut"}).call(function(){o.getComponent(s.LetterTracingBackCard).animateText(),o.getComponent(s.LetterTracingBackCard).pronounce(),e.scheduleOnce(function(){r.active=!1,(new cc.Tween).target(o).to(.2,{opacity:255,scale:.75},{progress:null,easing:"quintInOut"}).then((new cc.Tween).to(.2,{opacity:255,scale:.5},{progress:null,easing:"cubicInOut"})).then((new cc.Tween).to(.2,{opacity:255,scale:.25},{progress:null,easing:"cubicInOut"})).then((new cc.Tween).to(.2,{opacity:255,scale:0},{progress:null,easing:"cubicInOut"})).call(function(){if(o.active=!1,n<e._currentConfig.options.length-1){var t=e.node.getChildByName(e._originalFrontCardName+(n+1));e.emitCardEnabledEvent(t,n+1)}else e.node.emit("nextProblem")}).start()},1)}).start()}).start()},o([a(cc.Prefab)],e.prototype,"frontCardPrefab",void 0),o([a(cc.Prefab)],e.prototype,"backCardPrefab",void 0),o([p.default()],e.prototype,"onLoad",null),o([p.default()],e.prototype,"buildUI",null),o([p.default()],e.prototype,"renderCard",null),o([p.default()],e.prototype,"emitCardEnabledEvent",null),e=o([i],e)}(cc.Component);n.WriteCard=l,cc._RF.pop()},{"../../../common/scripts/helper":void 0,"../../../common/scripts/lib/config":void 0,"../../../common/scripts/lib/error-handler":void 0,"./lettertracingbackcard":"lettertracingbackcard","./lettertracingfrontcard":"lettertracingfrontcard"}]},{},["lettertracingbackcard","lettertracingfrontcard","writecard"]);