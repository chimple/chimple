window.__require=function t(e,o,n){function r(a,c){if(!o[a]){if(!e[a]){var s=a.split("/");if(s=s[s.length-1],!e[s]){var l="function"==typeof __require&&__require;if(!c&&l)return l(s,!0);if(i)return i(s,!0);throw new Error("Cannot find module '"+a+"'")}a=s}var u=o[a]={exports:{}};e[a][0].call(u.exports,function(t){return r(e[a][1][t]||t)},u,u.exports,t,e,o,n)}return o[a].exports}for(var i="function"==typeof __require&&__require,a=0;a<n.length;a++)r(n[a]);return r}({"answer-grid":[function(t,e,o){"use strict";cc._RF.push(e,"efe32Be6zlNM4Qf/FTLzyS9","answer-grid");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.HELP_BTN=o.CONFIRM_BUTTON_CLICKED=o.CLEAR_BUTTON_CLICKED=o.ANSWER_GRID_BUTTON_CLICKED=o.NUMBER_LABEL=o.BACK_GROUND=void 0;var i=cc._decorator.ccclass,a=cc._decorator.property,c=t("./lib/error-handler");o.BACK_GROUND="Background",o.NUMBER_LABEL="numberLabel",o.ANSWER_GRID_BUTTON_CLICKED="ANSWER_GRID_BUTTON_CLICKED",o.CLEAR_BUTTON_CLICKED="CLEAR_BUTTON_CLICKED",o.CONFIRM_BUTTON_CLICKED="CONFIRM_BUTTON_CLICKED",o.HELP_BTN="HELP_BTN";var s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.numberBtnPrefab=null,e.numberpads=[],e.delay=2,e.result=null,e.correctBtns=[],e}return n(e,t),e.prototype.onLoad=function(){},e.prototype.start=function(){this.createGrid(this.delay)},e.prototype.createGrid=function(t){var e=this;void 0===t&&(t=2),this.addDummyBtn(this.node,null);for(var n=0;n<=this.numberpads.length-1;n++)this.addNumberBtn(this.node,this.numberpads[n]),0==n&&this.addDummyBtn(this.node,null);this.scheduleOnce(function(){if(null!==e.correctBtns&&e.correctBtns.length>0){var t=new cc.Event.EventCustom(o.HELP_BTN,!0);t.setUserData({helpNodes:e.correctBtns}),e.node.dispatchEvent(t)}},t)},e.prototype.addNumberBtn=function(t,e){var n=cc.instantiate(this.numberBtnPrefab),r=n.getChildByName(o.BACK_GROUND);if(r){var i=r.getChildByName(o.NUMBER_LABEL),a=i.getComponent(cc.Label);i.color=(new cc.Color).fromHEX("#654321"),a.string=e,i.addComponent(cc.LabelOutline).width=2}if(t.addChild(n),this.result&&this.result.includes(e)){var c=this.result.indexOf(e);this.correctBtns.splice(c,0,n)}},e.prototype.addDummyBtn=function(t,e){var o=new cc.Node;t.addChild(o)},r([a(cc.Prefab)],e.prototype,"numberBtnPrefab",void 0),r([c.default()],e.prototype,"start",null),r([c.default()],e.prototype,"createGrid",null),r([c.default()],e.prototype,"addNumberBtn",null),r([c.default()],e.prototype,"addDummyBtn",null),e=r([i],e)}(cc.Component);o.default=s,cc._RF.pop()},{"./lib/error-handler":"error-handler"}],"arrow-node":[function(t,e,o){"use strict";cc._RF.push(e,"59fe67aM39CLrMyO7fbCg85","arrow-node");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator.ccclass,a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.currentPath=null,e.arrowValue=0,e.starCounter=0,e.location=null,e}return n(e,t),e.prototype.onEnable=function(){cc.director.getCollisionManager().enabled=!0},e=r([i],e)}(cc.Component);o.default=a,cc._RF.pop()},{}],"auto-drag":[function(t,e,o){"use strict";cc._RF.push(e,"3b63fCgv6BHronsT9XJa36c","auto-drag");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var i=t("./drag"),a=t("./drop"),c=cc._decorator,s=c.ccclass,l=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._originalPosition=null,e._isDragging=!1,e.match=!1,e.matchingNode=null,e._dropObject=null,e}return n(e,t),e.prototype.onLoad=function(){this.node.on("touchstart",this.onTouchStart,this),this.node.on("touchend",this.onTouchEnd,this),this.node.on("touchcancel",this.onTouchEnd,this)},e.prototype.onTouchStart=function(t){i.default.letDrag&&!this.isDragging&&this.allowDrag&&(this._originalPosition=this.node.position,this.updateDropNode())},e.prototype.findMatch=function(){var t=this;this.match?(this.allowDrag=!1,this._isDragging=!1,(new cc.Tween).target(this.node).to(.3,{position:this.node.parent.convertToNodeSpaceAR(this.matchingNode.convertToWorldSpaceAR(cc.Vec2.ZERO))},null).call(this.onMatchOver.bind(this)).start()):this.returnBackOnNoMatch?(new cc.Tween).target(this.node).to(1,{position:this._originalPosition},{progress:null,easing:"sineOut"}).call(function(){t.allowDrag=!0,t._isDragging=!1,i.default.letDrag=!0}).call(this.onMatchFail.bind(this)).start():(this.allowDrag=!0,i.default.letDrag=!0,this._isDragging=!1)},e.prototype.onCollisionEnter=function(t,e){this.allowDrag&&!this.isDragging&&this.collisionEnterCondition(e,t)&&t.node.getComponent(a.default).allowDrop&&(this.match=!0,this.matchingNode=t.node)},e.prototype.onTouchEnd=function(t){var e=this;this.allowDrag&&!this._isDragging&&null!==this._dropObject&&(this._isDragging=!0,(new cc.Tween).target(this.node).to(.3,{position:this.node.parent.convertToNodeSpaceAR(this._dropObject.convertToWorldSpaceAR(cc.Vec2.ZERO))},null).call(function(){e.findMatch()}).start())},e.prototype.updateDropNode=function(){this._dropObject=this.findDropNode()},e.prototype.disableTouch=function(){this.node.off("touchstart",this.onTouchStart,this),this.node.off("touchend",this.onTouchEnd,this),this.node.off("touchcancel",this.onTouchEnd,this)},e.prototype.onDestroy=function(){this.node.off("touchstart",this.onTouchStart,this),this.node.off("touchend",this.onTouchEnd,this),this.node.off("touchcancel",this.onTouchEnd,this)},e.prototype.onMatchOver=function(){if(i.default.letDrag=!0,this.allowDrag=!1,this.fixOnMatch){var t=this.matchingNode;this.node.opacity=0,this.node.removeFromParent(!1),this.node.position=cc.Vec2.ZERO,t.addChild(this.node),t.getComponent(a.default).onMatchOver()}else this.allowDrag=!0},e.prototype.onMatchFail=function(){},e=r([s],e)}(i.default));o.default=l,cc._RF.pop()},{"./drag":"drag","./drop":"drop"}],balloon:[function(t,e,o){"use strict";cc._RF.push(e,"eda288WiitPBJHPq4tfrMas","balloon");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.BalloonType=o.MATHS_GAMES=o.LITERACY_GAMES=void 0;var i=t("./lib/config"),a=t("./util"),c=cc._decorator,s=c.ccclass,l=c.property;o.LITERACY_GAMES="literacy",o.MATHS_GAMES="maths";var u,d=!0;(function(t){t[t.Game=0]="Game",t[t.Type=1]="Type"})(u=o.BalloonType||(o.BalloonType={}));var p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.game=null,e.seat=null,e.image=null,e.icon=null,e.chimp=null,e.doneIcon=null,e.done=!1,e.waitingIcon=null,e.waiting=!1,e.glow=null,e.stars=null,e.appearAudio=null,e._color=null,e.onClickCallback=null,e.level=0,e.stopZigzag=!1,e.type=u.Game,e}return n(e,t),e.prototype.onLoad=function(){var t=this;i.default.i;d=!0,this.done||null==this.doneIcon||(this.doneIcon.active=!1),this.type==u.Type&&("en"==this.game?(this.label.string="English",this._color=(new cc.Color).fromHEX("#FFD141")):"hi"==this.game?(this.label.string="\u0939\u093f\u0928\u094d\u0926\u0940",this._color=(new cc.Color).fromHEX("#5E9C46")):"en-maths"==this.game?(this.label.string="Maths",this._color=(new cc.Color).fromHEX("#6A5AAB")):"hi-maths"==this.game?(this.label.string="\u0917\u0923\u093f\u0924",this._color=(new cc.Color).fromHEX("#6A5AAB")):"ur"==this.game?(this.label.string="\u0627\u0631\u062f\u0648",this._color=(new cc.Color).fromHEX("#5E9C46")):"ur-maths"==this.game&&(this.label.string="\u0631\u06cc\u0627\u0636\u06cc",this._color=(new cc.Color).fromHEX("#6A5AAB"))),this.image&&this._color&&(this.image.color=this._color);var e=this.node.getComponent(cc.Button);null!=e&&(e.interactable=!1),this.waitingIcon.active=!0,a.Util.downloadIfNeeded(this.node,this.game,this.level,function(e){if(e){var o=t.node.getComponent(cc.Button);null!=o&&(o.interactable=!0),t.setIcon(),t.waitingIcon.active=!1}})},e.prototype.setIcon=function(){var t=this,e=(i.COURSES.indexOf(this.game)>=0?this.game:i.default.i.courseId)+"/common/res/icons/"+this.game+".png";a.Util.load(e,function(e,o){e||(t.icon.spriteFrame=new cc.SpriteFrame(o))})},Object.defineProperty(e.prototype,"color",{set:function(t){this._color=t,this.image.color=t},enumerable:!1,configurable:!0}),e.prototype.onBalloonClick=function(){d&&null!=this.chimp&&(d=!1,this.onClickCallback())},e.prototype.flyToNest=function(t){void 0===t&&(t=null);var e=cc.director.getScene().getChildByName("nest"),o=null!=e?e.position:cc.v2(cc.winSize.width-65,cc.winSize.height-61);this.node.runAction(cc.sequence(cc.bezierTo(2,[cc.v2((o.x-this.node.x)/4,(o.y-118-this.node.y)/4),cc.v2((o.x-this.node.x)/2,(o.y-118-this.node.y)/2),cc.v2(o.x,o.y-118)]),cc.callFunc(function(){null!=t&&t()})))},e.prototype.jumpChimpToBalloon=function(t){var e=this,o=this.chimp.parent.convertToNodeSpaceAR(this.node.convertToWorldSpaceAR(this.seat.position));this.chimp.runAction(cc.sequence([cc.bezierTo(1,[cc.v2(this.chimp.x,this.chimp.y+100),cc.v2(o.x/2,o.y+100)]),cc.callFunc(function(){e.chimp.position=cc.Vec2.ZERO,e.chimp.removeFromParent(!1),e.seat.addChild(e.chimp),null!=t&&t()})]))},e.prototype.jumpChimpFromBalloon=function(t){this.chimp.position=cc.director.getScene().convertToNodeSpaceAR(this.chimp.parent.convertToWorldSpaceAR(this.chimp.position)),this.chimp.removeFromParent(),cc.director.getScene().addChild(this.chimp);var e=cc.v2(cc.winSize.width/4,400);this.chimp.runAction(cc.sequence(cc.bezierTo(1,[cc.v2(this.chimp.x,this.chimp.y+100),cc.v2(e.x/2,e.y+100),e]),cc.callFunc(function(){null!=t&&t()})))},e.prototype.flyUpUpAndAbove=function(t){void 0===t&&(t=null),this.node.runAction(cc.sequence(cc.spawn(cc.scaleTo(1,.1),cc.bezierTo(1,[cc.v2(this.node.x-400+800*Math.random(),cc.winSize.height/3),cc.v2(this.node.x-400+800*Math.random(),2*cc.winSize.height/3),cc.v2(this.node.x-400+800*Math.random(),5*cc.winSize.height/3)])),cc.callFunc(function(){null!=t&&t()})))},e.prototype.flyZigzag=function(t){var e=this;void 0===t&&(t=null),(new cc.Tween).target(this.node).to(1,{position:this.node.parent.convertToNodeSpaceAR(cc.v2(Math.random()*cc.winSize.width,Math.random()*cc.winSize.height/2))},{progress:null,easing:"cubicInOut"}).call(function(){e.stopZigzag?null!=t&&t():e.flyZigzag(t)}).start()},e.prototype.flyToCenter=function(t){void 0===t&&(t=null),(new cc.Tween).target(this.node).to(1,{position:this.node.parent.convertToNodeSpaceAR(cc.v2(cc.winSize.width/2,cc.winSize.height/4))},{progress:null,easing:"cubicInOut"}).call(function(){null!=t&&t()}).start()},e.prototype.animateGlow=function(){this.glow.active=!0,this.stars.active=!0;var t=this.node.getComponent(cc.Animation);null!=t&&t.play()},r([l(cc.Label)],e.prototype,"label",void 0),r([l],e.prototype,"game",void 0),r([l(cc.Node)],e.prototype,"seat",void 0),r([l(cc.Node)],e.prototype,"image",void 0),r([l(cc.Sprite)],e.prototype,"icon",void 0),r([l(cc.Node)],e.prototype,"chimp",void 0),r([l(cc.Node)],e.prototype,"doneIcon",void 0),r([l],e.prototype,"done",void 0),r([l(cc.Node)],e.prototype,"waitingIcon",void 0),r([l],e.prototype,"waiting",void 0),r([l(cc.Node)],e.prototype,"glow",void 0),r([l(cc.Node)],e.prototype,"stars",void 0),r([l(cc.AudioClip)],e.prototype,"appearAudio",void 0),e=r([s],e)}(cc.Component);o.default=p,cc._RF.pop()},{"./lib/config":"config","./util":"util"}],"chimple-label":[function(t,e,o){"use strict";cc._RF.push(e,"0ddb3t+49REZ5s0SVkIuotE","chimple-label");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator.ccclass,a=t("./lib/config"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onLoad=function(){if(t.prototype.onLoad.call(this),this.useSystemFont=!0,null!==a.default.getInstance()){var e=a.default.getInstance().currentFontName;a.default.getInstance().hasLoadedTextFont(e)&&(this.font=a.default.getInstance().getTextFont(e)),a.default.i.direction==a.Direction.RTL&&this.horizontalAlign==cc.Label.HorizontalAlign.LEFT&&(this.horizontalAlign=cc.Label.HorizontalAlign.RIGHT)}},e=r([i],e)}(cc.Label);o.default=c,cc._RF.pop()},{"./lib/config":"config"}],"chimple-richtext":[function(t,e,o){"use strict";cc._RF.push(e,"0f8cbR4trZMipR5IzFHkC0C","chimple-richtext");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator.ccclass,a=t("./lib/config"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onLoad=function(){if(t.prototype.onLoad.call(this),this.useSystemFont=!0,null!==a.default.getInstance()){var e=a.default.getInstance().currentFontName;a.default.getInstance().hasLoadedTextFont(e)&&(this.font=a.default.getInstance().getTextFont(e))}},e=r([i],e)}(cc.RichText);o.default=c,cc._RF.pop()},{"./lib/config":"config"}],chimple:[function(t,e,o){"use strict";cc._RF.push(e,"5c222p4y1JFPI6tk6YxS2K8","chimple");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a},i=this&&this.__awaiter||function(t,e,o,n){function r(t){return t instanceof o?t:new o(function(e){e(t)})}return new(o||(o=Promise))(function(o,i){function a(t){try{s(n.next(t))}catch(t){i(t)}}function c(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){t.done?o(t.value):r(t.value).then(a,c)}s((n=n.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(t){return function(e){return s([t,e])}}function s(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.START_SCENE=o.HOME_SCENE=o.LANDING_SCENE=o.NONE=o.REGISTER=o.SCHOOL=o.HOME=o.BASE=o.DEPLOY_MODE=o.CHIMPLE_MODE=void 0;var c=t("./common/scripts/lib/config"),s=t("./common/scripts/lib/profile"),l=t("./common/scripts/lib/constants"),u=t("./common/scripts/util-logger"),d=cc._decorator,p=d.ccclass;d.property;o.CHIMPLE_MODE="CHIMPLE_MODE",o.DEPLOY_MODE="DEPLOY_MODE",o.BASE="BASE",o.HOME="HOME",o.SCHOOL="SCHOOL",o.REGISTER="REGISTER",o.NONE="NONE",o.LANDING_SCENE="private/school/scenes/landing",o.HOME_SCENE="menu/home/scenes/home",o.START_SCENE="menu/start/scenes/start";var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onLoad=function(){return i(this,void 0,void 0,function(){var t;return a(this,function(e){switch(u.default.initPluginFirebase(),t=l.D_MODE,Number(cc.sys.localStorage.getItem(o.CHIMPLE_MODE))||l.MODE,t){case l.DeployMode.Open:this.navigateToBase();break;case l.DeployMode.Close:c.default.loadScene(o.LANDING_SCENE,"private",null);break;default:this.navigateToBase()}return[2]})})},e.navigateToHome=function(){c.default.loadScene("private/home/loginnew/scenes/homeLoginScene","private",null)},e.prototype.navigateToBase=function(){var t=s.User.getUsers();(null==t||t.length<=0)&&s.User.createUser("test","",5,s.Gender.GIRL,"test","armydog"),s.User.setCurrentUser(s.User.getUsers()[0]),c.default.loadScene("menu/start/scenes/start","menu",null)},e=r([p],e)}(cc.Component);o.default=h,cc._RF.pop()},{"./common/scripts/lib/config":"config","./common/scripts/lib/constants":"constants","./common/scripts/lib/profile":"profile","./common/scripts/util-logger":"util-logger"}],config:[function(t,e,o){"use strict";cc._RF.push(e,"8d626S6TF5HCJ6vnsczwKzj","config"),Object.defineProperty(o,"__esModule",{value:!0}),o.WORLDS=o.World=o.Direction=o.QUIZ_MATHS=o.QUIZ_LITERACY=o.BRIDGE_NAME=o.BG_NAME=o.Flow=o.COURSES=o.STORY=o.DEFAULT_FONT=void 0;var n,r,i=t("../util"),a=t("./profile");o.DEFAULT_FONT="main",o.STORY="story",o.COURSES=["en","en-maths","hi","hi-maths","ur","ur-maths"],function(t){t[t.Default=0]="Default",t[t.Platformer=1]="Platformer",t[t.Debug=2]="Debug",t[t.Open=3]="Open"}(n=o.Flow||(o.Flow={})),o.BG_NAME="bgRoot",o.BRIDGE_NAME="bridge",o.QUIZ_LITERACY="quizliteracy",o.QUIZ_MATHS="quizmaths",function(t){t[t.LTR=0]="LTR",t[t.RTL=1]="RTL"}(r=o.Direction||(o.Direction={}));var c=["ur","ur-maths"],s=function(){return function(t,e,o){this.scene=t,this.mapPrefab=e,this.armature=o}}();o.World=s,o.WORLDS=[new s("platform/scenes/assemble","forestMapPrefab","tiger"),new s("platform/scenes/cityAssemble","cityMapPrefab","dog"),new s("platform/scenes/desertAssemble","desertMapPrefab","camel"),new s("platform/scenes/gardenAssemble","gardenMapPrefab","rabbit"),new s("platform/scenes/seaAssemble","seaMapPrefab","koala"),new s("platform/scenes/skyAssemble","skyMapPrefab","horse"),new s("platform/scenes/snowAssemble","snowMapPrefab","bear"),new s("platform/scenes/beachAssemble","beachMapPrefab","hippo"),new s("platform/scenes/playgroundAssemble","playgroundMapPrefab","cat"),new s("platform/scenes/farmAssemble","farmMapPrefab","duck")];var l=function(){return function(t,e){this.scene=t,this.bundle=e}}(),u=function(){function t(){this._textFontMap=new Map,this.curriculum=new Map,this.curriculumLoaded=!1}return t.getInstance=function(){return t.instance||(t.instance=new t,t.instance.courseId="en",t.instance.gameLevelName="1",t.instance.worksheet=1,t.instance.problem=1,t.instance.totalProblems=1,t.instance._scenes=[new l("menu/start/scenes/start","menu")],t.instance.flow=n.Default,t.instance._textFontMap=new Map,t.instance.currentFontName=o.DEFAULT_FONT),t.instance},Object.defineProperty(t,"i",{get:function(){return t.getInstance()},enumerable:!1,configurable:!0}),Object.defineProperty(t,"dir",{get:function(){return t.getInstance().courseId+"/"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"direction",{get:function(){return-1!=c.indexOf(this.courseId)?r.RTL:r.LTR},enumerable:!1,configurable:!0}),t.prototype.addTextFont=function(t,e){this._textFontMap.set(t,e)},t.prototype.hasLoadedTextFont=function(t){return this._textFontMap.has(t)},t.prototype.getTextFont=function(t){return this._textFontMap.get(t)},Object.defineProperty(t.prototype,"textFontMap",{get:function(){return this._textFontMap},enumerable:!1,configurable:!0}),t.preloadScene=function(t,e){cc.director.preloadScene(t,function(){null!=e&&e()})},t.loadScene=function(t,e,o){void 0===e&&(e=null),void 0===o&&(o=null),i.Util.freeResources(),null!=e?cc.assetManager.loadBundle(e,function(e,n){n.loadScene(t,function(t,e){cc.director.runScene(e,null,function(){cc.sys.garbageCollect(),null!=o&&o()})})}):cc.director.loadScene(t,function(){cc.sys.garbageCollect(),null!=o&&o()})},t.prototype.pushScene=function(e,o,n){void 0===o&&(o=null),void 0===n&&(n=null),this._scenes.push(new l(e,o)),t.loadScene(e,o,n)},t.prototype.popScene=function(){this._scenes.pop();var e=this._scenes[this._scenes.length-1],o=e.scene;o.startsWith("menu/map/scene/map")&&(o=o.substr(0,o.length-1)+a.default.lastWorld),t.loadScene(o,e.bundle)},t.prototype.prePopScene=function(e){var o=this._scenes[this._scenes.length-2].scene;o.startsWith("menu/map/scene/map")&&(o=o.substr(0,o.length-1)+a.default.lastWorld),t.preloadScene(o,e)},Object.defineProperty(t.prototype,"canPop",{get:function(){return this._scenes.length>1},enumerable:!1,configurable:!0}),t.prototype.loadFontDynamically=function(t,e,o){var n=this;void 0===e&&(e=null),void 0===o&&(o=null),this._textFontMap.has(t)?(this.currentFontName=t,e&&e(o)):cc.resources.load("fonts/"+t,cc.Font,function(r,i){r?e&&e(o):(console.log("loading font from Config",t),n._textFontMap.set(t,i),n.currentFontName=t,e&&e(o))})},t.prototype.loadFont=function(){},t.prototype.loadLessonJson=function(t){var e=this;if(0!=this.problem)t(this._lessonData.rows[this.problem-1]);else{var o=this.courseId+"/"+this.lessonId+"/res/"+this.lessonId+".json";i.Util.load(o,function(o,n){e._lessonData=n instanceof cc.JsonAsset?n.json:n,e.totalProblems=e._lessonData.rows.length,e.problem=1,null!=t&&t(e._lessonData.rows[e.problem-1])},!0)}},t.prototype.nextProblem=function(){this.problem<this.totalProblems&&(this.problem++,this.data=[this._lessonData.rows[this.problem-1]])},t.prototype.loadPathJSON=function(t,e,o){void 0===o&&(o=!1);var n=[],r=null,a=null;if(t=t.trim(),o=!isNaN(Number(t)),-1!==t.indexOf("tutorial"))t=t.replace(".png",""),a="json";else{var c=t===t.toUpperCase();a=o?"numbers":c?"upper":"lower"}var s=this.courseId+"/course/res/paths/"+a+"/"+t;s+=".json",i.Util.load(s,function(o,i){if(n=[],null!==i){var a=i instanceof cc.JsonAsset?i.json:i;Array.isArray(a)&&a.forEach(function(t){n.push(t)})}r=n&&n.length>0?JSON.stringify(n):null!=cc.sys.localStorage.getItem(t)&&cc.sys.localStorage.getItem(t).length>0?cc.sys.localStorage.getItem(t):null,e(r)},!0)},t.prototype.loadCourseJsons=function(t,e){var o=this;if(this.curriculumLoaded)e();else{var n=a.User.getCurrentUser(),r=n.courseProgressMap.size;n.courseProgressMap.forEach(function(t,e){cc.assetManager.loadBundle(e,function(t,n){if(t)return console.error(t);i.Util.bundles.set(e,n);var a=e+"/course/res/course.json";i.Util.load(a,function(t,n){t||o.curriculum.set(e,n instanceof cc.JsonAsset?n.json:n),r--})})});var c=function(){r<=0&&(o.curriculumLoaded=!0,cc.director.getScheduler().unschedule(c,t),e())};cc.director.getScheduler().schedule(c,t,1)}},Object.defineProperty(t.prototype,"friend",{get:function(){return o.WORLDS[0].armature},enumerable:!1,configurable:!0}),t}();o.default=u,cc._RF.pop()},{"../util":"util","./profile":"profile"}],constants:[function(t,e,o){"use strict";cc._RF.push(e,"fd8a7oihmBN6IXQofI2E6oP","constants"),Object.defineProperty(o,"__esModule",{value:!0}),o.CURRENT_SUBJECT_ID=o.CURRENT_SECTION_ID=o.CURRENT_CLASS_ID=o.CURRENT_STUDENT_ID=o.CURRENT_SCHOOL_ID=o.PARSE_ENABLED=o.QUEUE_OFFLOAD_FREQUENCY=o.LEVEL_END=o.LEVEL_NAME=o.LEVEL_START=o.ACHIEVEMENT_ID=o.UNLOCK_ACHIEVEMENT=o.CONTENT_TYPE=o.ITEM_ID=o.SELECT_CONTENT=o.FAIL_TO_COLLECT_ALL_REWARDS=o.APP_END=o.APP_START=o.WORLD_COMPLETED=o.LEVEL_COMPLETED=o.GAME_END=o.PROBLEM_END=o.GAME_START=o.PROBLEM_START=o.LOG_TYPE=o.LOG_RIGHT_MOVES=o.LOG_WRONG_MOVES=o.LOG_PROBLEM=o.LOG_GAME_LEVEL=o.SKILLS=o.COURSE=o.LOG_LEVEL=o.LOG_WORLD=o.LOG_GAME=o.COURSES_URL=o.COURSE_SERVER=o.SIMULATOR_ROOT_DIR=o.ANDROID_ROOT_DIR=o.ASSET_LOAD_METHOD=o.ENV=o.LANG=o.MODE=o.D_MODE=o.Mode=o.DeployMode=void 0;var n,r,i=t("../../../queue");(function(t){t[t.Open=0]="Open",t[t.Close=1]="Close"})(n=o.DeployMode||(o.DeployMode={})),function(t){t[t.Base=0]="Base",t[t.Home=1]="Home",t[t.Teacher=2]="Teacher",t[t.School=3]="School",t[t.None=4]="None"}(r=o.Mode||(o.Mode={})),o.D_MODE=n.Close,o.MODE=r.None,o.LANG="en",o.ENV="web",o.ASSET_LOAD_METHOD="file",o.ANDROID_ROOT_DIR="/sdcard/bahama/",o.SIMULATOR_ROOT_DIR="/Users/shyamalupadhyaya/Dev/chimple-git/sdcard/bahama/",o.COURSE_SERVER={local:{hi:"http://localhost:8901/courses/",en:"http://localhost:8901/courses/","en-maths":"http://localhost:8901/courses/","hi-maths":"http://localhost:8901/courses/"},dev:{hi:"https://bahama-hi-stage.web.app/bundles/courses/",en:"https://bahama-hi-stage.web.app/bundles/courses/","en-maths":"https://bahama-hi-stage.web.app/bundles/courses/","hi-maths":"https://bahama-hi-stage.web.app/bundles/courses/"},stage:{hi:"https://bahama-hi-stage.web.app/new/courses/",en:"https://bahama-hi-stage.web.app/new/courses/","en-maths":"https://bahama-hi-stage.web.app/new/courses/","hi-maths":"https://bahama-hi-stage.web.app/new/courses/"},prod:{hi:"https://bahama-hi-prod.web.app/courses/",en:"https://bahama-hi-prod.web.app/courses/","en-maths":"https://bahama-hi-prod.web.app/courses/","hi-maths":"https://bahama-hi-prod.web.app/courses/"}},o.COURSES_URL="web"==o.ENV?"":o.COURSE_SERVER[o.ENV][o.LANG],o.LOG_GAME="game",o.LOG_WORLD="world",o.LOG_LEVEL="level",o.COURSE="course",o.SKILLS="skills",o.LOG_GAME_LEVEL="gameLevel",o.LOG_PROBLEM="problem",o.LOG_WRONG_MOVES="wrongMoves",o.LOG_RIGHT_MOVES="rightMoves",o.LOG_TYPE="type",o.PROBLEM_START="problemStart",o.GAME_START="gameStart",o.PROBLEM_END="problemEnd",o.GAME_END="gameEnd",o.LEVEL_COMPLETED="level_completed",o.WORLD_COMPLETED="world_completed",o.APP_START="app_start",o.APP_END="app_end",o.FAIL_TO_COLLECT_ALL_REWARDS="failToCollectAllRewards",o.SELECT_CONTENT="select_content",o.ITEM_ID="item_id",o.CONTENT_TYPE="content_type",o.UNLOCK_ACHIEVEMENT="unlock_achievement",o.ACHIEVEMENT_ID="achievement_id",o.LEVEL_START="level_start",o.LEVEL_NAME="level_name",o.LEVEL_END="level_end",o.QUEUE_OFFLOAD_FREQUENCY=3e4,o.PARSE_ENABLED=!0,o.CURRENT_SCHOOL_ID="CURRENT_SCHOOL_ID",o.CURRENT_STUDENT_ID="CURRENT_STUDENT_ID",o.CURRENT_CLASS_ID="CURRENT_CLASS_ID",o.CURRENT_SECTION_ID="CURRENT_SECTION_ID",o.CURRENT_SUBJECT_ID="CURRENT_SUBJECT_ID",i.Queue.init(),cc._RF.pop()},{"../../../queue":"queue"}],convert:[function(t,e,o){"use strict";cc._RF.push(e,"9cd80ua1RVJ7q7zB04OVwxd","convert"),Object.defineProperty(o,"__esModule",{value:!0}),o.Convert=void 0;var n=function(){function t(){}return t.toCourse=function(t){return JSON.parse(t)},t.courseToJson=function(t){return JSON.stringify(t)},t}();o.Convert=n,cc._RF.pop()},{}],"counting-answer":[function(t,e,o){"use strict";cc._RF.push(e,"1ac78XfkPFH+rXRaCKhHdaG","counting-answer");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.VALIDATE_RESULT=void 0;var i=cc._decorator.ccclass,a=cc._decorator.property,c=t("./answer-grid"),s=t("./lib/error-handler"),l=t("./util");o.VALIDATE_RESULT="VALIDATE_RESULT";var u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.answerGridPrefab=null,e.touchAudio=null,e.numberpads=[],e.result=null,e.delay=2,e._answerGrid=null,e._isValidResult=!1,e}return n(e,t),e.prototype.onLoad=function(){this._answerGrid=cc.instantiate(this.answerGridPrefab),this._answerGrid.setPosition(new cc.Vec2(0,-125)),this.node.addChild(this._answerGrid);var t=this._answerGrid.getComponent(c.default);t.numberpads=this.numberpads,t.result=this.result,t.delay=this.delay,this.updateRichText(),this.updateDigits("?".repeat(this.result.length),!0),this.registerEvents()},e.prototype.registerEvents=function(){var t=this;this.node.on(c.ANSWER_GRID_BUTTON_CLICKED,function(e){e.stopPropagation();try{t.touchAudio&&l.Util.playSfx(t.touchAudio)}catch(t){}if(!t.isValidResult){var o=e.getUserData().selectedDigit;t.updateDigits(o,!1)}})},e.prototype.updateDigits=function(t,e){var o=this;void 0===e&&(e=!1);var n=this.node.getChildByName("digits").getChildByName("label").getComponent(cc.RichText),r=n.string||"";r=r.concat(t),e?n.string=r:(r=r.substring(1,r.length),n.string=r,-1===r.indexOf("?")&&r.length===this.result.length&&this.scheduleOnce(function(){o.checkResult()},.25))},e.prototype.clearDigits=function(t){void 0===t&&(t=!1),this.node.getChildByName("digits").getChildByName("label").getComponent(cc.RichText).string="?".repeat(this.result.length)},e.prototype.checkResult=function(){var t=this.node.getChildByName("digits").getChildByName("label").getComponent(cc.RichText);if(t.string){var e=new cc.Event.EventCustom(o.VALIDATE_RESULT,!0);e.setUserData({result:t.string}),this.node.dispatchEvent(e)}},e.prototype.updateRichText=function(){this.node.getChildByName("countingLabel").getChildByName("chimple-richtext").getComponent(cc.RichText).string="<color=#8B4513><bold>"+l.Util.i18NText("How Many??")+"</bold></color>"},Object.defineProperty(e.prototype,"isValidResult",{get:function(){return this._isValidResult},set:function(t){this._isValidResult=t},enumerable:!1,configurable:!0}),r([a(cc.Prefab)],e.prototype,"answerGridPrefab",void 0),r([a(cc.AudioClip)],e.prototype,"touchAudio",void 0),r([s.default()],e.prototype,"onLoad",null),r([s.default()],e.prototype,"registerEvents",null),r([s.default()],e.prototype,"updateDigits",null),r([s.default()],e.prototype,"clearDigits",null),r([s.default()],e.prototype,"checkResult",null),r([s.default()],e.prototype,"updateRichText",null),e=r([i],e)}(cc.Component);o.default=u,cc._RF.pop()},{"./answer-grid":"answer-grid","./lib/error-handler":"error-handler","./util":"util"}],countingLayout:[function(t,e,o){"use strict";cc._RF.push(e,"8d7ffg2/nlOO5z9Ai5B9mse","countingLayout");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,a=i.ccclass,c=i.property,s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.fullCount=1,e.emptyCount=0,e.fullTexture=null,e.emptyTexture=null,e.scale=1,e}return n(e,t),e.prototype.onLoad=function(){for(var t=0;t<this.fullCount;t++){var e=new cc.Node;e.scale=this.scale;var o=e.addComponent(cc.Sprite);t<this.fullCount-this.emptyCount?o.spriteFrame=this.fullTexture:o.spriteFrame=this.emptyTexture,this.node.addChild(e)}cc.log("CountingLayout:init"+this.node.childrenCount)},e.prototype.feed=function(t){var e=t.convertToWorldSpaceAR(cc.Vec2.ZERO);e.y+=200;for(var o=function(){var t=n.node.children[n.node.childrenCount-1],o=t.convertToWorldSpaceAR(cc.Vec2.ZERO);t.removeFromParent(!1),t.position=o,cc.director.getScene().addChild(t),(new cc.Tween).target(t).to(1,{position:e},null).call(function(){t.active=!1}).start()},n=this;this.node.childrenCount>0;)o()},r([c],e.prototype,"fullCount",void 0),r([c],e.prototype,"emptyCount",void 0),r([c(cc.SpriteFrame)],e.prototype,"fullTexture",void 0),r([c(cc.SpriteFrame)],e.prototype,"emptyTexture",void 0),r([c],e.prototype,"scale",void 0),e=r([a],e)}(cc.Component);o.default=s,cc._RF.pop()},{}],drag:[function(t,e,o){"use strict";cc._RF.push(e,"ba476WS2vlGRrmbU5ZUEfu+","drag");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var i=t("./drop"),a=cc._decorator,c=a.ccclass,s=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.resizeWithLabel=!1,e.fixOnMatch=!0,e.allowDrag=!0,e.returnBackOnNoMatch=!0,e.multipleDrags=!1,e.match=!1,e.matchingNode=null,e.multipleNode=null,e.isDragging=!1,e.touchStartOriginPos=null,e.isMoved=!1,e.isReverseXNeeded=!1,e}var o;return n(e,t),o=e,e.prototype.onLoad=function(){},e.prototype.onEnable=function(){this.enableTouch()},e.prototype.enableTouch=function(){this.node.on("touchstart",this.onTouchStart,this),this.node.on("touchend",this.onTouchEnd,this),this.node.on("touchcancel",this.onTouchEnd,this),this.node.on("touchmove",this.onTouchMove,this)},e.prototype.onDisable=function(){this.disableTouch()},e.prototype.disableTouch=function(){this.node.off("touchstart",this.onTouchStart,this),this.node.off("touchend",this.onTouchEnd,this),this.node.off("touchcancel",this.onTouchEnd,this),this.node.off("touchmove",this.onTouchMove,this)},e.prototype.start=function(){if(this.resizeWithLabel&&null!=this.label){var t=this.label.node.width;this.node.width=t+20,this.node.getComponent(cc.BoxCollider).size.width=this.node.width,this.node.parent.width=this.node.width}},e.prototype.onTouchStart=function(t){o.letDrag&&!this.isDragging&&this.allowDrag&&(this.touchStartOriginPos=this.node.getPosition(),o.letDrag=!1,this.isDragging=!0,this.allowDrag&&this.touchStartAnimation(),this.allowDrag&&this.multipleDrags&&null==this.multipleNode&&(this.multipleNode=cc.instantiate(this.node),this.node.parent.insertChild(this.multipleNode,0)))},e.prototype.onTouchMove=function(t){this.allowDrag&&this.isDragging&&(this.isReverseXNeeded?this.node.setPosition(this.node.position.x-t.getDelta().x,this.node.position.y+t.getDelta().y):this.node.setPosition(this.node.position.add(t.getDelta())))},e.prototype.onTouchEnd=function(t){var e=this;if(this.allowDrag&&this.isDragging){var n=this.node.getPosition().sub(this.touchStartOriginPos);this.isMoved=n.magSqr()>=10,this.touchEndAnimation(),this.match?(this.allowDrag=!1,this.disableTouch(),this.matchingNode.getComponent(i.default).onMatchOver(),(new cc.Tween).target(this.node).to(.25,{position:this.matchPos(t.getLocation())},null).call(function(){e.onMatchOver()}).start()):this.returnBackOnNoMatch?(this.disableTouch(),(new cc.Tween).target(this.node).to(.35,{position:this.returnBackOnNoMatchPos()},{progress:null,easing:"sineOut"}).call(function(){e.onReturnBackOnNoMatch()}).start()):(this.isDragging=!1,o.letDrag=!0)}},e.prototype.onReturnBackOnNoMatch=function(){this.multipleDrags&&null!=this.multipleNode&&(this.multipleNode.removeFromParent(),this.multipleNode=null),this.enableTouch(),this.isDragging=!1,o.letDrag=!0},e.prototype.onCollisionEnter=function(t,e){this.allowDrag&&this.isDragging&&this.collisionEnterCondition(e,t)&&t.node.getComponent(i.default).allowDrop&&(this.match=!0,this.matchingNode=t.node)},e.prototype.onCollisionExit=function(t,e){this.allowDrag&&this.isDragging&&this.collisionExitCondition(this.matchingNode,t.node)&&(this.match=!1,this.matchingNode=null)},e.prototype.onDestroy=function(){this.disableTouch()},e.prototype.onMatchOver=function(){if(this.isDragging=!1,o.letDrag=!0,this.fixOnMatch){this.allowDrag=!1;var t=this.matchingNode;this.node.removeFromParent(),this.node.position=cc.Vec2.ZERO,t.addChild(this.node),this.node.getChildByName("shouldFlip")&&(this.node.scaleX=-1),this.disableTouch()}else this.enableTouch(),this.allowDrag=!0},e.prototype.returnBackOnNoMatchPos=function(){return cc.Vec2.ZERO},e.prototype.matchPos=function(t){return this.node.parent.convertToNodeSpaceAR(this.matchingNode.convertToWorldSpaceAR(cc.Vec2.ZERO))},e.prototype.collisionEnterCondition=function(t,e){return e.node.name===t.node.name},e.prototype.collisionExitCondition=function(t,e){return t===e},e.prototype.touchStartAnimation=function(){(new cc.Tween).target(this.node).to(.25,{scale:1.1},{progress:null,easing:"elasticOut"}).start()},e.prototype.touchEndAnimation=function(){(new cc.Tween).target(this.node).to(.25,{scale:1},{progress:null,easing:"elasticOut"}).start()},e.letDrag=!0,r([s(cc.Label)],e.prototype,"label",void 0),r([s],e.prototype,"resizeWithLabel",void 0),r([s],e.prototype,"fixOnMatch",void 0),r([s],e.prototype,"allowDrag",void 0),r([s],e.prototype,"returnBackOnNoMatch",void 0),r([s],e.prototype,"multipleDrags",void 0),e=o=r([c],e)}(cc.Component);o.default=l,cc._RF.pop()},{"./drop":"drop"}],drop:[function(t,e,o){"use strict";cc._RF.push(e,"08edb7X3GlB7rjongfPHlr4","drop");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var i=t("./drag"),a=cc._decorator,c=a.ccclass,s=a.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.allowDrop=!0,e.allowOnlyOneDrop=!0,e.match=!1,e.matchingNode=null,e}return n(e,t),e.prototype.onLoad=function(){},e.prototype.onCollisionEnter=function(t,e){this.allowDrop&&this.collisionEnterCondition(e,t)&&t.node.getComponent(i.default).allowDrag&&(this.match=!0,this.matchingNode=t.node)},e.prototype.onCollisionExit=function(t,e){this.allowDrop&&(this.match=!1,this.matchingNode=null)},e.prototype.onMatchOver=function(){this.match=!1,this.allowOnlyOneDrop&&(this.allowDrop=!1)},e.prototype.collisionEnterCondition=function(t,e){return e.node.name===t.node.name},r([s],e.prototype,"allowDrop",void 0),r([s],e.prototype,"allowOnlyOneDrop",void 0),e=r([c],e)}(cc.Component);o.default=l,cc._RF.pop()},{"./drag":"drag"}],"error-handler":[function(t,e,o){"use strict";cc._RF.push(e,"9e5224HgUhODLrW4Q2cpHSn","error-handler");var n=this&&this.__assign||function(){return(n=Object.assign||function(t){for(var e,o=1,n=arguments.length;o<n;o++)for(var r in e=arguments[o])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},r=this&&this.__awaiter||function(t,e,o,n){function r(t){return t instanceof o?t:new o(function(e){e(t)})}return new(o||(o=Promise))(function(o,i){function a(t){try{s(n.next(t))}catch(t){i(t)}}function c(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){t.done?o(t.value):r(t.value).then(a,c)}s((n=n.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(t){return function(e){return s([t,e])}}function s(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.catchError=void 0;var a=t("../util-logger");function c(t){return"AsyncFunction"===t.constructor.name}function s(t,e){var o=e.catchFunction,n=e.className,a=e.funcName;function s(t,e,n,r,i){void 0===r&&(r=this),void 0===i&&(i=[]),o(t.message,t.stack,e,n,r,i)}var l=t;return c(l)?function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return r(this,void 0,void 0,function(){var e;return i(this,function(o){switch(o.label){case 0:e=this,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,l.apply(e,t)];case 2:return[2,o.sent()];case 3:return[2,s(o.sent(),a,n,e,t)];case 4:return[2]}})})}:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var o=this;try{var r=l.apply(o,t);return r instanceof Promise?r.catch(function(e){return s(e,a,n,o,t)}):r}catch(e){return s(e,a,n,o,t)}}}function l(t,e,o,n,r,i){if(cc.log("errMessage:"+t+"from className:"+n+" funcName:"+o),r){var c={errMessage:t,className:n,funcName:o};a.default.logChimpleEvent("errorInfo",c)}}function u(t){return function(e,o,r){var i,a,c,u;if(t={catchFunction:l},a=n({funcName:o,className:e.constructor.name},t),"function"==typeof e&&void 0===r)return s(e,n(n({},a),{funcName:e.name}));var d=r.get,p=r.value;if(d)c=d,u="get";else{if("function"!=typeof p)throw new TypeError("Invalid decoration");c=p,u="value"}return"function"==typeof e&&void 0!==r&&(a.className="static "+("get"===u?"getter":"method"),a.funcName=c.name),n(n({},r),((i={})[u]=s(c,a),i))}}o.catchError=u,o.default=u,cc._RF.pop()},{"../util-logger":"util-logger"}],gameConfigs:[function(t,e,o){"use strict";cc._RF.push(e,"d347fp/dOxG7oNayW5uZph3","gameConfigs"),Object.defineProperty(o,"__esModule",{value:!0}),o.GAME_CONFIGS=void 0,o.GAME_CONFIGS={letterpair:{bundle:"letterpair",prefab:"prefabs/letterpair"},fillblank:{bundle:"fillblank",prefab:"prefabs/fillblank"},bubbletype:{bundle:"bubbletype",prefab:"prefabs/bubbletype"},spelldoor:{bundle:"spelldoor",prefab:"prefabs/spelldoor"},jumpsentence:{bundle:"jumpsentence",prefab:"prefabs/jumpsentence"},createsentence:{bundle:"createsentence",prefab:"prefabs/createsentence",center:!0},phonictractor:{bundle:"phonictractor",prefab:"prefabs/phonictractor"},grid:{bundle:"grid",prefab:"prefabs/grid"},tag:{bundle:"tag",prefab:"prefabs/tag"},speakingpet:{bundle:"speakingpet",prefab:"prefabs/speakingpet"},alphabetrecorder:{bundle:"alphabetrecorder",prefab:"prefabs/alphabetrecorder",fontName:"en-trace"},writeletter:{bundle:"writeletter",prefab:"prefabs/writeletter",fontName:"en-trace"},writecard:{bundle:"writecard",prefab:"prefabs/writecard",fontName:"en-trace"},writeword:{bundle:"writeword",prefab:"prefabs/writeword",fontName:"en-trace"},letterboard:{bundle:"board",prefab:"prefabs/board"},pictureboard:{bundle:"pictureboard",prefab:"prefabs/pictureboard"},imagerecorder:{bundle:"imagerecorder",prefab:"prefabs/imagerecorder"},drawshape:{bundle:"drawshape",prefab:"prefabs/drawshape",center:!0},rocket:{bundle:"rocket",prefab:"prefabs/rocket"},openwindow:{bundle:"openwindow",prefab:"prefabs/openwindow"},picturemeaning:{bundle:"picturemeaning",prefab:"prefabs/picturemeaning"},story:{bundle:"story",prefab:"prefabs/story",fontName:"en-trace"},monster:{bundle:"monster",prefab:"prefabs/monster"},calculator:{bundle:"calculator",prefab:"prefabs/calculator"},rowblocks:{bundle:"rowblocks",prefab:"prefabs/rowblocks"},matchbox:{bundle:"matchbox",prefab:"prefabs/matchbox"},multiplybeads:{bundle:"multiplybeads",prefab:"prefabs/multiplybeads"},groupsum:{bundle:"groupsum",prefab:"prefab/groupsum"},nimbletable:{bundle:"nimbletable",prefab:"prefabs/nimbletable"},foodjar:{bundle:"foodjar",prefab:"prefabs/foodjar"},writenumber:{bundle:"writenumber",prefab:"prefabs/writenumber",fontName:"en-trace"},writeset:{bundle:"writeset",prefab:"prefabs/writeset",fontName:"en-trace"},numberboard:{bundle:"board",prefab:"prefabs/board"},sumtogether:{bundle:"sumtogether",prefab:"prefabs/sumtogether"},shapepair:{bundle:"letterpair",prefab:"prefabs/letterpair"},numberpair:{bundle:"letterpair",prefab:"prefabs/letterpair"},questionboard:{bundle:"questionboard",prefab:"prefabs/questionboard"},matchingcard:{bundle:"matchingcard",prefab:"prefabs/matchingcard"},blender:{bundle:"blender",prefab:"prefabs/blender"},sequencebox:{bundle:"sequencebox",prefab:"prefabs/sequencebox"},tenbox:{bundle:"tenbox",prefab:"prefabs/tenbox"},taprise:{bundle:"taprise",prefab:"prefabs/taprise"},total:{bundle:"total",prefab:"prefabs/total"},checkerblocks:{bundle:"checkerblocks",prefab:"prefabs/checkerblocks"},ordertractor:{bundle:"ordertractor",prefab:"prefabs/ordertractor"},balancing:{bundle:"balancing",prefab:"prefabs/balancing"},shapetractor:{bundle:"shapetractor",prefab:"prefabs/shapetractor"},fillanswer:{bundle:"fillblank",prefab:"prefabs/fillblank"},quizliteracy:{bundle:"quiz",prefab:"quizliteracy/prefabs/quizliteracy"},quizmaths:{bundle:"quiz",prefab:"quizmaths/prefabs/quizmaths"},arrangeletters:{bundle:"arrangeletters",prefab:"prefabs/arrangeletters"},dragthealphabet:{bundle:"dragthealphabet",prefab:"prefabs/dragthealphabet"}},cc._RF.pop()},{}],globals:[function(t,e,o){"use strict";cc._RF.push(e,"52453a3z3xFCYsUXqHjog5c","globals"),cc._RF.pop()},{}],helper:[function(t,e,o){"use strict";cc._RF.push(e,"3795bHNzUtOY6Snt9nuSu8q","helper"),Object.defineProperty(o,"__esModule",{value:!0}),o.Helper=o.GO_TO_NEXT_PROBLEM=o.BOTTOM_MIDDLE=o.AUTO_TOUCH_START=o.TUTORIAL_IMAGES=o.LETTER_VOICE=o.PHONIC_VOICE=o.NUMBER_VOICE=o.SOUND_LOADED_EVENT=o.WRONG_EVENT=o.CORRECT_EVENT=o.PROBLEM_OVER_EVENT=o.GAME_OVER_EVENT=o.GAME_START_EVENT=o.MOVE_NOT_MATCH=o.MOVE_MATCH=o.BACK_FINISHED=o.RECORDING_FINISHED=o.MOVE_TO_NEXT_LETTER_EVENT=o.TRACING_WRONG=o.TRACING_CORRECT=o.SHOW_CHILD_IMAGE=o.TRACING_FINISHED=o.CONFIG_LOADED=o.DEFAULT_FONT_COLOR=o.LEVEL_FONT_SIZE=o.FONT_SIZE=o.ALL_REWARDS=o.DIAMOND_BOX=o.DIAMOND=o.CROWN=o.BANANA=o.COIN=o.FILLER_GROUP=o.QUIZ_GROUP=o.OBSTACLE_GROUP=o.REWARD_GROUP=o.PLAYER_GROUP=o.WALL_GROUP=o.GROUND_GROUP=void 0,o.GROUND_GROUP="ground",o.WALL_GROUP="wall",o.PLAYER_GROUP="player",o.REWARD_GROUP="reward",o.OBSTACLE_GROUP="obstacle",o.QUIZ_GROUP="quizcollect",o.FILLER_GROUP="fillerwait",o.COIN="coin",o.BANANA="banana",o.CROWN="crown",o.DIAMOND="diamond",o.DIAMOND_BOX="diamondbox",o.ALL_REWARDS=[o.COIN,o.BANANA,o.CROWN,o.DIAMOND,o.DIAMOND_BOX],o.FONT_SIZE="65",o.LEVEL_FONT_SIZE="40",o.DEFAULT_FONT_COLOR=cc.Color.BLACK,o.CONFIG_LOADED="configLoaded",o.TRACING_FINISHED="tracingFinished",o.SHOW_CHILD_IMAGE="showChildImage",o.TRACING_CORRECT="tracingCorrect",o.TRACING_WRONG="tracingWrong",o.MOVE_TO_NEXT_LETTER_EVENT="moveToNextLetter",o.RECORDING_FINISHED="recordingFinished",o.BACK_FINISHED="backFinished",o.MOVE_MATCH="MoveMatch",o.MOVE_NOT_MATCH="MoveNotMatch",o.GAME_START_EVENT="gameStart",o.GAME_OVER_EVENT="gameOver",o.PROBLEM_OVER_EVENT="problemOver",o.CORRECT_EVENT="correct",o.WRONG_EVENT="wrong",o.SOUND_LOADED_EVENT="soundLoaded",o.NUMBER_VOICE="course/res/sound/numbervoice/",o.PHONIC_VOICE="course/res/sound/phonicvoice/",o.LETTER_VOICE="course/res/sound/lettervoice/",o.TUTORIAL_IMAGES="drawshape/res/image/",o.AUTO_TOUCH_START="autoTouchStart",o.BOTTOM_MIDDLE=new cc.Vec2(0,.5),o.GO_TO_NEXT_PROBLEM="goToNextProblem";var n=function(){function t(){}return t.subScribeToTracingEvents=function(t,e,n){t.on(o.TRACING_FINISHED,function(t){n()}),t.on(o.TRACING_CORRECT,function(t){t.stopPropagation(),e.emit("correct")}),t.on(o.TRACING_WRONG,function(t){t.stopPropagation(),e.emit("wrong")})},t}();o.Helper=n,cc._RF.pop()},{}],help:[function(t,e,o){"use strict";cc._RF.push(e,"753cd133+lDWoibLGRa2OFk","help");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,a=i.ccclass,c=i.property,s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.callBack=null,e.hand=null,e.grayL=null,e.grayR=null,e.grayT=null,e.grayB=null,e}return n(e,t),e.prototype.initNodes=function(t,e,o){this.from=t,this.to=e,this.callBack=o},e.prototype.onLoad=function(){this.drawGray(this.from)},e.prototype.drawGray=function(t){var e=t.getBoundingBoxToWorld();this.grayL.right=cc.winSize.width-e.xMin,this.grayR.left=e.xMax,this.grayT.right=cc.winSize.width-e.xMin,this.grayT.left=e.xMax,this.grayT.bottom=e.yMax,this.grayB.right=cc.winSize.width-e.xMin,this.grayB.left=e.xMax,this.grayB.top=cc.winSize.height-e.yMin,this.grayL.updateAlignment(),this.grayR.updateAlignment(),this.grayT.updateAlignment(),this.grayB.updateAlignment()},e.prototype.start=function(){this.help()},e.prototype.help=function(){var t=this;this.node.active=!0,(new cc.Tween).target(this.hand).set({position:this.node.convertToNodeSpaceAR(this.from.getBoundingBoxToWorld().center)}).to(.25,{scale:.8},null).delay(1).call(function(){t.drawGray(t.to)}).to(1,{position:this.node.convertToNodeSpaceAR(this.to.getBoundingBoxToWorld().center)},null).to(.25,{scale:1},null).call(function(){t.node.active=!1,null!=t.callBack&&t.callBack()}).start()},r([c(cc.Node)],e.prototype,"hand",void 0),r([c(cc.Widget)],e.prototype,"grayL",void 0),r([c(cc.Widget)],e.prototype,"grayR",void 0),r([c(cc.Widget)],e.prototype,"grayT",void 0),r([c(cc.Widget)],e.prototype,"grayB",void 0),e=r([a],e)}(cc.Component);o.default=s,cc._RF.pop()},{}],"indicator-node":[function(t,e,o){"use strict";cc._RF.push(e,"406a0I1/jFKSKXx9lktO5FY","indicator-node");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator.ccclass,a=t("./tracing-node"),c=t("./arrow-node"),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._collisionCount=0,e._counterValue=0,e._arrowValue=0,e.traceGraphics=null,e.currentPath=null,e}return n(e,t),e.prototype.onEnable=function(){cc.director.getCollisionManager().enabled=!0},e.prototype.onCollisionEnter=function(t,e){switch(t.node.group){case"choice":this.collisionEnter(t,e)}},e.prototype.collisionEnter=function(t,e){if("tracingNode"===t.node.name){var o=t.node.getComponent(a.default);if(null!==o){var n=o.currentPath;this.currentPath===n&&(this._collisionCount++,this._counterValue=o.counter)}}else if("arrowNode"===t.node.name){var r=t.node.getComponent(c.default);if(cc.log("checking contact with arrow Node",r.arrowValue,"with path",r.currentPath," and current value",this.traceGraphics.currentArrowValue),null!==r){n=r.currentPath;this.currentPath===n&&(this._arrowValue=r.arrowValue,this.traceGraphics.currentArrowValue+1===r.arrowValue&&(this.traceGraphics.currentArrowValue=r.arrowValue,this.traceGraphics.nextArrowValue=this.traceGraphics.currentArrowValue+1,this.traceGraphics.arrowPos=t.node.getPosition(),this.traceGraphics.arrowStarCounter=r.starCounter,cc.log("contact with arrow Node",r.arrowValue)))}}},e.prototype.onCollisionExit=function(t,e){switch(t.node.group){case"choice":this.collisionExit(t,e)}},e.prototype.collisionExit=function(t,e){if("tracingNode"===t.node.name){var o=t.node.getComponent(a.default);if(null!==o){var n=o.currentPath;this.currentPath===n&&(this._collisionCount--,this._collisionCount<=0&&this.traceGraphics.disableTouchAsNoCollision(!1))}}else if("arrowNode"===t.node.name){var r=t.node.getComponent(c.default);if(null!==r){n=r.currentPath;this.currentPath===n&&cc.log("contact lost with arrow Node",r.arrowValue)}}},Object.defineProperty(e.prototype,"collisionCount",{get:function(){return this._collisionCount},set:function(t){this._collisionCount=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"counterValue",{get:function(){return this._counterValue},enumerable:!1,configurable:!0}),e=r([i],e)}(cc.Component);o.default=s,cc._RF.pop()},{"./arrow-node":"arrow-node","./tracing-node":"tracing-node"}],lessonController:[function(t,e,o){"use strict";cc._RF.push(e,"b559c8Ur4pLyZP4wRVFDP7W","lessonController");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var i=t("./balloon"),a=t("./lib/config"),c=t("./lib/gameConfigs"),s=t("./progressMonitor"),l=t("./quiz-monitor"),u=t("./util"),d=t("../../queue"),p=t("./lib/constants"),h=t("./lib/profile"),f=t("./util-logger"),g=t("./loading"),_=cc._decorator,y=_.ccclass,m=_.property,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.progressMonitor=null,e.quizMonitor=null,e.correctAudio=null,e.wrongAudio=null,e.startAudio=null,e.balloonPrefab=null,e.blockPrefab=null,e.chimp=null,e.gameParent=null,e.loading=null,e.progressMonitorNode=null,e.quizMonitorNode=null,e.gameNode=null,e.wrongMoves=0,e.rightMoves=0,e.nest=null,e.quizScore=0,e.total=0,e.isQuizAnsweredCorrectly=!1,e.lessonStartTime=0,e.problemStartTime=0,e.problemTime=0,e.isGameCompleted=!1,e.isQuizCompleted=!1,e.gameTime=0,e.quizTime=0,e}var o;return n(e,t),o=e,e.prototype.onLoad=function(){this.loading.width=cc.winSize.width,this.loading.zIndex=10,this.progressMonitorNode=cc.instantiate(this.progressMonitor),this.progressMonitorNode.zIndex=2,this.node.addChild(this.progressMonitorNode),this.lessonStart()},e.preloadLesson=function(t){var e=this,o=a.default.i;o.problem=0,cc.assetManager.loadBundle(o.lessonId,function(n,r){if(n)return console.error(n);r.preloadDir("res",null,null,function(n,i){u.Util.bundles.set(o.lessonId,r),o.loadLessonJson(function(n){o.data=[n],e.preloadGame(function(o){e.gamePrefab=o,t()})})})})},e.preloadGame=function(t){var e=a.default.i;e.game=e.data[0][0];var o=c.GAME_CONFIGS[e.game],n=e.courseId.split("-")[0]+"-"+a.DEFAULT_FONT;null!=o.fontName&&(n=o.fontName),e.loadFontDynamically(n),cc.assetManager.loadBundle(o.bundle,function(e,n){n.load(o.prefab,cc.Prefab,function(e,o){t(o)})})},e.prototype.lessonStart=function(){this.startGame(o.gamePrefab),this.loading.active=!1},e.prototype.problemStart=function(t){var e=this;this.problemStartTime=(new Date).getTime(),t?o.preloadGame(function(t){e.startGame(t),e.loading.active=!1}):(null!=this.gameNode&&this.gameNode.emit("nextIteration"),this.loading.active=!1)},e.prototype.startGame=function(t){null!=this.gameNode&&this.gameNode.removeFromParent(),this.gameNode=cc.instantiate(t),this.gameParent.addChild(this.gameNode),c.GAME_CONFIGS[a.default.i.game].center?(this.gameNode.x=-512,this.gameNode.y=-384):(this.gameNode.x=0,this.gameNode.y=0),this.setupEventHandlers()},e.prototype.problemEnd=function(t){var e=this,o=a.default.i,n=Math.ceil(((new Date).getTime()-this.problemStartTime)/1e3),r=this.progressMonitorNode.getComponent(s.default),i=o.problem;i==o.totalProblems&&(this.loading.getComponent(g.default).animate=!1);this.loading.active=!0;var c=o.game.toLowerCase().includes("quiz");c?this.quizScore:this.total;if(cc.sys.localStorage.getItem(p.CURRENT_STUDENT_ID)){var l={chapter:o.chapterId,lesson:o.lessonId,incorrect:this.wrongMoves,totalQuestions:o.totalProblems,correct:this.rightMoves,totalChallenges:o.totalProblems,totalSeconds:n,activity:o.game,kind:"Monitor",schoolId:cc.sys.localStorage.getItem(p.CURRENT_SCHOOL_ID),studentId:cc.sys.localStorage.getItem(p.CURRENT_STUDENT_ID),classId:cc.sys.localStorage.getItem(p.CURRENT_CLASS_ID)};d.Queue.getInstance().push(l)}var u=c?"quizEnd":"gameEnd";f.default.logChimpleEvent(u,{chapterName:o.chapter.name,chapterId:o.chapterId,lessonName:o.lesson.name,lessonId:o.lessonId,courseName:o.courseId,problemNo:o.problem,timeSpent:n,wrongMoves:this.wrongMoves,correctMoves:this.rightMoves,skills:o.lesson.skills&&o.lesson.skills.length>0?o.lesson.skills.join(","):"",game_completed:!c,quiz_completed:!!c});var h=c?this.isQuizAnsweredCorrectly?s.StarType.Correct:s.StarType.Wrong:s.StarType.Default;r.updateProgress(i,h,function(){r.stopStar=!1,i<o.totalProblems?(o.nextProblem(),e.problemStart(t)):e.lessonEnd()})},e.prototype.lessonEnd=function(){u.Util.playSfx(this.startAudio);var t=a.default.getInstance(),e=Math.ceil(((new Date).getTime()-this.lessonStartTime)/1e3);this.total=Math.max(0,100-10*this.wrongMoves);var o=h.User.getCurrentUser();o.updateLessonProgress(t.lessonId,this.total);var n=0,r=0;if(t.chapter&&t.chapter.lessons&&t.chapter.lessons.length>0&&(t.chapter.lessons.forEach(function(t){o.lessonProgressMap.has(t.id)&&n++}),r=n/t.chapter.lessons.length),cc.sys.localStorage.getItem(p.CURRENT_STUDENT_ID)){var c={chapter:t.chapterId,lesson:t.lessonId,percentComplete:r,timespent:e,assessment:this.total,kind:"Progress",schoolId:cc.sys.localStorage.getItem(p.CURRENT_SCHOOL_ID),studentId:cc.sys.localStorage.getItem(p.CURRENT_STUDENT_ID),sectionId:cc.sys.localStorage.getItem(p.CURRENT_SECTION_ID),subjectId:cc.sys.localStorage.getItem(p.CURRENT_SUBJECT_ID)};d.Queue.getInstance().push(c)}f.default.logChimpleEvent("lessonEnd",{chapterName:t.chapter.name,chapterId:t.chapterId,lessonName:t.lesson.name,lessonId:t.lessonId,courseName:t.courseId,score:t.game.toLowerCase().includes("quiz")?this.quizScore:this.total,timeSpent:e,skills:t.lesson.skills?t.lesson.skills.join(","):"",game_completed:!t.game.toLowerCase().includes("quiz"),quiz_completed:!!t.game.toLowerCase().includes("quiz")});var s=cc.instantiate(this.blockPrefab);this.node.addChild(s);var l=cc.instantiate(this.balloonPrefab);l.position=cc.director.getScene().convertToNodeSpaceAR(this.chimp.node.parent.convertToWorldSpaceAR(cc.v2(0,-118)));var g=l.getComponent(i.default);g.game=t.game,g.label.string=u.Util.i18NText("Game Over"),g.chimp=this.chimp.node,this.chimp.node.removeFromParent(),g.seat.addChild(this.chimp.node),g.onClickCallback=function(){t.popScene()},cc.director.getScene().addChild(l),g.animateGlow(),(new cc.Tween).target(l).to(.5,{position:cc.v2(cc.winSize.width/2,100)},null).delay(2).call(function(){g.onBalloonClick()}).start()},e.prototype.setupEventHandlers=function(){var t=this;this.gameNode.on("nextProblem",function(e){void 0===e&&(e=!0),t.problemEnd(e)}),this.gameNode.on("correct",function(){t.rightMoves++,u.Util.playSfx(t.correctAudio),null!=t.chimp&&t.chimp.playAnimation("correct",1)}),this.gameNode.on("wrong",function(){t.wrongMoves++,u.Util.playSfx(t.wrongAudio),null!=t.chimp&&t.chimp.playAnimation("wrong",1)}),this.gameNode.on(l.QUIZ_ANSWERED,function(e){e?(cc.log("QUIZ_ANSWERED correctly"),t.isQuizAnsweredCorrectly=!0,t.quizScore++):(cc.log("QUIZ_ANSWERED wrongly"),t.isQuizAnsweredCorrectly=!1)})},e.prototype.onBackClick=function(){a.default.i.popScene(),u.Util.stopHelpAudio()},r([m(cc.Prefab)],e.prototype,"progressMonitor",void 0),r([m(cc.Prefab)],e.prototype,"quizMonitor",void 0),r([m(cc.AudioClip)],e.prototype,"correctAudio",void 0),r([m(cc.AudioClip)],e.prototype,"wrongAudio",void 0),r([m(cc.AudioClip)],e.prototype,"startAudio",void 0),r([m(cc.Prefab)],e.prototype,"balloonPrefab",void 0),r([m(cc.Prefab)],e.prototype,"blockPrefab",void 0),r([m(dragonBones.ArmatureDisplay)],e.prototype,"chimp",void 0),r([m(cc.Node)],e.prototype,"gameParent",void 0),r([m(cc.Node)],e.prototype,"loading",void 0),e=o=r([y],e)}(cc.Component);o.default=b,cc._RF.pop()},{"../../queue":"queue","./balloon":"balloon","./lib/config":"config","./lib/constants":"constants","./lib/gameConfigs":"gameConfigs","./lib/profile":"profile","./loading":"loading","./progressMonitor":"progressMonitor","./quiz-monitor":"quiz-monitor","./util":"util","./util-logger":"util-logger"}],loading:[function(t,e,o){"use strict";cc._RF.push(e,"95aebuS+FpPyYalDcbBPw4a","loading");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,a=i.ccclass,c=i.property,s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.block=null,e.animationPrefab=null,e.delay=3,e.animate=!0,e}return n(e,t),e.prototype.start=function(){this.showLoading()},e.prototype.showLoading=function(){var t=this;this.block.color=cc.Color.TRANSPARENT,null!=this.animation&&(this.animation.active=!1),this.scheduleOnce(function(){t.block.color=cc.Color.GRAY,t.block.opacity=128,t.animate&&(null==t.animation&&(t.animation=cc.instantiate(t.animationPrefab),t.node.addChild(t.animation)),t.animation.active=!0)},this.delay)},e.prototype.onEnable=function(){console.log("onEnable"),this.showLoading()},r([c(cc.Node)],e.prototype,"block",void 0),r([c(cc.Prefab)],e.prototype,"animationPrefab",void 0),e=r([a],e)}(cc.Component);o.default=s,cc._RF.pop()},{}],nest:[function(t,e,o){"use strict";cc._RF.push(e,"7d6ccHPU2dK8pv4dYNNSQ+I","nest");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var i=t("./lib/config"),a=t("./util"),c=t("./lib/profile"),s=cc._decorator,l=s.ccclass,u=s.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.chimp=null,e.blockPrefab=null,e.homeButton=null,e.backButton=null,e.settingsButton=null,e.soundEnable=null,e.soundDisable=null,e.backButtonAudio=null,e.isOpen=!1,e.isTrasitioning=!1,e.numClicks=0,e.gameNode=null,e}return n(e,t),e.prototype.onLoad=function(){if(this.node.zIndex=4,this.setSfxButton(),i.default.getInstance().flow==i.Flow.Debug){var t=new cc.Node;t.addComponent(cc.Label);t.y=48,this.node.addChild(t)}},e.prototype.onDisable=function(){this.chimp.active=!0},e.prototype.onSettingsClicked=function(t,e){if(!this.isTrasitioning){this.isTrasitioning=!0;var o=0==c.default.getItem(c.SFX_OFF);c.default.setItem(c.SFX_OFF,o?1:0),o&&cc.audioEngine.stopMusic(),this.setSfxButton(),this.goBack()}},e.prototype.setSfxButton=function(){this.settingsButton.getComponent(cc.Sprite).spriteFrame=0==c.default.getItem(c.SFX_OFF)?this.soundEnable:this.soundDisable},e.prototype.onButtonClick=function(t,e){var o=this;if(!this.isTrasitioning)if(this.isTrasitioning=!0,this.isOpen)this.goBack();else{this.isOpen=!0;var n=cc.instantiate(this.blockPrefab);n.getComponent(cc.Widget).target=cc.director.getScene(),n.on("touchstart",this.onButtonClick,this),this.node.insertChild(n,0),i.default.getInstance().canPop&&(new cc.Tween).target(this.backButton).to(.5,{x:-300},{progress:null,easing:"elasticOut"}).start(),(new cc.Tween).target(this.settingsButton).to(.5,{x:-200},{progress:null,easing:"elasticOut"}).call(function(){cc.director.pause(),o.isTrasitioning=!1}).start()}},e.prototype.onBackClick=function(t,e){var o=this;this.isTrasitioning||(this.isTrasitioning=!0,this.goBack(function(){a.Util.playSfx(o.backButtonAudio),o.homeButton.interactable=!1,i.default.getInstance().popScene()}))},e.prototype.goBack=function(t){var e=this;void 0===t&&(t=null),cc.director.resume(),(new cc.Tween).target(this.backButton).to(.5,{x:0},{progress:null,easing:"elasticIn"}).call(function(){e.node.removeChild(e.node.children[0]),e.isOpen=!1,e.isTrasitioning=!1,null!=t&&t()}).start(),(new cc.Tween).target(this.settingsButton).to(.5,{x:0},{progress:null,easing:"elasticIn"}).call(function(){}).start()},r([u(cc.Node)],e.prototype,"chimp",void 0),r([u(cc.Prefab)],e.prototype,"blockPrefab",void 0),r([u(cc.Button)],e.prototype,"homeButton",void 0),r([u(cc.Node)],e.prototype,"backButton",void 0),r([u(cc.Node)],e.prototype,"settingsButton",void 0),r([u(cc.SpriteFrame)],e.prototype,"soundEnable",void 0),r([u(cc.SpriteFrame)],e.prototype,"soundDisable",void 0),r([u({type:cc.AudioClip})],e.prototype,"backButtonAudio",void 0),e=r([l],e)}(cc.Component);o.default=d,cc._RF.pop()},{"./lib/config":"config","./lib/profile":"profile","./util":"util"}],"number-script":[function(t,e,o){"use strict";cc._RF.push(e,"d188cem8MZKo4EZw1jZ/0t0","number-script");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator.ccclass,a=cc._decorator.property,c=t("./lib/error-handler"),s=t("./answer-grid"),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.normalLabelColor="",e.pressedLabelColor="",e}return n(e,t),e.prototype.onLoad=function(){},e.prototype.onButtonClick=function(t,e){var o=t.target.getChildByName(s.BACK_GROUND);if(o){var n=o.getChildByName(s.NUMBER_LABEL),r=n.getComponent(cc.Label);n.addComponent(cc.LabelOutline).width=2;var i=new cc.Event.EventCustom(s.ANSWER_GRID_BUTTON_CLICKED,!0);i.setUserData({selectedDigit:r.string}),this.node.dispatchEvent(i)}},r([a],e.prototype,"normalLabelColor",void 0),r([a],e.prototype,"pressedLabelColor",void 0),r([c.default()],e.prototype,"onButtonClick",null),e=r([i],e)}(cc.Component);o.default=l,cc._RF.pop()},{"./answer-grid":"answer-grid","./lib/error-handler":"error-handler"}],profile:[function(t,e,o){"use strict";cc._RF.push(e,"a96c31hmTFFGZ19nXKggkBB","profile");var n=this&&this.__awaiter||function(t,e,o,n){function r(t){return t instanceof o?t:new o(function(e){e(t)})}return new(o||(o=Promise))(function(o,i){function a(t){try{s(n.next(t))}catch(t){i(t)}}function c(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){t.done?o(t.value):r(t.value).then(a,c)}s((n=n.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(t){return function(e){return s([t,e])}}function s(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.User=o.languageSelect=o.availLanguages=o.Language=o.LessonProgressClass=o.CourseProgressClass=o.Gender=o.PASSWORD=o.CONTACT=o.EMAIL=o.LANGUAGE=o.MAX_AGE=o.MAX_USERS=o.USER_ID=o.AGE=o.MUSIC_OFF=o.GENDER=o.SFX_OFF=void 0;var i,a=t("../util-logger"),c=t("./config"),s=t("../../../queue"),l=t("./constants");o.SFX_OFF="sfxOff",o.GENDER="gender",o.MUSIC_OFF="musicOff",o.AGE="age",o.USER_ID="UserId",o.MAX_USERS=3,o.MAX_AGE=12,o.LANGUAGE="language",o.EMAIL="email",o.CONTACT="contact",o.PASSWORD="password",function(t){t[t.BOY=0]="BOY",t[t.GIRL=1]="GIRL",t[t.UNKNOWN=2]="UNKNOWN"}(i=o.Gender||(o.Gender={}));var u=function(){return function(){this.currentLessonId=null}}();o.CourseProgressClass=u;var d=function(){return function(t,e){void 0===e&&(e=0),this.score=t,this.quizAttempts=e}}();o.LessonProgressClass=d,function(t){t[t.ENGLISH=0]="ENGLISH",t[t.HINDI=1]="HINDI"}(o.Language||(o.Language={})),o.availLanguages=["english","hindi"],o.languageSelect=[["english","A","#FFBC00"],["\u0939\u093f\u0928\u094d\u0926\u0940","\u0905","#3E99E7"],["english","C","#3CBD93"],["hindi","Z","#F55B5D"]];var p=function(){function t(t,e,o,n,r,i,c,s,l,u,d,p,h,f,g,_){this._id=t,this._name=e,this._age=o,this._gender=n,this._imgPath=r,this._avatarImage=i,this._isTeacher=c,this._inventory=u,this._unlockedInventory=g,this._unlockedRewards=_,this._currentBg=d,this._currentCharacter=p,this._courseProgressMap=h,this._lessonProgressMap=f,a.default.setUserIdEvent(t),a.default.setUserPropertiesEvent("userName",e),a.default.setUserPropertiesEvent("userAge",o),this._genderEvent(n)}return t.prototype._genderEvent=function(t){switch(t){case i.BOY:a.default.setUserPropertiesEvent("userGender","Boy");break;case i.GIRL:a.default.setUserPropertiesEvent("userGender","Girl");break;case i.UNKNOWN:a.default.setUserPropertiesEvent("userGender","Unknown")}},Object.defineProperty(t.prototype,"id",{get:function(){return this._id},set:function(t){this._id=t,this._storeUser(),a.default.setUserIdEvent(t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._name},set:function(t){this._name=t,this._storeUser(),a.default.setUserPropertiesEvent("userName",t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"age",{get:function(){return this._age},set:function(t){this._age=t,this._storeUser(),a.default.setUserPropertiesEvent("userAge",t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"gender",{get:function(){return this._gender},set:function(t){this._gender=t,this._storeUser(),this._genderEvent(t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"imgPath",{get:function(){return this._imgPath},set:function(t){this._imgPath=t,this._storeUser()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"avatarImage",{get:function(){return this._avatarImage},set:function(t){console.log(" avatar image : ",t),this._avatarImage=t,this._storeUser()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inventory",{get:function(){return this._inventory},set:function(t){this._inventory=t,this._storeUser()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentBg",{get:function(){return this._currentBg},set:function(t){this._currentBg=t,this._storeUser()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentCharacter",{get:function(){return this._currentCharacter},set:function(t){this._currentCharacter=t,this._storeUser()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"courseProgressMap",{get:function(){return this._courseProgressMap},set:function(t){this._courseProgressMap=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lessonProgressMap",{get:function(){return this._lessonProgressMap},set:function(t){this._lessonProgressMap=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"unlockedInventory",{get:function(){return this._unlockedInventory},set:function(t){this._unlockedInventory={},this._storeUser()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"unlockedRewards",{get:function(){return this._unlockedRewards},set:function(t){this._unlockedRewards={},this._storeUser()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isTeacher",{set:function(t){this._isTeacher=t,this._storeUser()},enumerable:!1,configurable:!0}),t.prototype.unlockInventoryForItem=function(t){this._unlockedInventory[t]=!0,this._storeUser()},t.prototype.unlockRewardsForItem=function(t){this._unlockedRewards[t]=!0,this._storeUser()},t.prototype.updateLessonProgress=function(t,e){this._lessonProgressMap.has(t)?e>this._lessonProgressMap.get(t).score&&(this._lessonProgressMap.get(t).score=e):this._lessonProgressMap.set(t,new d(e)),this._storeUser()},t.prototype._storeUser=function(){t.storeUser(this)},t.storeUser=function(e){if(cc.sys.localStorage.setItem(e.id,t.toJson(e)),a.default.logChimpleEvent("userProfile",{userAge:e.age,gender:e.gender,userId:e.id}),cc.sys.localStorage.getItem(l.CURRENT_STUDENT_ID)){var o={profile:t.toJson(e),kind:"Profile",studentId:cc.sys.localStorage.getItem(l.CURRENT_STUDENT_ID)};s.Queue.getInstance().push(o)}},t.createUUID=function(){var t=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var o=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?o:3&o|8).toString(16)})},t.createUser=function(e,o,n,r,i,a,c){void 0===i&&(i=null),void 0===a&&(a=null),void 0===c&&(c=!1);var s=i||t.createUUID(),l=new t(s,e,n,r,o,a,c,!0,!0,{},"","bear",new Map([["test-lit",new u],["test-maths",new u]]),new Map,{},{});t.storeUser(l);var d=t.getUserIds();return null==d?d=[s]:d.push(s),t.setUserIds(d),console.log("User created ",t.fromJson(cc.sys.localStorage.getItem(s))),l},t.getUsers=function(){var e=[],o=t.getUserIds();return null!=o&&o.forEach(function(o){var n=t.fromJson(cc.sys.localStorage.getItem(o));e.push(n)}),e},t.getUserIds=function(){return JSON.parse(cc.sys.localStorage.getItem(o.USER_ID))},t.setUserIds=function(t){cc.sys.localStorage.setItem(o.USER_ID,JSON.stringify(t)),console.log("User Id aray created ",JSON.parse(cc.sys.localStorage.getItem(o.USER_ID)))},t.fromJson=function(e){var o=JSON.parse(e);if(!o)return null;var n=new Map;for(var r in o.courseProgressMap)n.set(r,o.courseProgressMap[r]);var i=new Map;for(var r in o.lessonProgressMap)i.set(r,o.lessonProgressMap[r]);return new t(o.id,o.name,o.age,o.gender,o.imgPath,o.avatarImage,o.isTeacher,o.sfxOff,o.musicOff,o.inventory,o.currentBg,o.currentCharacter,n,i,o.unlockedInventory,o.unlockedRewards)},t.toJson=function(t){var e={};t.courseProgressMap.forEach(function(t,o){e[o]=t});var o={};return t.lessonProgressMap.forEach(function(t,e){o[e]=t}),JSON.stringify({id:t.id,name:t.name,age:t.age,gender:t.gender,imgPath:t.imgPath,avatarImage:t.avatarImage,isTeacher:t.isTeacher,sfxOff:t._sfxOff,musicOff:t._musicOff,inventory:t.inventory,currentBg:t.currentBg,currentCharacter:t.currentCharacter,courseProgressMap:e,lessonProgressMap:o,unlockedInventory:t.unlockedInventory,unlockedRewards:t.unlockedRewards})},t.setCurrentUser=function(t){this._currentUser=t},t.getCurrentUser=function(){return this._currentUser},t.getUser=function(e){return t.fromJson(cc.sys.localStorage.getItem(e))},t.deleteUser=function(e){cc.sys.localStorage.removeItem(e);var n=t.getUserIds(),r=n.indexOf(e);n.splice(r,1),cc.sys.localStorage.setItem(o.USER_ID,JSON.stringify(n))},t.createUserOrFindExistingUser=function(e){var o=this.getUser(e.id);return o||t.createUser(e.name,e.imgPath,e.age,e.gender,e.id,e.avatarImage||e.imgPath,e.isTeacher)},t}();o.User=p;var h=function(){function t(){}return t.initialize=function(){0==Object.keys(this._settings).length&&(this.setValue(o.LANGUAGE,o.availLanguages[0]),this.setValue(o.SFX_OFF,"false"),this.setValue(o.MUSIC_OFF,"false"))},t.getValue=function(t){return this._settings[t]},t.setValue=function(t,e){this._settings[t]=e,cc.sys.localStorage.setItem(t,e)},t.getItem=function(t){return Number(this._profile[t]||0)},t.deleteItem=function(t){return Number(this._profile[t]||0)},t.setItem=function(t,e){this._profile[t]=e,cc.sys.localStorage.setItem(a.default.currentProfile(),JSON.stringify(this._profile))},t.fromJsonUsingParse=function(t){var e=JSON.parse(t||"{}"),o=a.default.currentProfile();cc.sys.localStorage.setItem(o,JSON.stringify(e))},t.toJson=function(){},Object.defineProperty(t,"lastWorld",{get:function(){return this.getItem(c.default.getInstance().courseId+"World")},set:function(t){this.setItem(c.default.getInstance().courseId+"World",t),this.setItem(c.default.getInstance().courseId+"Level",0),this.toJson()},enumerable:!1,configurable:!0}),Object.defineProperty(t,"lastLevel",{get:function(){return this.getItem(c.default.getInstance().courseId+"Level")},set:function(t){this.lastLevel<t&&(this.setItem(c.default.getInstance().courseId+"Level",t),this.toJson())},enumerable:!1,configurable:!0}),t.isGameCompleted=function(t,e,o){return 1==this.getItem(c.default.getInstance().courseId+"_"+t+"_"+e+"_"+o)},t.setGameCompleted=function(t,e,o,n){void 0===n&&(n=!0),this.setItem(c.default.getInstance().courseId+"_"+t+"_"+e+"_"+o,n?1:0),this.toJson()},t.teacherPostLoginActivity=function(t){return n(this,void 0,void 0,function(){var e;return r(this,function(o){return e=p.createUserOrFindExistingUser({id:t}),p.setCurrentUser(e),{},[2]})})},t._profile={},t._loaded=!1,t._userIdList=[],t._settings={},t}();o.default=h,cc._RF.pop()},{"../../../queue":"queue","../util-logger":"util-logger","./config":"config","./constants":"constants"}],progressMonitor:[function(t,e,o){"use strict";cc._RF.push(e,"d0b6fkKhtlG0Zv03asj558b","progressMonitor");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.StarType=void 0;var i,a=t("./lib/config"),c=cc._decorator,s=c.ccclass,l=c.property;(function(t){t[t.Default=0]="Default",t[t.Correct=1]="Correct",t[t.Wrong=2]="Wrong"})(i=o.StarType||(o.StarType={}));var u=["rewards/fruits/baag/red_bellpepper","rewards/fruits/baag/yellow_bellpepper","rewards/fruits/baag/carrot","rewards/fruits/baag/popato","rewards/fruits/baag/tomato","rewards/fruits/baag/red_chillie","rewards/fruits/baag/brocolli","rewards/fruits/baag/cucumber","rewards/fruits/baag/green_chillie","rewards/fruits/baag/turnip","rewards/fruits/sehar/omlette","rewards/fruits/sehar/coffee","rewards/fruits/sehar/yogurt","rewards/fruits/sehar/boiled_egg","rewards/fruits/sehar/butter","rewards/fruits/sehar/cheese","rewards/fruits/sehar/porridge","rewards/fruits/sehar/salad","rewards/fruits/sehar/bread_sliced","rewards/fruits/sehar/tea","rewards/fruits/badal/chickoo","rewards/fruits/badal/pineapple","rewards/fruits/badal/mango","rewards/fruits/badal/cherry","rewards/fruits/badal/orange","rewards/fruits/badal/grapes","rewards/fruits/badal/apple","rewards/fruits/badal/pear","rewards/fruits/badal/banana","rewards/fruits/badal/strawberry","rewards/fruits/samundra/prawns","rewards/fruits/samundra/coconut","rewards/fruits/samundra/watermelon","rewards/fruits/samundra/tender_coconut","rewards/fruits/samundra/lemon","rewards/fruits/samundra/orange_juice","rewards/fruits/samundra/kiwi","rewards/fruits/samundra/juice","rewards/fruits/samundra/lemon_wedge","rewards/fruits/samundra/fish","rewards/fruits/barf/salmon","rewards/fruits/barf/bread","rewards/fruits/barf/momos","rewards/fruits/barf/meat","rewards/fruits/barf/rice","rewards/fruits/barf/sushi","rewards/fruits/barf/chicken_meat","rewards/fruits/barf/jam","rewards/fruits/barf/dumpling","rewards/fruits/barf/soup","rewards/fruits/sagar/squid","rewards/fruits/sagar/fish_eggs","rewards/fruits/sagar/lobster","rewards/fruits/sagar/cilantro","rewards/fruits/sagar/tuna","rewards/fruits/sagar/garlic","rewards/fruits/sagar/crab","rewards/fruits/sagar/mussel","rewards/fruits/sagar/seaweed","rewards/fruits/sagar/sardine","rewards/fruits/jungle/corn","rewards/fruits/jungle/wheat","rewards/fruits/jungle/honeycomb","rewards/fruits/jungle/chicken","rewards/fruits/jungle/honey","rewards/fruits/jungle/milk","rewards/fruits/jungle/meat","rewards/fruits/jungle/cabbage","rewards/fruits/jungle/egg","rewards/fruits/jungle/pumpkin","rewards/fruits/udyaan/coffee_bean","rewards/fruits/udyaan/chestnut","rewards/fruits/udyaan/dango","rewards/fruits/udyaan/peanut","rewards/fruits/udyaan/sausage","rewards/fruits/udyaan/acorn","rewards/fruits/udyaan/sandwich","rewards/fruits/udyaan/cashew","rewards/fruits/udyaan/almond","rewards/fruits/udyaan/roasted_sausage","rewards/fruits/khet/honeydew","rewards/fruits/khet/mushroom","rewards/fruits/khet/raspberry","rewards/fruits/khet/peach","rewards/fruits/khet/black_currant","rewards/fruits/khet/dragonfruit","rewards/fruits/khet/blackberry","rewards/fruits/khet/button_mushroom","rewards/fruits/khet/redcurrant","rewards/fruits/khet/enoki_mushroom","rewards/fruits/registan/grapefruit","rewards/fruits/registan/coco_bean","rewards/fruits/registan/starfruit","rewards/fruits/registan/litchi","rewards/fruits/registan/date","rewards/fruits/registan/mangosteen_sliced","rewards/fruits/registan/mangosteen","rewards/fruits/registan/starfruit_sliced","rewards/fruits/registan/jackfruit","rewards/fruits/registan/dry_coconut"],d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.complete=null,e.current=null,e.incomplete=null,e.correct=null,e.wrong=null,e.totalStars=0,e.stopStar=!1,e.fruit=null,e}return n(e,t),e.prototype.onLoad=function(){var t=this,e=a.default.getInstance(),o=u[Math.floor(Math.random()*u.length)];cc.resources.load(o,cc.SpriteFrame,function(e,o){e||(t.fruit=o)}),this.totalStars=e.totalProblems;for(var n=1;n<=this.totalStars;n++){var r=new cc.Node;r.name=n.toString();var i=new cc.Node;i.name="sprite",r.addChild(i);var c=i.addComponent(cc.Sprite);n<e.problem||(n==e.problem?c.spriteFrame=this.current:c.spriteFrame=this.incomplete),r.width=2*i.width,r.height=2*i.height,console.log(n),this.node.addChild(r)}},e.prototype.updateProgress=function(t,e,o){var n=this,r=new cc.Node;if(r.addComponent(cc.Sprite).spriteFrame=e==i.Wrong?this.wrong:this.fruit,e==i.Correct){var a=new cc.Node;a.addComponent(cc.Sprite).spriteFrame=this.correct,r.addChild(a)}r.name=t.toString(),r.scale=.5;var c=cc.v2(cc.winSize.width*Math.random()-cc.winSize.width/2,-cc.winSize.height-100);r.setPosition(c);var s=this.node.getChildByName(t.toString());if(null!=s){var l=s.getChildByName("sprite");if(null!=l){s.addChild(r);var u=cc.v2(cc.winSize.width/2*Math.random()-cc.winSize.width/4,-cc.winSize.height/2);r.runAction(cc.sequence(cc.spawn(cc.scaleTo(.5,1),cc.bezierTo(.5,[cc.v2(c.add(u).mul(.33).add(cc.v2(200,0))),cc.v2(c.add(u).mul(.33).add(cc.v2(100,0))),u])),cc.rotateBy(.1,15),cc.rotateBy(.1,-15),cc.rotateBy(.1,15),cc.rotateBy(.1,-15),cc.spawn(cc.moveTo(.5,l.position),cc.scaleTo(.5,.5)),cc.callFunc(function(){(l.removeFromParent(),t<n.totalStars)&&(n.node.getChildByName((t+1).toString()).getChildByName("sprite").getComponent(cc.Sprite).spriteFrame=n.current);o()})))}}},r([l(cc.SpriteFrame)],e.prototype,"complete",void 0),r([l(cc.SpriteFrame)],e.prototype,"current",void 0),r([l(cc.SpriteFrame)],e.prototype,"incomplete",void 0),r([l(cc.SpriteFrame)],e.prototype,"correct",void 0),r([l(cc.SpriteFrame)],e.prototype,"wrong",void 0),e=r([s],e)}(cc.Component);o.default=d,cc._RF.pop()},{"./lib/config":"config"}],queue:[function(t,e,o){"use strict";cc._RF.push(e,"38a63Fp8GJKc7q7xPGC81jl","queue"),Object.defineProperty(o,"__esModule",{value:!0}),o.Queue=o.QUEUE_CACHE=void 0;var n=t("./common/scripts/lib/constants");o.QUEUE_CACHE="QUEUE_CACHE";var r=function(){function t(){this._store=[]}return t.init=function(){t.getInstance()},t.getInstance=function(){return t.instance||(t.instance=new t,n.PARSE_ENABLED&&(t.instance._store=t.instance.getFromCache())),t.instance},t.prototype.push=function(t){n.PARSE_ENABLED&&(this._store.push(t),cc.sys.localStorage.setItem(o.QUEUE_CACHE,JSON.stringify(this._store)))},t.prototype.pop=function(){var t=void 0;return n.PARSE_ENABLED&&(t=this._store.shift(),cc.sys.localStorage.setItem(o.QUEUE_CACHE,JSON.stringify(this._store))),t},t.prototype.isEmpty=function(){return 0===this._store.length},t.prototype.getFromCache=function(){try{return JSON.parse(cc.sys.localStorage.getItem(o.QUEUE_CACHE))||[]}catch(t){return[]}},t}();o.Queue=r,cc._RF.pop()},{"./common/scripts/lib/constants":"constants"}],"quiz-monitor":[function(t,e,o){"use strict";cc._RF.push(e,"386c90A60tEro/bc7nZBHiS","quiz-monitor");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.QUIZ_ANSWERED=void 0;var i=cc._decorator.ccclass,a=cc._decorator.property,c=t("./lib/config"),s=t("./lib/error-handler");o.QUIZ_ANSWERED="QUIZ_ANSWERED";var l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.correctImage=null,e.wrongImage=null,e.emptyImage=null,e.imageNode=null,e.totalItems=0,e.stopStar=!1,e}return n(e,t),e.prototype.onLoad=function(){this.totalItems=c.default.getInstance().totalProblems;for(var t=1;t<=this.totalItems;t++){var e=new cc.Node;this.createRewardStar(e,t),this.node.addChild(e)}},e.prototype.createRewardStar=function(t,e){t.name=e.toString();var o=cc.instantiate(this.imageNode);o.name="sprite",o.group="gameCamera",t.addChild(o),o.getComponent(cc.Sprite).spriteFrame=this.emptyImage,t.width=o.width,t.height=o.height},e.prototype.updateProgress=function(t,e){var o=new cc.Node;o.addComponent(cc.Sprite).spriteFrame=this.stopStar?this.correctImage:this.wrongImage,o.name=t.toString();var n=this.node.getChildByName(t.toString());if(null!=n){var r=n.getChildByName("sprite");null!=r&&(r.removeFromParent(),n.addChild(o),e())}},r([a(cc.SpriteFrame)],e.prototype,"correctImage",void 0),r([a(cc.SpriteFrame)],e.prototype,"wrongImage",void 0),r([a(cc.SpriteFrame)],e.prototype,"emptyImage",void 0),r([a(cc.Prefab)],e.prototype,"imageNode",void 0),r([s.default()],e.prototype,"onLoad",null),r([s.default()],e.prototype,"createRewardStar",null),r([s.default()],e.prototype,"updateProgress",null),e=r([i],e)}(cc.Component);o.default=l,cc._RF.pop()},{"./lib/config":"config","./lib/error-handler":"error-handler"}],singlelettertracing:[function(t,e,o){"use strict";cc._RF.push(e,"98bf6xTIJpBmaG5DyHWWMOH","singlelettertracing");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.SingleLetterTracing=o.TRACE_NODE_POS_Y=o.TRACE_NODE_POS_X=o.LETTER_SCALE=void 0;var i=cc._decorator.ccclass,a=cc._decorator.property,c=t("../../../common/scripts/helper"),s=t("../../../common/scripts/util"),l=t("../../../common/Tracing/scripts/tracing-container"),u=t("./writeword");o.LETTER_SCALE=.95,o.TRACE_NODE_POS_X=-256,o.TRACE_NODE_POS_Y=-300;var d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._tracingContainerComponent=null,e._traceGraphics=null,e._letter=null,e._wordTracingContainer=null,e._wordTracingComponent=null,e._tracingScale=null,e._sound=null,e}return n(e,t),e.prototype.onLoad=function(){var t=this;cc.director.getCollisionManager().enabled=!1,this._wordTracingComponent=this._wordTracingContainer.getComponent(u.default),this._tracingContainer=cc.instantiate(this.tracingContainerPrefab),this._tracingContainer.scale=.75,this._wordTracingContainer.on(c.CONFIG_LOADED,function(){t.setAlphabetToDisplay(t._letter),t.loadSounds(t._letter)})},e.prototype.loadSounds=function(t){var e=this;isNaN(Number(t))?s.Util.loadsPhonicsOrLetter(t.toLowerCase(),function(t){e._sound=t}):s.Util.loadNumericSound(t,function(t){e._sound=t})},e.prototype.preloadSound=function(t,e){var o=this,n=e+t;s.Util.load(n,function(t,e){t||null===e||(o._sound=e)})},e.prototype.pronounce=function(){s.Util.speakPhonicsOrLetter(this._letter,function(){})},e.prototype.setAlphabetToDisplay=function(t){var e=this;this._tracingContainerComponent=this._tracingContainer.getComponent(l.default),this._tracingContainerComponent.tracingLetter=t,this._tracingContainerComponent.traceGenerationMode=!1,this.node.addChild(this._tracingContainer),null!==this._tracingScale?this._tracingContainerComponent._traceGraphicsComponent.adjustedScale=this._tracingScale:this._tracingContainerComponent._traceGraphicsComponent.adjustedScale=o.LETTER_SCALE,this._traceGraphics=this._tracingContainerComponent.traceGraphics,this._tracingContainer.setPosition(new cc.Vec2(o.TRACE_NODE_POS_X,o.TRACE_NODE_POS_Y)),this.node.on("letterEnabledEvent",function(t,o){void 0===o&&(o=0),e._order===t&&e.scheduleOnce(function(){e._traceGraphics.emit("enabledGraphics")},o)}),this.node.width=this._tracingContainer.width},e.prototype.onDestroy=function(){cc.audioEngine.stopAllEffects()},Object.defineProperty(e.prototype,"letter",{set:function(t){this._letter=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"wordTracingContainer",{set:function(t){this._wordTracingContainer=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"order",{get:function(){return this._order},set:function(t){this._order=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tracingScale",{get:function(){return this._tracingScale},set:function(t){this._tracingScale=t},enumerable:!1,configurable:!0}),r([a(cc.Prefab)],e.prototype,"tracingContainerPrefab",void 0),e=r([i],e)}(cc.Component);o.SingleLetterTracing=d,cc._RF.pop()},{"../../../common/Tracing/scripts/tracing-container":"tracing-container","../../../common/scripts/helper":"helper","../../../common/scripts/util":"util","./writeword":"writeword"}],"trace-gen-container":[function(t,e,o){"use strict";cc._RF.push(e,"2cd9d3gQ7VNbYksOZvcod9Z","trace-gen-container");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator.ccclass,a=t("./tracing-container"),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._fileName=null,e._tracingContainerVisible=!1,e}return n(e,t),e.prototype.onLoad=function(){this._recordContainer=this.node.getChildByName("recordContainer"),this._recordContainer.getComponent(a.default).traceGenerationMode=!0,this._tracingContainer=this.node.getChildByName("tracingConainer"),this._tracingContainer.getComponent(a.default).traceGenerationMode=!1,this._tracingContainer.active=!1},e.prototype.start=function(){var t=this._recordContainer.getComponent(a.default);t.traceGenerationMode=!0,this._fileName=t.traceObject.name,null!==cc.sys.localStorage.getItem(this._fileName)&&(this._tracingContainer.active=!0,this._tracingContainerVisible=!0,this._recordContainer.getComponent(a.default).showGeneratedPath())},e.prototype.update=function(t){},e=r([i],e)}(cc.Component);o.default=c,cc._RF.pop()},{"./tracing-container":"tracing-container"}],"trace-graphics":[function(t,e,o){"use strict";cc._RF.push(e,"7afd1G+VFxPtJxi3y2EUala","trace-graphics");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator.ccclass,a=cc._decorator.property,c=cc.Color,s=t("./tracing-container"),l=t("./tracing-node"),u=t("./indicator-node"),d=t("./arrow-node"),p=t("../../scripts/lib/config"),h=t("../../scripts/lib/error-handler"),f=t("../../scripts/util"),g=t("../../scripts/helper"),_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lineWidth=0,e.traceAudio=null,e.star=null,e.staringImage=null,e.arrowImage=null,e.endingImage=null,e.indicator=null,e.tracingNode=null,e.arrowNode=null,e.imageNode=null,e.tracingImageNode=null,e.indicatorNode=null,e.tracingContainerComponent=null,e._traceAudioId=null,e._traceSoundOn=!1,e._graphics=null,e._prevPoint=null,e._currPoint=null,e._recordPoint=null,e._firstTouchInCurrentPath=!1,e._isTouchNotReleased=!1,e._traceGenerationMode=!1,e._shouldUpdateStartIndicator=!0,e._starNodesInPath=[],e._matchingRects=[],e._animationPoints=[],e._hand=null,e._showHelp=!1,e._currentMatchingRect=null,e._currentPathIndex=0,e._path=0,e._allTracePoints=[],e._validationOfCurrentPathCompleted=!1,e._touchEnabled=!1,e._tracingContainer=null,e._adjustedScale=1,e._isValid=!1,e._isTouchStartValid=!1,e._finishCounter=0,e._lastValidPointIndexInCurrentPath=0,e._lastStarNodeInCurrentPath=null,e._startIndicator=null,e._endIndicator=null,e._mTrigger=!1,e._totalValidationCheckPoints=0,e._tracingFinished=!1,e._indicatorNodeComponent=null,e._lastCounterValue=0,e._activeStarsTillIndex=-1,e.currentArrowValue=0,e.nextArrowValue=0,e.arrowPos=null,e.arrowStarCounter=0,e._displayNodes=[],e._displayScheduler=null,e.displayIterator=function(t,e,o,n){var r;return void 0===o&&(o=1/0),void 0===n&&(n=1),(r={})[Symbol.iterator]=function(){var r=!1,i=0;return{next:function(){return i=e,e=(r=e>=o)?i:e+n,{done:r,value:t[i]}}}},r},e}return n(e,t),e.prototype.onLoad=function(){var t=this;cc.log("onLoad trace graphics"),cc.director.getCollisionManager().enabled=!0,this.node.opacity=0,this.node.width=cc.winSize.width,this.node.height=cc.winSize.height,this._graphics=this.getComponent(cc.Graphics),this._graphics.node.opacity=0,this._graphics.lineJoin=cc.Graphics.LineJoin.ROUND,this._graphics.lineCap=cc.Graphics.LineCap.ROUND,this._graphics.strokeColor=this.strokeColor,this._graphics.lineWidth=this.lineWidth,this._tracingContainer=this.node.parent.getComponent(s.default),null==this._hand&&void 0==this._hand||(this._hand.active=!1),this.node.on("enabledGraphics",function(){var e=!0;try{e=isNaN(parseInt(t._traceObject.name))}catch(t){}t.loadTracePath(t._traceObject.name,!e)}),cc.log("onLoad trace graphics completed")},e.prototype.start=function(){cc.log("start called -> trace graphics"),this.strokeColor=cc.Color.WHITE},e.prototype.loadTracePath=function(t,e){var o=this;void 0===e&&(e=!1),p.default.getInstance().loadPathJSON(t,function(t){t&&t.length>0&&(o._allTracePoints=JSON.parse(t)||[]),o.postLoadPath()},e)},e.prototype.postLoadPath=function(){this.findHand(),this.postLoad(),this.enableTouchHandlers(),this.node.opacity=255},e.prototype.findHand=function(){this.traceGenerationMode||(this._showHelp=!0,this._hand=this.node.parent.getChildByName("hand"),this.scheduleHelpAnimation())},e.prototype.enableTouchHandlers=function(){this.node.on(f.TouchEvents.TOUCH_START,this.onTouchStart,this),this.node.on(f.TouchEvents.TOUCH_MOVE,this.onTouchMove,this),this.node.on(f.TouchEvents.TOUCH_END,this.onTouchEnd,this),this.node.on(f.TouchEvents.TOUCH_CANCEL,this.onTouchEnd,this),this._touchEnabled=!0},e.prototype.disableTouchHandlers=function(){this.node.off(f.TouchEvents.TOUCH_START,this.onTouchStart,this),this.node.off(f.TouchEvents.TOUCH_MOVE,this.onTouchMove,this),this.node.off(f.TouchEvents.TOUCH_END,this.onTouchEnd,this),this._touchEnabled=!1},e.prototype.postLoad=function(){this.renderStar(this._path),this.configureCurrentValidationPath(this._path)},e.prototype.showIndicators=function(){this._touchEnabled=!0,this.drawStartPointInCurrentPath(),this.drawEndPointInCurrentPath(),this._mTrigger=!1},e.prototype.isTouchValid=function(t){return!!this.traceGenerationMode||(this._indicatorNodeComponent&&this._lastCounterValue<=0&&(this._lastCounterValue=this._indicatorNodeComponent.counterValue),!!this._indicatorNodeComponent&&this._indicatorNodeComponent.collisionCount>0&&this._startIndicator.getBoundingBox().contains(t)?(this._touchEnabled=!0,this._isValid=!0,this._lastCounterValue=this._indicatorNodeComponent&&this._indicatorNodeComponent.counterValue>this._lastCounterValue?this._indicatorNodeComponent.counterValue:this._lastCounterValue):this._isValid=!1,this._isValid)},e.prototype.setUpGraphics=function(){this._graphics.lineJoin=cc.Graphics.LineJoin.ROUND,this._graphics.lineCap=cc.Graphics.LineCap.ROUND,this._graphics.strokeColor=this.strokeColor,this._graphics.lineWidth=this.lineWidth},e.prototype.onTouchStart=function(t){cc.log("onTouchStart"),this._touchEnabled&&(this._hand&&(this._hand.opacity=0),this._currPoint=this._prevPoint=this._recordPoint=this._traceObject.parent.convertToNodeSpaceAR(t.getLocation()),this.traceGenerationMode?(this.setUpGraphics(),this._graphics.moveTo(this._prevPoint.x,this._prevPoint.y),this._graphics.strokeColor=c.GRAY,this._tracingContainer.resetCurrentTracingPart(),this.recordPoint(!1)):this._isTouchStartValid=this.isTouchValid(this._currPoint),this._isTouchNotReleased=!0,this._isValid?(cc.log("onTouchStart valid"),this._startIndicator.opacity=255,this._endIndicator.opacity=255):this.stopTracingSound())},e.prototype.highLightStarNodes=function(t,e){var o=this;if(!this._mTrigger){var n=[];if(this._starNodesInPath.map(function(n,r){if(!1===n.active&&n.getBoundingBox().contains(t)&&r<=e)return o._activeStarsTillIndex=r,{oIndex:r,node:n}}),(n=(n=n.filter(function(t){return void 0!==t})).slice(0,n.length))&&n.length>0){var r=n[n.length-1],i=r.oIndex;this._lastValidPointIndexInCurrentPath<=i&&(this._shouldUpdateStartIndicator=!0),this._lastValidPointIndexInCurrentPath=this._starNodesInPath.indexOf(r.node),this._lastStarNodeInCurrentPath=r.node,n.forEach(function(t){t.node.opacity=255,t.node.active=!0,null!==o._starNodesInPath[t.oIndex]&&(o._starNodesInPath[t.oIndex].active=!0)})}}},e.prototype.onTouchMove=function(t){var e=this;if(this._isValid=this._isTouchStartValid&&!!this._indicatorNodeComponent&&this._indicatorNodeComponent.collisionCount>0,this._touchEnabled&&(this._isValid||this.traceGenerationMode)){this._lastCounterValue=this._indicatorNodeComponent.counterValue>this._lastCounterValue?this._indicatorNodeComponent.counterValue:this._lastCounterValue,this._hand&&(this._hand.opacity=0);var o=this._traceObject.parent.convertToNodeSpaceAR(t.getLocation()),n=new cc.Vec2(1/this.adjustedScale*t.getDelta().x,1/this.adjustedScale*t.getDelta().y);o=o.add(n),this._currPoint=o,this.traceGenerationMode?(this._graphics.lineTo(this._currPoint.x,this._currPoint.y),this._graphics.stroke(),this._prevPoint=this._currPoint,this._graphics.moveTo(this._prevPoint.x,this._prevPoint.y),this.doAdditionalCheckToRecordPointsOnMove()):null!==this.arrowPos&&(cc.log("onTouchMove valid",this._isValid),this.highLightStarNodes(this.arrowPos,this.arrowStarCounter),this._starNodesInPath.forEach(function(t,o){o<e._activeStarsTillIndex&&!1===t.active&&(t.active=!0,e._lastStarNodeInCurrentPath=e._starNodesInPath[o])}),this._isValid&&this._startIndicator.setPosition(this._currPoint)),this._isTouchNotReleased=!0}else this.stopTracingSound()},e.prototype.loadImage=function(t){var e=cc.instantiate(this.imageNode);e.scale=1.5,e.getComponent(cc.Sprite).spriteFrame=this.star,e.setPosition(t),this._tracingContainer.node.addChild(e),e.zIndex=99},e.prototype.loadIndicator=function(t,e,o){var n=cc.instantiate(this.tracingNode);n.name="tracingNode",n.getComponent(cc.Sprite).spriteFrame=this.indicator,n.setPosition(e),n.scale=.75;var r=n.getComponent(l.default);r.counter=o,r.currentPath="c"+t,this._tracingContainer.node.addChild(n),n.zIndex=99,n.opacity=0},e.prototype.loadArrow=function(t,e,o,n){var r=cc.instantiate(this.arrowNode);r.name="arrowNode",r.getComponent(cc.Sprite).spriteFrame=this.arrowImage,r.setPosition(e),r.scale=.5;var i=r.getComponent(d.default);i.currentPath="c"+t,i.arrowValue=o,i.starCounter=n,this._tracingContainer.node.addChild(r),r.zIndex=99,r.opacity=0},e.prototype.loadDisplay=function(t){var e=cc.instantiate(this.tracingImageNode);e.name="displayNode",e.setPosition(t),e.opacity=0,this._displayNodes.push(e),this._tracingContainer.node.addChild(e)},e.prototype.createStarAtPos=function(t,e){var o=cc.instantiate(this.imageNode);o.name="starNode",o.scale=1.5,o.getComponent(cc.Sprite).spriteFrame=this.star,o.setPosition(e),this._tracingContainer.node.addChild(o),o.zIndex=99,o.active=!1,t.push(o)},e.prototype.playTracingSound=function(){if(!this._traceSoundOn&&!this.traceGenerationMode){this._traceSoundOn=!0;try{this.traceAudio&&(this._traceAudioId=f.Util.playSfx(this.traceAudio,!0,!0))}catch(t){}}},e.prototype.doAdditionalCheckToRecordPointsOnMove=function(){this.traceGenerationMode&&(this._currPoint.sub(this._recordPoint).magSqr()>=10&&(this._recordPoint=this._currPoint,this.recordPoint(!1)))},e.prototype.onTouchEnd=function(t){this.stopTracingSound(),this._endIndicator.opacity=0,this._startIndicator.opacity=0,this.traceGenerationMode?this.recordPoint(!0):(this._isValid&&this._touchEnabled&&(this._lastCounterValue=this._indicatorNodeComponent.counterValue>this._lastCounterValue?this._indicatorNodeComponent.counterValue:this._lastCounterValue,this._shouldUpdateStartIndicator&&this._lastStarNodeInCurrentPath&&this._startIndicator.setPosition(this._lastStarNodeInCurrentPath.getPosition())),this.checkIfAllValidateTraceCompleted(),this._tracingFinished||(this._startIndicator.opacity=255),this.stopTracingSound())},e.prototype.scheduleHelpAnimation=function(){var t=this;this.scheduleOnce(function(){t._showHelp=!0,t._hand.active=!0,t.animate()},5)},e.prototype.stopTracingSound=function(){!this.traceGenerationMode&&this._traceAudioId&&this._traceSoundOn&&(cc.audioEngine.stop(this._traceAudioId),this._traceSoundOn=!1)},e.prototype.recordPoint=function(t){this.traceGenerationMode&&(this._graphics.lineTo(this._currPoint.x,this._currPoint.y),this._graphics.stroke(),this._tracingContainer.recordTouchPoint(this._currPoint,t))},e.prototype.getTouchLocation=function(){return this._isTouchNotReleased?this._currPoint:null},e.prototype.checkIfAllValidateTraceCompleted=function(){this.currentArrowValue>=this._totalValidationCheckPoints&&(this._validationOfCurrentPathCompleted=!0,this.node.dispatchEvent(new cc.Event.EventCustom(g.TRACING_CORRECT,!0)),this.moveToNextPath())},e.prototype.rectAroundPoint=function(t){return cc.Rect.fromMinMax(new cc.Vec2(t.x-20,t.y-20),new cc.Vec2(t.x+20,t.y+20))},e.prototype.setUpDebugDrawGraphics=function(){var t=this;this._graphics.strokeColor=cc.Color.BLUE,this._graphics.lineWidth=1,this._matchingRects.forEach(function(e){t._graphics.rect(e.x,e.y,e.width,e.height),t._graphics.stroke()})},e.prototype.renderStar=function(t){var e=this;(this._starNodesInPath=[],this._allTracePoints.length>t)&&this._allTracePoints[t].forEach(function(t){e.createStarAtPos(e._starNodesInPath,new cc.Vec2(t.x,t.y))})},e.prototype.drawStartPointInCurrentPath=function(){var t=this;this.scheduleOnce(function(){t.createStartIndicator(),t._starNodesInPath.length>0&&(t._startIndicator.setPosition(t._starNodesInPath[0].getPosition()),t._startIndicator.active=!0,t._startIndicator.zIndex=100,t._tracingContainer.node.children.filter(function(t){return"displayNode"===t.name}).forEach(function(t){t.opacity=255,t.active=!0}),t.animateDisplayNodes(t._displayNodes))})},e.prototype.drawEndPointInCurrentPath=function(){var t=this;this.scheduleOnce(function(){t.createEndIndicator(),t._starNodesInPath.length>0&&(t._endIndicator.setPosition(t._starNodesInPath[t._starNodesInPath.length-1].getPosition()),t._endIndicator.active=!0,t._endIndicator.zIndex=100)})},e.prototype.createStartIndicator=function(){return this._startIndicator&&this._startIndicator.removeFromParent(!0),this._startIndicator=cc.instantiate(this.indicatorNode),this._indicatorNodeComponent=this._startIndicator.getComponent(u.default),this._indicatorNodeComponent.traceGraphics=this,this._indicatorNodeComponent.currentPath="c"+this._path,this._startIndicator.getComponent(cc.CircleCollider).radius=18,this._startIndicator.name="startImage",this._startIndicator.name="startImage",this._startIndicator.zIndex=100,this._startIndicator.scale=2.5,this._startIndicator.opacity=255,this._startIndicator.getComponent(cc.Sprite).spriteFrame=this.staringImage,this.node.parent.addChild(this._startIndicator),this._startIndicator},e.prototype.createEndIndicator=function(){return this._endIndicator||(this._endIndicator=cc.instantiate(this.imageNode),this._endIndicator.name="endImage",this._endIndicator.zIndex=100,this._endIndicator.scale=2.5,this._endIndicator.opacity=255,this._endIndicator.getComponent(cc.Sprite).spriteFrame=this.endingImage,this.node.parent.addChild(this._endIndicator)),this._endIndicator},e.prototype.distanceBetweenPoints=function(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))},e.prototype.computeDistance=function(t){for(var e=0;e<t.length;e++)for(var o=e;o<t.length;o++){var n=t[e],r=t[o];this.distanceBetweenPoints(n,r)>=45&&(e=o,this.loadDisplay(new cc.Vec2(n.x,n.y)))}this._starNodesInPath.length>10&&this.loadDisplay(this._starNodesInPath[this._starNodesInPath.length-10].getPosition())},e.prototype.configureCurrentValidationPath=function(t){var e=this;this._matchingRects=[],this._animationPoints=[],this._validationOfCurrentPathCompleted=!1;var o=0,n=0;if(this._allTracePoints.length>t){var r=this._allTracePoints[t];this.computeDistance(r),this._finishCounter=r.length-1,o=0,n=0,r.forEach(function(i,a){n=a,0===a?(e.loadIndicator(t,new cc.Vec2(i.x,i.y),a+1),o++,e.loadArrow(t,new cc.Vec2(i.x,i.y),o,a+1)):a%5==0?(e.loadIndicator(t,new cc.Vec2(i.x,i.y),a+1),a%15==0&&(o++,e.loadArrow(t,new cc.Vec2(i.x,i.y),o,a+1))):a===r.length-1&&(o++,e.loadIndicator(t,new cc.Vec2(i.x,i.y),a+1),e.loadArrow(t,new cc.Vec2(i.x,i.y),o,a+1));var c=e.rectAroundPoint(i);e._matchingRects.push(c),e._animationPoints.push({x:c.x+c.width/2,y:c.y+c.height/2})})}o++,this._starNodesInPath[this._starNodesInPath.length-1]&&this.loadArrow(t,this._starNodesInPath[this._starNodesInPath.length-1].getPosition(),o,n+1),this._totalValidationCheckPoints=o,this.showIndicators(),this.scheduleOnce(function(){null!==e._displayScheduler&&e.unschedule(e._displayScheduler),e._displayScheduler=function(){e.animateDisplayNodes(e._displayNodes)},e.schedule(e._displayScheduler,3)})},e.prototype.animateDisplayNodes=function(t){var e=this.displayIterator(t,0,t.length)[Symbol.iterator]();this.getNextFromIterator(e)},e.prototype.getNextFromIterator=function(t){var e=this,o=t.next();!o.done&&o.value?this.glowDisplay(o.value,function(){e.getNextFromIterator(t)}):t=null},e.prototype.glowDisplay=function(t,e){var o=t.getComponent(cc.Animation);null!==o&&(o.stop(),o.on("finished",function(){e()},this),o.play("glowing_dot"))},e.prototype.drawDebugPath=function(t){t&&this._currentPathIndex>0&&this.setUpDebugDrawGraphics()},e.prototype.moveToNextPath=function(){var t=this;this._lastStarNodeInCurrentPath=null,this.currentArrowValue=0,this.nextArrowValue=0,this.arrowPos=null,this._activeStarsTillIndex=-1,this._endIndicator.active=!1,this._startIndicator.active=!1,this._lastCounterValue=0,this._firstTouchInCurrentPath=!1,this._lastValidPointIndexInCurrentPath=-1,this.stopTracingSound(),this._displayNodes.forEach(function(t){t.active=!1,t.removeFromParent(!1)}),this._starNodesInPath.filter(function(t,e){return!1===t.active||0===t.opacity}).forEach(function(t){t.active=!0,t.opacity=255}),this._displayNodes=[],this._tracingContainer.node.children.filter(function(t){return"displayNode"===t.name}).forEach(function(t){t.removeFromParent(!1),t.active=!1}),this._currentPathIndex>=this._allTracePoints.length-1?(this._showHelp=!1,this._touchEnabled=!1,this._tracingFinished||(this._tracingFinished=!0,this.disableTouchHandlers(),this.tracingContainerComponent.node.emit(g.SHOW_CHILD_IMAGE),this.scheduleOnce(function(){t.node.dispatchEvent(new cc.Event.EventCustom(g.TRACING_FINISHED,!0)),t.scheduleOnce(function(){t._hand.opacity=0},1)},1))):(this._mTrigger=!0,this._isValid=!1,this._touchEnabled=!1,this._currentPathIndex=this._currentPathIndex+1,this.renderStar(this._currentPathIndex),this._path=this._path+1,this._animationPoints=[],this._starNodesInPath.forEach(function(t){t.active=!1}),this._showHelp=!0,this.configureCurrentValidationPath(this._path))},e.prototype.moveBackToCurrentPath=function(){this._mTrigger=!0,this._isValid=!1,this._touchEnabled=!1,this._lastCounterValue=0,this._currentPathIndex=this._currentPathIndex,this._starNodesInPath.forEach(function(t){t.active=!1}),this._path=this._path,this._animationPoints=[],this._showHelp=!0,this.showIndicators()},e.prototype.animate=function(){var t=this;if(!this._validationOfCurrentPathCompleted&&!this.traceGenerationMode&&this._showHelp)try{this._hand.opacity=255,this._hand.active=!0;for(var e=[],o=0;o<this._animationPoints.length;o++){var n=this._animationPoints[o];e.push(cc.moveTo(.02,new cc.Vec2(n.x,n.y)))}null!=e&&e.length>0&&e.push(cc.callFunc(function(){t._hand.active=!1,t.scheduleHelpAnimation()},this)),null!=e&&e.length>0&&(null!==this._hand||void 0!==this._hand)&&this._hand.active&&this._hand.runAction(cc.sequence(e))}catch(t){}},e.prototype.drawCircleInTracingMode=function(t){var e=this;this._graphics.strokeColor=c.BLUE;try{JSON.parse(cc.sys.localStorage.getItem(t)).forEach(function(t){var o=t.shift();e._graphics.moveTo(o.x,o.y),t.forEach(function(t,o){o%5==0&&(e._graphics.circle(t.x,t.y,5),e._graphics.stroke())})})}catch(t){}},Object.defineProperty(e.prototype,"traceObject",{get:function(){return this._traceObject},set:function(t){this._traceObject=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"traceGenerationMode",{get:function(){return this._traceGenerationMode},set:function(t){this._traceGenerationMode=t},enumerable:!1,configurable:!0}),e.prototype.clear=function(){this._graphics.clear(!0),this.stopTracingSound()},e.prototype.onDestroy=function(){this._isValid=!1,this._startIndicator&&(this._startIndicator.active=!1,this._startIndicator.removeFromParent(!0)),this.stopTracingSound()},Object.defineProperty(e.prototype,"adjustedScale",{get:function(){return this._adjustedScale},set:function(t){this._adjustedScale=t},enumerable:!1,configurable:!0}),e.prototype.disableTouchAsNoCollision=function(t){var e=this;try{this._touchEnabled=t,this._tracingFinished||this.scheduleOnce(function(){cc.log("exit"),!e._validationOfCurrentPathCompleted&&e._lastStarNodeInCurrentPath&&e._startIndicator.setPosition(e._lastStarNodeInCurrentPath.getPosition()),e.checkIfAllValidateTraceCompleted(),e._touchEnabled=!0},.1)}catch(t){}},r([a(cc.Color)],e.prototype,"strokeColor",void 0),r([a()],e.prototype,"lineWidth",void 0),r([a({type:cc.AudioClip})],e.prototype,"traceAudio",void 0),r([a(cc.SpriteFrame)],e.prototype,"star",void 0),r([a(cc.SpriteFrame)],e.prototype,"staringImage",void 0),r([a(cc.SpriteFrame)],e.prototype,"arrowImage",void 0),r([a(cc.SpriteFrame)],e.prototype,"endingImage",void 0),r([a(cc.SpriteFrame)],e.prototype,"indicator",void 0),r([a(cc.Prefab)],e.prototype,"tracingNode",void 0),r([a(cc.Prefab)],e.prototype,"arrowNode",void 0),r([a(cc.Prefab)],e.prototype,"imageNode",void 0),r([a(cc.Prefab)],e.prototype,"tracingImageNode",void 0),r([a(cc.Prefab)],e.prototype,"indicatorNode",void 0),r([h.default()],e.prototype,"onLoad",null),r([h.default()],e.prototype,"start",null),r([h.default()],e.prototype,"loadTracePath",null),r([h.default()],e.prototype,"enableTouchHandlers",null),r([h.default()],e.prototype,"disableTouchHandlers",null),r([h.default()],e.prototype,"postLoad",null),r([h.default()],e.prototype,"showIndicators",null),r([h.default()],e.prototype,"isTouchValid",null),r([h.default()],e.prototype,"setUpGraphics",null),r([h.default()],e.prototype,"onTouchStart",null),r([h.default()],e.prototype,"highLightStarNodes",null),r([h.default()],e.prototype,"onTouchMove",null),r([h.default()],e.prototype,"loadImage",null),r([h.default()],e.prototype,"loadIndicator",null),r([h.default()],e.prototype,"loadArrow",null),r([h.default()],e.prototype,"loadDisplay",null),r([h.default()],e.prototype,"createStarAtPos",null),r([h.default()],e.prototype,"playTracingSound",null),r([h.default()],e.prototype,"doAdditionalCheckToRecordPointsOnMove",null),r([h.default()],e.prototype,"onTouchEnd",null),r([h.default()],e.prototype,"scheduleHelpAnimation",null),r([h.default()],e.prototype,"stopTracingSound",null),r([h.default()],e.prototype,"recordPoint",null),r([h.default()],e.prototype,"getTouchLocation",null),r([h.default()],e.prototype,"checkIfAllValidateTraceCompleted",null),r([h.default()],e.prototype,"rectAroundPoint",null),r([h.default()],e.prototype,"setUpDebugDrawGraphics",null),r([h.default()],e.prototype,"renderStar",null),r([h.default()],e.prototype,"drawStartPointInCurrentPath",null),r([h.default()],e.prototype,"drawEndPointInCurrentPath",null),r([h.default()],e.prototype,"createStartIndicator",null),r([h.default()],e.prototype,"createEndIndicator",null),r([h.default()],e.prototype,"distanceBetweenPoints",null),r([h.default()],e.prototype,"computeDistance",null),r([h.default()],e.prototype,"configureCurrentValidationPath",null),r([h.default()],e.prototype,"animateDisplayNodes",null),r([h.default()],e.prototype,"moveToNextPath",null),r([h.default()],e.prototype,"animate",null),r([h.default()],e.prototype,"drawCircleInTracingMode",null),r([h.default()],e.prototype,"disableTouchAsNoCollision",null),e=r([i],e)}(cc.Component);o.default=_,cc._RF.pop()},{"../../scripts/helper":"helper","../../scripts/lib/config":"config","../../scripts/lib/error-handler":"error-handler","../../scripts/util":"util","./arrow-node":"arrow-node","./indicator-node":"indicator-node","./tracing-container":"tracing-container","./tracing-node":"tracing-node"}],"tracing-collider":[function(t,e,o){"use strict";cc._RF.push(e,"a1cacFWmO9DJ5+khTdKmxVv","tracing-collider");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator.ccclass,a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._isTouchInside=!1,e}return n(e,t),e.prototype.onLoad=function(){this._polygonCollider=this.node.getComponent(cc.PolygonCollider),this._isTouchInside=!1},e.prototype.checkIfTouchInsideCollider=function(t){var e=new cc.Vec2(t.x/this.node.scale,t.y/this.node.scale);return!!this._polygonCollider&&!!cc.Intersection.pointInPolygon(e,this._polygonCollider.points)},e=r([i],e)}(cc.Component);o.default=a,cc._RF.pop()},{}],"tracing-container":[function(t,e,o){"use strict";cc._RF.push(e,"7217aYg9WtMvb4KzgWTWC2O","tracing-container");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator.ccclass,a=cc._decorator.property,c=cc.Label.HorizontalAlign,s=cc.Label.VerticalAlign,l=t("./trace-graphics"),u=t("./tracing-part"),d=t("../../scripts/lib/error-handler"),p=t("../../scripts/lib/config"),h=t("../../scripts/helper"),f=t("../../scripts/util"),g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tracingImage="",e.imageNode=null,e._imageLoadedTexture=null,e._childImageLoadedTexture=null,e._lineWidth=0,e.tracingLetter="",e.textFont=null,e.traceGraphicsPrefab=null,e.width=0,e.height=0,e.traceGenerationMode=!1,e._traceGraphics=null,e._traceObject=null,e._traceGraphicsComponent=null,e._currentTracingPart=null,e._tracingPaths=null,e._childImage=null,e._image=null,e}return n(e,t),e.prototype.onLoad=function(){var t=this;this.node.width=this.width,this.node.height=this.height,cc.log("required font",p.default.getInstance().currentFontName),this.textFont=p.default.getInstance().getTextFont(p.default.getInstance().currentFontName),this.node.on(h.SHOW_CHILD_IMAGE,function(){t._childImage&&t._childImageLoadedTexture&&(t.clearStarNodes(),t._image.opacity=255,t._childImage.opacity=255)}),this.init()},e.prototype.clearStarNodes=function(){this.node.children.filter(function(t){return"starNode"===t.name}).forEach(function(t,e){t.opacity=0})},e.prototype.resetCurrentTracingPart=function(){this._currentTracingPart=null},e.prototype.createText=function(t,e,o,n){return void 0===o&&(o="512"),void 0===n&&(n="#FFFFFF"),f.Util.initText(t,this.textFont,e,o,n,!0,new cc.Vec2(this.node.width/2,this.node.height/1.875),c.CENTER,s.CENTER,new cc.Vec2(.5,.5),!0,2)},e.prototype.createTracingImage=function(t){var e=this;this._image=cc.instantiate(this.imageNode);var o=-1!==this.tracingImage.indexOf("/")?this.tracingImage.substr(this.tracingImage.lastIndexOf("/")+1).replace(".png",""):this.tracingImage,n=this.tracingImage;n&&!this._imageLoadedTexture?f.Util.loadTexture(n,function(t){t&&(e._imageLoadedTexture=t,e._image.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(e._imageLoadedTexture))}):this._image.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(this._imageLoadedTexture),this._image.setAnchorPoint(new cc.Vec2(.5,.5)),this._image.setPosition(new cc.Vec2(512,cc.winSize.height/2)),this._image.scale=1,this._image.name=o,this._image.children.forEach(function(t){return t.opacity=0}),this._childImage=this._image.getChildByName("childImageNode"),this._childImage.opacity=0;var r=n.replace("-tutorial","");return r&&!this._childImageLoadedTexture?f.Util.loadTexture(r,function(t){t&&(e._childImageLoadedTexture=t,e._childImage.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(e._childImageLoadedTexture))}):this._childImage.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(this._childImageLoadedTexture),t.addChild(this._image),this._image},e.prototype.init=function(){null===this._tracingPaths&&(this._tracingPaths=[]),null===this._currentTracingPart&&(this._currentTracingPart=new u.TracingPart);var t,e,o,n=[].concat.apply([],f.Util.pickRandomElements(["#f1C82a","#f25949","#00cfff","#e556f4"],1)).shift();(this.node.opacity=255,this.tracingLetter?(this._traceObject=this.createText(this.node,this.tracingLetter,"512",n),this._traceObject.scale=1.25):this.tracingImage&&(this._traceObject=this.createTracingImage(this.node),this._traceObject.setPosition(new cc.Vec2(this._traceObject.x,this._traceObject.y-100)),this._traceObject.scale=.75),this._traceGraphics=cc.instantiate(this.traceGraphicsPrefab),this._traceGraphicsComponent=this._traceGraphics.getComponent(l.default),this._traceGraphicsComponent.tracingContainerComponent=this,0!==this._lineWidth&&(this._traceGraphicsComponent.lineWidth=this._lineWidth),this._traceGraphicsComponent.traceObject=this._traceObject,this._traceGraphicsComponent.traceGenerationMode=this.traceGenerationMode,this.node.addChild(this._traceGraphics),cc.director.getCollisionManager().enabled=!0,this.initHandAndIndicator(),this.node.width=this._traceObject.width,this.traceGenerationMode)?((t=this.node.getChildByName("finish"))&&(t.zIndex=100,t.active=!0),(e=this.node.getChildByName("reset"))&&(e.zIndex=100,e.active=!0),(o=this.node.getChildByName("back"))&&(o.zIndex=100,o.active=!0)):((t=this.node.getChildByName("finish")).active=!1,(e=this.node.getChildByName("reset")).active=!1,"imagerecorder"===p.default.getInstance().game?((o=this.node.getChildByName("back")).zIndex=100,o.active=!0):(o=this.node.getChildByName("back")).active=!1);this.traceGenerationMode},e.prototype.initHandAndIndicator=function(){var t=this.node.getChildByName("hand");t&&(t.active=!1,t.scale=1,t.zIndex=999);var e=this.node.getChildByName("indicator");e&&(e.active=!0,e.scale=1,e.zIndex=999)},e.prototype.onFinishedButtonClick=function(t,e){console.log("onFinishedButtonClick");var o=this.tracingLetter?this.tracingLetter:this.tracingImage;this.writeToLocalStorage(o,JSON.stringify(this._tracingPaths)),this._traceGraphicsComponent.drawCircleInTracingMode(o),this.node.dispatchEvent(new cc.Event.EventCustom(h.RECORDING_FINISHED,!0))},e.prototype.onBackButtonClick=function(t,e){console.log("onBackButtonClick"),this.node.dispatchEvent(new cc.Event.EventCustom(h.BACK_FINISHED,!0))},e.prototype.recordTouchPoint=function(t,e){void 0===e&&(e=!1),null===this._tracingPaths&&(this._tracingPaths=[]),null===this._currentTracingPart&&(this._currentTracingPart=new u.TracingPart),this._currentTracingPart.addPoint(t),e&&(this._tracingPaths.push(this._currentTracingPart.getAllTracingPoints()),this._currentTracingPart=null)},e.prototype.removeFromLocalStorage=function(){var t=this.tracingLetter?this.tracingLetter:this.tracingImage;cc.sys.localStorage.removeItem(t),this._currentTracingPart=null,this._tracingPaths=null,this._traceGraphicsComponent.clear()},e.prototype.writeToLocalStorage=function(t,e){cc.sys.localStorage.setItem(t,e),this.showGeneratedPath(),console.log("key:",t,"json:",cc.sys.localStorage.getItem(t))},e.prototype.showGeneratedPath=function(){var t=this.tracingLetter?this.tracingLetter:this.tracingImage;this._traceGraphicsComponent.drawCircleInTracingMode(t)},e.prototype.onResetButtonClick=function(t,e){console.log("onResetButtonClick"),this.removeFromLocalStorage()},Object.defineProperty(e.prototype,"traceObject",{get:function(){return this._traceObject},set:function(t){this._traceObject=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"traceGraphics",{get:function(){return this._traceGraphics},set:function(t){this._traceGraphics=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lineWidth",{set:function(t){this._lineWidth=t},enumerable:!1,configurable:!0}),r([a()],e.prototype,"tracingImage",void 0),r([a(cc.Prefab)],e.prototype,"imageNode",void 0),r([a()],e.prototype,"tracingLetter",void 0),r([a(cc.Prefab)],e.prototype,"traceGraphicsPrefab",void 0),r([a()],e.prototype,"width",void 0),r([a()],e.prototype,"height",void 0),r([a()],e.prototype,"traceGenerationMode",void 0),r([d.default()],e.prototype,"onLoad",null),r([d.default()],e.prototype,"clearStarNodes",null),r([d.default()],e.prototype,"resetCurrentTracingPart",null),r([d.default()],e.prototype,"createText",null),r([d.default()],e.prototype,"createTracingImage",null),r([d.default()],e.prototype,"init",null),r([d.default()],e.prototype,"initHandAndIndicator",null),r([d.default()],e.prototype,"recordTouchPoint",null),r([d.default()],e.prototype,"removeFromLocalStorage",null),r([d.default()],e.prototype,"writeToLocalStorage",null),r([d.default()],e.prototype,"showGeneratedPath",null),e=r([i],e)}(cc.Component);o.default=g,cc._RF.pop()},{"../../scripts/helper":"helper","../../scripts/lib/config":"config","../../scripts/lib/error-handler":"error-handler","../../scripts/util":"util","./trace-graphics":"trace-graphics","./tracing-part":"tracing-part"}],"tracing-node":[function(t,e,o){"use strict";cc._RF.push(e,"d1829VJlWNJJIiI9R8IZTV8","tracing-node");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator.ccclass,a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._collisionCount=0,e.counter=0,e.currentPath=null,e}return n(e,t),e.prototype.onEnable=function(){cc.director.getCollisionManager().enabled=!0},e.prototype.onCollisionEnter=function(t,e){switch(t.node.group){case"drop":this.collisionEnter(t,e)}},e.prototype.collisionEnter=function(t,e){this._collisionCount++},e.prototype.onCollisionExit=function(t,e){switch(t.node.group){case"drop":this.collisionExit(t,e)}},e.prototype.collisionExit=function(t,e){this._collisionCount--},Object.defineProperty(e.prototype,"collisionCount",{get:function(){return this._collisionCount},set:function(t){this._collisionCount=t},enumerable:!1,configurable:!0}),e=r([i],e)}(cc.Component);o.default=a,cc._RF.pop()},{}],"tracing-part":[function(t,e,o){"use strict";cc._RF.push(e,"b58dbgr5eFKSIEI7NwShGz0","tracing-part"),Object.defineProperty(o,"__esModule",{value:!0}),o.TracingPart=void 0;var n=function(){function t(){this._points=[],this._points=[]}return Object.defineProperty(t.prototype,"points",{get:function(){return this._points},set:function(t){this._points=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"priority",{get:function(){return this._priority},set:function(t){this._priority=t},enumerable:!1,configurable:!0}),t.prototype.addPoint=function(t){this._points.push(t)},t.prototype.addPointAtIndex=function(t,e){this._points.splice(e,0,t)},t.prototype.getAllTracingPoints=function(){return this.points},t}();o.TracingPart=n,cc._RF.pop()},{}],"use_v2.1.x_cc.Action":[function(t,e,o){"use strict";cc._RF.push(e,"36bcb1fx5FL3IfL5KRXfdal","use_v2.1.x_cc.Action"),cc.macro.ROTATE_ACTION_CCW=!0,cc._RF.pop()},{}],"util-logger":[function(t,e,o){"use strict";cc._RF.push(e,"3a012LPdUZJZ79GViodugmx","util-logger"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("./lib/constants"),r="org/cocos2dx/javascript/logger/ChimpleLogger",i=function(){function t(){}return t.logEvent=function(t){try{cc.sys.isNative&&cc.sys.os==cc.sys.OS_ANDROID&&(t.userId=this.currentProfile()||"",t.deviceId=this.currentDeviceId()||"",t.timeStamp=(new Date).getTime(),cc.log("logging event",JSON.stringify(t)),"file"!=n.ASSET_LOAD_METHOD&&jsb.reflection.callStaticMethod(r,"logEvent","(Ljava/lang/String;)V",JSON.stringify(t))),this.logEventToFireBase(t)}catch(t){}},t.setUserIdEvent=function(t){try{cc.sys.isNative&&cc.sys.os==cc.sys.OS_ANDROID&&(cc.log("setUserId event",t),jsb.reflection.callStaticMethod(r,"setUserIdEvent","(Ljava/lang/String;)V",t))}catch(t){}},t.setUserPropertiesEvent=function(t,e){try{cc.sys.isNative&&cc.sys.os==cc.sys.OS_ANDROID&&(cc.log("setUserPropertiesEvent event",t,":",e),jsb.reflection.callStaticMethod(r,"setUserPropertiesEvent","(Ljava/lang/String;Ljava/lang/String;)V",t,e))}catch(t){}},t.logEventToFireBaseWithKey=function(t,e){cc.log("logging firebase event",t," with content",JSON.stringify(e)),"undefined"!=typeof sdkbox&&sdkbox.firebase.Analytics.logEvent(t,e)},t.logChimpleEvent=function(e,o){o.userId=o.userId?o.userId:this.currentProfile()||"",o.deviceId=this.currentDeviceId()||"",o.timeStamp=(new Date).getTime(),t.logEventToFireBaseWithKey(e,o)},t.logEventToFireBase=function(e){e.userId=e.userId?e.userId:this.currentProfile()||"",e.deviceId=this.currentDeviceId()||"",e.timeStamp=(new Date).getTime(),t.logEventToFireBaseWithKey("logInfo",e)},t.logProfile=function(t,e){try{cc.sys.isNative&&cc.sys.os==cc.sys.OS_ANDROID&&(cc.log("logging profile",t," ",e),jsb.reflection.callStaticMethod(r,"logProfile","(Ljava/lang/String;Ljava/lang/String;)V",t,e))}catch(t){}},t.currentProfile=function(){try{"file"!=n.ASSET_LOAD_METHOD&&null===this._currentUserId&&cc.sys.isNative&&cc.sys.os==cc.sys.OS_ANDROID&&(this._currentUserId=jsb.reflection.callStaticMethod(r,"currentStudentId","()Ljava/lang/String;"),cc.log("current profile:",this._currentUserId))}catch(t){}return this._currentUserId},t.getStorageDirectory=function(){try{cc.sys.isNative&&cc.sys.os==cc.sys.OS_ANDROID&&(this._storageDirectory=jsb.reflection.callStaticMethod(r,"getStorageDirectory","()Ljava/lang/String;"),cc.log("storage directory:",this._storageDirectory))}catch(t){}return this._storageDirectory},t.currentDeviceId=function(){try{null===this._currentDeviceId&&cc.sys.isNative&&cc.sys.os==cc.sys.OS_ANDROID&&(this._currentDeviceId=jsb.reflection.callStaticMethod(r,"getDeviceId","()Ljava/lang/String;"),cc.log("current device Id:",this._currentDeviceId))}catch(t){}return this._currentDeviceId},t.initPluginFirebase=function(){try{if("undefined"==typeof sdkbox)return void cc.log("sdkbox is undefined");if(void 0===sdkbox.firebase)return void cc.log("sdkbox.firebase is undefined");sdkbox.firebase.Analytics.init()}catch(t){}},t.downloadFile=function(t,e){try{cc.sys.isNative&&cc.sys.os==cc.sys.OS_ANDROID&&"file"===n.ASSET_LOAD_METHOD&&jsb.reflection.callStaticMethod(r,"downloadFile","(Ljava/lang/String;Ljava/lang/String;)V",t,e)}catch(t){}},t.isFileExists=function(t){try{return!(!cc.sys.isNative||cc.sys.os!=cc.sys.OS_ANDROID||"file"!==n.ASSET_LOAD_METHOD)&&jsb.reflection.callStaticMethod(r,"isFileExists","(Ljava/lang/String;)Z",t)}catch(t){}},t.checkIfUrlDownloaded=function(t,e){try{return cc.sys.isNative&&cc.sys.os==cc.sys.OS_ANDROID&&"file"===n.ASSET_LOAD_METHOD?jsb.reflection.callStaticMethod(r,"checkIfUrlDownloaded","(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;",t,e):null}catch(t){}},t.isNetworkAvailable=function(){try{return!(!cc.sys.isNative||cc.sys.os!=cc.sys.OS_ANDROID||"file"!==n.ASSET_LOAD_METHOD)&&jsb.reflection.callStaticMethod(r,"isNetworkAvailable","()Z")}catch(t){}},t._storageDirectory=null,t._currentUserId=null,t._currentDeviceId=null,t}();o.default=i,cc._RF.pop()},{"./lib/constants":"constants"}],util:[function(t,e,o){"use strict";cc._RF.push(e,"b6786RxBpJI57Hig0e66N7e","util");var n=this&&this.__awaiter||function(t,e,o,n){function r(t){return t instanceof o?t:new o(function(e){e(t)})}return new(o||(o=Promise))(function(o,i){function a(t){try{s(n.next(t))}catch(t){i(t)}}function c(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){t.done?o(t.value):r(t.value).then(a,c)}s((n=n.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(t){return function(e){return s([t,e])}}function s(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.Util=o.TouchEvents=o.SUBPACKAGES=void 0;var i=t("./chimple-label"),a=t("./help"),c=t("./helper"),s=t("./lib/config"),l=t("./lib/constants"),u=t("./lib/profile"),d=t("./util-logger"),p=cc.Label.Overflow,h=cc.Label.HorizontalAlign,f=cc.Label.VerticalAlign,g=t("./lessonController");o.SUBPACKAGES="subpackages";var _={"+":"plus","-":"minus","&":"and","=":"equals",x:"times"};(function(t){t.TOUCH_START="touchstart",t.TOUCH_END="touchend",t.TOUCH_MOVE="touchmove",t.TOUCH_CANCEL="touchCancel"})(o.TouchEvents||(o.TouchEvents={}));var y=function(){function t(){}return t.shuffle=function(t){for(var e,o,n=t.length;n>0;)o=Math.floor(Math.random()*n),e=t[--n],t[n]=t[o],t[o]=e;return t},t.shuffleByMapSortMap=function(t){return t.map(function(t){return{sort:Math.random(),value:t}}).sort(function(t,e){return t.sort-e.sort}).map(function(t){return t.value})},t.randomBetween=function(t,e){return Math.floor(Math.random()*(e-t)+t)},t.pickRandomElements=function(e,o){for(var n=[],r=0;r<o;r++){var i=t.shuffle(e),a=Math.floor(Math.random()*i.length);n.push(i.splice(a,1))}return n},t.initText=function(t,e,o,n,r,a,s,l,u,d,g,_){void 0===o&&(o=""),void 0===n&&(n="10"),void 0===r&&(r=null),void 0===a&&(a=!0),void 0===s&&(s=new cc.Vec2(0,0)),void 0===l&&(l=h.CENTER),void 0===u&&(u=f.CENTER),void 0===d&&(d=new cc.Vec2(.5,.5)),void 0===g&&(g=!1),void 0===_&&(_=0);var y=new cc.Node(o),m=y.addComponent(i.default);m.string=a?o:"",m.overflow=p.NONE;var b=c.DEFAULT_FONT_COLOR;r&&(b=b.fromHEX(r)),y.color=b;var v=parseInt(n);(m.fontSize=v,m.horizontalAlign=l,m.verticalAlign=u,m.lineHeight=v+100,y.setAnchorPoint(d),y.position=new cc.Vec2(s.x,s.y),g)&&(y.addComponent(cc.LabelOutline).width=_);return t.addChild(y),y},t.isBetweenRange=function(t,e,o){return t>=e&&t<=o},t.chunk=function(t,e){for(var o=[],n=0;n<t.length;n+=e)o.push(t.slice(n,n+e));return o},t.chunkByIncreaseSize=function(t,e,o){for(var n=[],r=e,i=1,a=0;a<t.length;a=r+i*o)n.push(t.slice(a,a+r+i*o)),i++;return n},t.speakEquation=function(t,e){var o=t.map(function(t){var e=t in _?_[t]:"d_"+t;return e=e.endsWith(".mp3")?e:e+".mp3",s.default.dir+"course/res/sound/numbervoice/"+e});this.speakOneByOne(o,0,e)},t.speakOneByOne=function(t,e,o){var n=this;this.speak(t[e],function(){o(e),++e<t.length&&n.speakOneByOne(t,e,o)})},t.speak=function(e,o){var n=this;t.load(e,function(t,e){n.speakClip(e,o)},!0)},t.speakClip=function(e,o){if(null!=e)if(Array.isArray(e)&&0===e.length)o();else{var n=t.play(e,!1);-1!=n?cc.audioEngine.setFinishCallback(n,o):o()}else o()},t.speakMusic=function(e,o){t.load(e,function(t,e){if(null!=e)if(Array.isArray(e)&&0===e.length)o();else{var n=cc.audioEngine.playMusic(e,!1);cc.audioEngine.setFinishCallback(n,o)}else o()},!0)},t.loadNumericSound=function(e,o){var n="d_"+e.toLowerCase();n=n.endsWith(".mp3")?n:n+".mp3";var r=s.default.dir+c.NUMBER_VOICE+n;t.load(r,function(t,e){o(t||null===e?null:e)},!0)},t.loadsPhonicsOrLetter=function(e,o){e=(e=e.replace(".m4a","")).endsWith(".mp3")?e:e+".mp3";var n=s.default.dir+c.PHONIC_VOICE+e;t.load(n,function(n,r){if(n||null==r){if(null!=n){var i=s.default.dir+c.LETTER_VOICE+e;t.load(i,function(t,e){t||null==e?null!=t&&o(null):o(e)},!0)}}else o(r)},!0)},t.loadsLetter=function(e,o){e=(e=e.replace(".m4a","")).endsWith(".mp3")?e:e+".mp3";var n=s.default.dir+c.LETTER_VOICE+e;t.load(n,function(t,e){t||null==e?null!=t&&o(null):o(e)},!0)},t.loadGameSound=function(e,o){var n=(e.startsWith(s.default.dir)?e:s.default.dir+(s.default.i.lessonId+"/res/")+e)+(e.endsWith(".mp3")||e.endsWith(".m4a")?"":".mp3");t.load(n,function(t,e){t&&cc.log(t),o(t||null===e?null:e)},!0)},t.loadTexture=function(e,o,n){void 0===n&&(n=!0);var r=(e=e.endsWith(".png")||e.endsWith(".jpg")?e:e+".png").startsWith(s.default.dir)?e:s.default.dir+(s.default.i.lessonId+"/res/")+e;t.load(r,function(t,e){e&&!t?o(e,t):t&&o(null)},n)},t.flattenDeep=function(t){var e=this;return t.reduce(function(t,o){return Array.isArray(o)?t.concat(e.flattenDeep(o)):t.concat(o)},[])},t.randomElements=function(t,e){return t.sort(function(){return.5-Math.random()}).slice(0,e)},t.takePictureFromCamera=function(e){var o=this;jsb.reflection.callStaticMethod("org/cocos2dx/javascript/AppActivity","openCamera","()V");var i=10,a=null;return n(o,void 0,void 0,function(){return r(this,function(o){switch(o.label){case 0:return i>0&&null==a?[4,t.checkCameraResult()]:[3,2];case 1:return a=o.sent(),i--,[3,0];case 2:return e(a),[2]}})})},t.checkCameraResult=function(){return new Promise(function(t){setTimeout(function(){var e=jsb.reflection.callStaticMethod("org/cocos2dx/javascript/AppActivity","checkCameraResult","()Ljava/lang/String;");t(e),console.log("Returned promise")},6e3)})},t.getRandomPosition=function(e,o){var n,r;return r=e[n=t.randomBetween(0,e.length-1)],o&&e.splice(n,1),r},t.generatePositionsArray=function(e,o,n,r){var i,a,c,s,l=[];for(c=Math.floor(o/n),s=Math.floor(e/n),i=1;i<=c;i+=1)for(a=1;a<=s;a+=1)l.push({x:Math.round(e*a/s)+t.randomBetween(-1*r,r)-e/2-50,y:Math.round(o*i/c)+t.randomBetween(-1*r,r)-o/2});return l},t.speakLetter=function(e,o){var n=s.default.dir+c.LETTER_VOICE+e;t.load(n,function(e,n){if(e||null==n)null!=e&&o();else{var r=t.play(n,!1);-1!==r?cc.audioEngine.setFinishCallback(r,o):o(),cc.audioEngine.setFinishCallback(r,o)}},!0)},t.speakPhonicsOrLetter=function(e,o){var n=this;e=(e=e.replace(".m4a","")).endsWith(".mp3")?e:e+".mp3";var r=s.default.dir+c.PHONIC_VOICE+e;t.load(r,function(r,i){if(r||null==i)null!=r&&n.speakLetter(e,o);else{var a=t.play(i,!1);-1!==a?cc.audioEngine.setFinishCallback(a,o):n.speakLetter(e,o),cc.audioEngine.setFinishCallback(a,o)}},!0)},t.speakLettersOrWords=function(e,o){e=(e=e.replace(".m4a","")).endsWith(".mp3")?e:e+".mp3";var n=s.default.dir+c.LETTER_VOICE+e;t.loadGameSound(n,function(n){var r=-1;if(null!=n&&(r=cc.audioEngine.play(n,!1,1)),r>=0)cc.audioEngine.setFinishCallback(r,o);else{var i=s.default.dir+s.default.i.courseId+"/res/"+e;t.loadGameSound(i,function(t){null!=t&&(r=cc.audioEngine.play(t,!1,1)),r>=0?cc.audioEngine.setFinishCallback(r,o):null!=o&&o()})}})},t.freeResources=function(){for(var t=this._resources.length-1;t>=0;t--){try{cc.log("free resource ----\x3e:",this._resources[t]),cc.resources.release(this._resources[t])}catch(t){}this._resources.splice(t,1)}cc.log("resources left: ---\x3e",this._resources.length)},t.load=function(t,e,o){void 0===o&&(o=!0);var n=t.split("/"),r=n[0],i=n[1],a=n.slice(2).join("/"),c=a.split(".")[0],s=this.bundles.get("course"==i?r:i),l=a.split(".")[1];"mp3"===l||"m4a"===l?s.load(c,cc.AudioClip,function(t,o){t&&cc.log(JSON.stringify(t)),e(t,o)}):"png"===l||"jpg"===l?s.load(c,cc.Texture2D,function(t,o){t&&cc.log(JSON.stringify(t)),e(t,o)}):s.load(c,function(t,o){t&&cc.log(JSON.stringify(t)),e(t,o)})},t.loadi18NMapping=function(e){var o=s.default.dir+"course/res/i18N.json";t.load(o,function(o,n){if(!o&&n){var r=n instanceof cc.JsonAsset?n.json:n;r&&Object.keys(r).forEach(function(e){var o=r[e];t._i18NMap.set(e,o)}),e()}else e()})},t.i18NText=function(e){return t._i18NMap.has(e)?this._i18NMap.get(e):e},t.i18NNumberConvert=function(e,o){if(void 0===o&&(o=!0),o?/^\d/.test(e):/\d/.test(e)){var n=e.split("");return n=n.map(function(e){return t.i18NText(e)}),console.log("converted ",t.i18NText(n.join(""))),t.i18NText(n.join(""))}return e},t.showHelp=function(e,o,n,r){void 0===n&&(n=null),void 0===r&&(r=!0);var i=s.default.getInstance();if(1==i.problem){var c,l=cc.Canvas.instance.node,u=l.getComponent(g.default);if(null!=e&&null!=o&&cc.resources.load("prefabs/help",function(t,r){if(!t){var i=cc.instantiate(r),c=i.getComponent(a.default);null!=c&&c.initNodes(e,o,n),l.addChild(i)}}),r)null!=u&&(c=u.chimp).playAnimation("talking",0),t.playHelpAudio(i.courseId+"/course/res/sound/game/"+i.game+".mp3",function(){c&&c.playAnimation("idle",1),null!=n&&n()});else null!=n&&n()}else null!=n&&n()},t.playHelpAudio=function(e,o){var n=this;t.load(e,function(e,r){null!=r?Array.isArray(r)&&0===r.length?o():(n.helpAudioId=t.play(r,!1),-1!=n.helpAudioId?cc.audioEngine.setFinishCallback(n.helpAudioId,o):o()):o()},!0)},t.computeTimeDiff=function(t,e,o){void 0===e&&(e=new Date),void 0===o&&(o=new Date);var n=o.getTime()-e.getTime();cc.log(t+" -> computeTimeDiff in milliseconds "+n)},t.shuffleGenerator=function(t){var e;return r(this,function(o){switch(o.label){case 0:e=t.length,o.label=1;case 1:return e--?[4,t.splice(Math.floor(Math.random()*(e+1)),1)[0]]:[3,3];case 2:return o.sent(),[3,1];case 3:return[2]}})},t.loadFriend=function(t){cc.resources.load("prefabs/friend/"+s.default.getInstance().friend,function(e,o){null!=e&&cc.log(e);var n=null!=o?cc.instantiate(o):null;null!=t&&t(n)})},t.playSfx=function(t,e,o){if(void 0===e&&(e=!1),void 0===o&&(o=!1),0==u.default.getItem(u.SFX_OFF))try{return e?cc.audioEngine.playMusic(t,o):cc.audioEngine.playEffect(t,o)}catch(t){}return-1},t.stopHelpAudio=function(){try{cc.audioEngine.stopEffect(this.helpAudioId)}catch(t){cc.log(t)}return this.helpAudioId},t.play=function(t,e){void 0===e&&(e=!1);var o=-1;try{t&&(o=cc.audioEngine.playEffect(t,e))}catch(t){cc.log(t)}return o},t.getSubpackages=function(){var t=JSON.parse(cc.sys.localStorage.getItem(o.SUBPACKAGES));return t||[]},t.addSubpackage=function(t){var e=this.getSubpackages();e.push(t),cc.sys.localStorage.setItem(o.SUBPACKAGES,JSON.stringify(e))},t.downloadIfNeeded=function(e,o,n,r){var i=o,a=i+"/"+n,c=a+"/res/"+n+".json";if(cc.sys.isNative&&cc.sys.os==cc.sys.OS_ANDROID&&"file"===l.ASSET_LOAD_METHOD&&!jsb.fileUtils.isFileExist(c)){d.default.downloadFile(""+l.COURSES_URL+a+".zip",i);var s=function(){cc.log("calling checkIfUrlDownloaded "+l.COURSES_URL+a+".zip");var o=d.default.checkIfUrlDownloaded(""+l.COURSES_URL+a+".zip",i);"DOWNLOAD_FAILED"!=o&&"DOWNLOAD_SUCCESS"!=o||(cc.director.getScheduler().unschedule(s,e),"DOWNLOAD_SUCCESS"==o?(t.addSubpackage(a),r(!0)):r(!1))};cc.director.getScheduler().schedule(s,e,1)}else r(!0)},t._i18NMap=new Map,t._resources=[],t.bundles=new Map,t.helpAudioId=-1,t}();o.Util=y,cc._RF.pop()},{"./chimple-label":"chimple-label","./help":"help","./helper":"helper","./lessonController":"lessonController","./lib/config":"config","./lib/constants":"constants","./lib/profile":"profile","./util-logger":"util-logger"}],writeword:[function(t,e,o){"use strict";cc._RF.push(e,"261599g5p5Ofoog5IhbdvFl","writeword");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.TRACE_HEIGHT=o.TRACE_WIDTH=void 0;var i=cc._decorator.ccclass,a=cc._decorator.property,c=t("../../../common/scripts/lib/config"),s=t("./singlelettertracing"),l=t("../../../common/scripts/util"),u=t("../../../common/scripts/lib/error-handler"),d=t("../../../common/scripts/helper");o.TRACE_WIDTH=512,o.TRACE_HEIGHT=768;var p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.words=null,e.singleLetterPrefab=null,e.imageNode=null,e._currentConfig=null,e._wordTracingContainer=null,e._imageName=null,e._sound=null,e._currentLetterIndex=0,e._texture=null,e}return n(e,t),e.prototype.onLoad=function(){var t=this;cc.director.getCollisionManager().enabled=!0,this.subScribeToTracingEvents(),this.node.on(d.MOVE_TO_NEXT_LETTER_EVENT,function(e){e.stopPropagation();var o=e.getUserData();t.moveToNextLetter(o)}),this._currentConfig=this.processConfiguration(c.default.getInstance().data[0]),this._image=cc.instantiate(this.imageNode),null!==this._currentConfig&&(this._wordTracingContainer=this.node,this._wordTracingContainer.scale*=1,this.node.width=cc.winSize.width,this.node.height=cc.winSize.height,this.buildLetters(),this.node.emit(d.CONFIG_LOADED),this.loadSounds(this._currentConfig.sound),this.node.on(d.SOUND_LOADED_EVENT,function(){t.pronounce()}),this.emitLetterEnabledEvent(this._wordLayout.node.getChildByName(this._originalLetterName+"0"),0),l.Util.loadTexture(this._currentConfig.image,function(e,o){e&&!o&&(t._texture=e)}))},e.prototype.moveToNextLetter=function(t){var e=t.elementIndex;if(e<=this._characters.length-1){var o=this._wordLayout.node.getChildByName(this._originalLetterName+e);c.default.i.direction==c.Direction.RTL?(this.minScrollToRight(e,o),this.scrollToRight(e,o)):(this.minScrollToLeft(e,o),this.scrollToLeft(e,o))}else this.loadImage(this._currentConfig.image)},e.prototype.minScrollToLeft=function(t,e){var o=this,n=cc.winSize.width/6,r=new cc.Vec2(this._wordLayout.node.position.x-n,this._wordLayout.node.position.y);(new cc.Tween).target(this._wordLayout.node).to(.5,{position:r},{progress:null,easing:"sineOut"}).call(function(){o.emitLetterEnabledEvent(o._wordLayout.node.getChildByName(o._originalLetterName+t),t)}).start()},e.prototype.scrollToLeft=function(t,e){var o=this;if(e.position.x-Math.abs(this._wordLayout.node.position.x/2)+1*e.width>cc.winSize.width){var n=e.width,r=new cc.Vec2(this._wordLayout.node.position.x-n,this._wordLayout.node.position.y);(new cc.Tween).target(this._wordLayout.node).to(.5,{position:r},{progress:null,easing:"sineOut"}).call(function(){o.emitLetterEnabledEvent(o._wordLayout.node.getChildByName(o._originalLetterName+t),t)}).start()}else this.minScrollToLeft(t,e)},e.prototype.minScrollToRight=function(t,e){var o=this,n=cc.winSize.width/6,r=new cc.Vec2(this._wordLayout.node.position.x+1*n,this._wordLayout.node.position.y);(new cc.Tween).target(this._wordLayout.node).to(.5,{position:r},{progress:null,easing:"sineOut"}).call(function(){o.emitLetterEnabledEvent(o._wordLayout.node.getChildByName(o._originalLetterName+t),t)}).start()},e.prototype.scrollToRight=function(t,e){var o=this;if(e.position.x-Math.abs(this._wordLayout.node.position.x/2)+1*e.width>cc.winSize.width){var n=e.width,r=new cc.Vec2(this._wordLayout.node.position.x+1.2*n,this._wordLayout.node.position.y);(new cc.Tween).target(this._wordLayout.node).to(.5,{position:r},{progress:null,easing:"sineOut"}).call(function(){o.emitLetterEnabledEvent(o._wordLayout.node.getChildByName(o._originalLetterName+t),t)}).start()}else this.minScrollToRight(t,e)},e.prototype.tracingFinished=function(){this._wordLayout.node.getChildByName(this._originalLetterName+this._currentLetterIndex).getComponent(s.SingleLetterTracing).pronounce(),this.pronounce();var t=new cc.Event.EventCustom(d.MOVE_TO_NEXT_LETTER_EVENT,!0);this._currentLetterIndex++,t.setUserData({elementIndex:this._currentLetterIndex}),this.node.dispatchEvent(t)},e.prototype.buildLetters=function(){var t=this;this._wordLayout=this.words.getComponent(cc.Layout),this._wordLayout.spacingX=50,c.default.i.direction==c.Direction.RTL?(this.words.scaleX=-s.LETTER_SCALE,this._wordTracingContainer.x=cc.winSize.width):this.words.scale=s.LETTER_SCALE,this._characters.forEach(function(e,n){var r=cc.instantiate(t.singleLetterPrefab);c.default.i.direction==c.Direction.RTL&&(r.scaleX=-s.LETTER_SCALE),r.width=o.TRACE_WIDTH,r.height=o.TRACE_HEIGHT,t._originalLetterName=r.name,r.name=t._originalLetterName+n,t._singleLetterComponent=r.getComponent(s.SingleLetterTracing),t._singleLetterComponent.order=n,t._singleLetterComponent.letter=e,t._singleLetterComponent.wordTracingContainer=t.node,t._wordLayout.node.addChild(r),0===n&&(t._currentLetterIndex=n)})},e.prototype.subScribeToTracingEvents=function(){var t=this;this.node.on(d.TRACING_FINISHED,function(e){t.tracingFinished()}),this.node.on(d.TRACING_CORRECT,function(e){e.stopPropagation(),t._wordTracingContainer.emit("correct")}),this.node.on(d.TRACING_WRONG,function(e){e.stopPropagation(),t._wordTracingContainer.emit("wrong")})},e.prototype.emitLetterEnabledEvent=function(t,e){t.emit("letterEnabledEvent",e)},e.prototype.processConfiguration=function(t){void 0===t&&(t=[]);var e=[].concat.apply([],t),o=e[0],n=e[1],r=e[2],i=e[3],a=e[4],c=e[5];return this._characters=Array.from(i),{level:o,workSheet:n,problemNo:r,word:i,image:a=a||i,sound:c=c||i}},e.prototype.loadImage=function(t){this._imageName=t,this._texture?(this._image.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(this._texture),this.node.addChild(this._image),this._image.opacity=0,this._image.scale=0,this.hideLayoutAndShowImage()):this.node.emit("nextProblem")},e.prototype.hideLayoutAndShowImage=function(){var t=this;(new cc.Tween).target(this._wordLayout.node).to(1,{opacity:0},{progress:null,easing:"sineOut"}).call(function(){t._image?(new cc.Tween).target(t._image).to(1,{scale:1,opacity:255},{progress:null,easing:"sineOut"}).call(function(){t.scheduleOnce(function(){t.node.emit("nextProblem")},.01)}).start():t.node.emit("nextProblem")}).start()},Object.defineProperty(e.prototype,"currentConfig",{get:function(){return this._currentConfig},enumerable:!1,configurable:!0}),e.prototype.loadSounds=function(t){var e=this;null===this._sound&&l.Util.loadGameSound(t,function(t){e._sound=t,e.node.emit(d.SOUND_LOADED_EVENT)})},e.prototype.pronounce=function(){var t=this;this._currentLetterIndex===this._characters.length-1&&this.scheduleOnce(function(){t._sound&&(t._soundID=l.Util.play(t._sound,!1))},1)},e.prototype.onDestroy=function(){cc.audioEngine.stopAllEffects()},r([a(cc.Node)],e.prototype,"words",void 0),r([a(cc.Prefab)],e.prototype,"singleLetterPrefab",void 0),r([a(cc.Prefab)],e.prototype,"imageNode",void 0),r([u.default()],e.prototype,"onLoad",null),r([u.default()],e.prototype,"moveToNextLetter",null),r([u.default()],e.prototype,"minScrollToLeft",null),r([u.default()],e.prototype,"scrollToLeft",null),r([u.default()],e.prototype,"minScrollToRight",null),r([u.default()],e.prototype,"scrollToRight",null),r([u.default()],e.prototype,"tracingFinished",null),r([u.default()],e.prototype,"buildLetters",null),r([u.default()],e.prototype,"subScribeToTracingEvents",null),r([u.default()],e.prototype,"emitLetterEnabledEvent",null),e=r([i],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../../../common/scripts/helper":"helper","../../../common/scripts/lib/config":"config","../../../common/scripts/lib/error-handler":"error-handler","../../../common/scripts/util":"util","./singlelettertracing":"singlelettertracing"}]},{},["chimple","arrow-node","indicator-node","singlelettertracing","trace-gen-container","trace-graphics","tracing-collider","tracing-container","tracing-node","tracing-part","writeword","answer-grid","auto-drag","balloon","chimple-label","chimple-richtext","counting-answer","countingLayout","drag","drop","help","helper","lessonController","config","constants","convert","error-handler","gameConfigs","globals","profile","loading","nest","number-script","progressMonitor","quiz-monitor","util-logger","util","use_v2.1.x_cc.Action","queue"]);