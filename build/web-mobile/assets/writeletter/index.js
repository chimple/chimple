window.__require=function t(e,n,o){function i(c,a){if(!n[c]){if(!e[c]){var s=c.split("/");if(s=s[s.length-1],!e[s]){var p="function"==typeof __require&&__require;if(!a&&p)return p(s,!0);if(r)return r(s,!0);throw new Error("Cannot find module '"+c+"'")}c=s}var l=n[c]={exports:{}};e[c][0].call(l.exports,function(t){return i(e[c][1][t]||t)},l,l.exports,t,e,n,o)}return n[c].exports}for(var r="function"==typeof __require&&__require,c=0;c<o.length;c++)i(o[c]);return i}({writeletter:[function(t,e,n){"use strict";cc._RF.push(e,"f00d6U85lNJf7T+QE5U3/2Z","writeletter");var o=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,c=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,n,o);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,n,c):i(e,n))||c);return r>3&&c&&Object.defineProperty(e,n,c),c};Object.defineProperty(n,"__esModule",{value:!0}),n.WriteLetter=n.LETTER_TRACING_SCALE=void 0;var r=cc._decorator.ccclass,c=cc._decorator.property,a=t("../../../common/scripts/lib/config"),s=t("../../../common/scripts/util"),p=t("../../../common/scripts/lib/error-handler"),l=t("../../../common/scripts/helper"),u=t("../../../common/Tracing/scripts/tracing-container");n.LETTER_TRACING_SCALE=.85;var d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.imageNode=null,e._tracingContainerComponent=null,e._letter=null,e._currentConfig=null,e._letterTracingContainer=null,e._sound=null,e._imageName=null,e}return o(e,t),e.prototype.onLoad=function(){cc.director.getCollisionManager().enabled=!1,this._currentConfig=this.processConfiguration(a.default.getInstance().data[0]),null!==this._currentConfig&&(this._image=cc.instantiate(this.imageNode),this._letterTracingContainer=this.node,this._letterTracingContainer.scale*=1,this.node.width=cc.winSize.width,this.node.height=cc.winSize.height,this._tracingContainer=cc.instantiate(this.tracingContainerPrefab),this.setAlphabetToDisplay(this._currentConfig.traceText),this.subScribeToTracingEvents(),this.loadSounds(this._currentConfig.traceText),this.node.opacity=255)},e.prototype.subScribeToTracingEvents=function(){var t=this;this.node.on(l.TRACING_FINISHED,function(e){e.stopPropagation(),t.tracingFinished()}),this.node.on(l.TRACING_CORRECT,function(e){e.stopPropagation(),t.node.emit("correct")}),this.node.on(l.TRACING_WRONG,function(e){e.stopPropagation(),t.node.emit("wrong")})},e.prototype.loadSounds=function(t){var e=this;s.Util.loadsLetter(t.toLowerCase(),function(t){e._sound=t,e.node.emit(l.SOUND_LOADED_EVENT)})},e.prototype.tracingFinished=function(){var t=this;this.pronounce(),this.scheduleOnce(function(){t.node.emit("nextProblem")},1)},e.prototype.pronounce=function(){try{this._sound&&(this._soundID=s.Util.play(this._sound,!1))}catch(t){}},e.prototype.setAlphabetToDisplay=function(t){this._tracingContainerComponent=this._tracingContainer.getComponent(u.default),this._tracingContainerComponent.tracingLetter=t,this._tracingContainerComponent.traceGenerationMode=!1,this.node.addChild(this._tracingContainer),this._tracingContainerComponent.traceGraphics.emit("enabledGraphics"),"en/"===a.default.dir?this._tracingContainer.setPosition(new cc.Vec2(-256,-350)):"hi/"===a.default.dir&&this._tracingContainer.setPosition(new cc.Vec2(-256,-450)),this.node.scale=n.LETTER_TRACING_SCALE},e.prototype.processConfiguration=function(t){void 0===t&&(t=[]);var e=[].concat.apply([],t);return{level:e[0],workSheet:e[1],problemNo:e[2],traceText:e[3]}},e.prototype.onDestroy=function(){cc.audioEngine.stopAllEffects()},i([c(cc.Prefab)],e.prototype,"tracingContainerPrefab",void 0),i([c(cc.Prefab)],e.prototype,"imageNode",void 0),i([p.default()],e.prototype,"onLoad",null),i([p.default()],e.prototype,"subScribeToTracingEvents",null),i([p.default()],e.prototype,"tracingFinished",null),i([p.default()],e.prototype,"pronounce",null),i([p.default()],e.prototype,"setAlphabetToDisplay",null),e=i([r],e)}(cc.Component);n.WriteLetter=d,cc._RF.pop()},{"../../../common/Tracing/scripts/tracing-container":void 0,"../../../common/scripts/helper":void 0,"../../../common/scripts/lib/config":void 0,"../../../common/scripts/lib/error-handler":void 0,"../../../common/scripts/util":void 0}]},{},["writeletter"]);