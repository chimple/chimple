window.__require=function t(e,n,i){function o(c,a){if(!n[c]){if(!e[c]){var s=c.split("/");if(s=s[s.length-1],!e[s]){var u="function"==typeof __require&&__require;if(!a&&u)return u(s,!0);if(r)return r(s,!0);throw new Error("Cannot find module '"+c+"'")}c=s}var l=n[c]={exports:{}};e[c][0].call(l.exports,function(t){return o(e[c][1][t]||t)},l,l.exports,t,e,n,i)}return n[c].exports}for(var r="function"==typeof __require&&__require,c=0;c<i.length;c++)o(i[c]);return o}({singlenumbertracing:[function(t,e,n){"use strict";cc._RF.push(e,"5da4eDY4s1EHawDKyXsr9Mj","singlenumbertracing");var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),o=this&&this.__decorate||function(t,e,n,i){var o,r=arguments.length,c=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(c=(r<3?o(c):r>3?o(e,n,c):o(e,n))||c);return r>3&&c&&Object.defineProperty(e,n,c),c};Object.defineProperty(n,"__esModule",{value:!0}),n.SingleNumberTracing=n.TRACE_NODE_POS_Y=n.TRACE_NODE_POS_X=n.LETTER_SCALE=void 0;var r=cc._decorator.ccclass,c=cc._decorator.property,a=t("../../../common/scripts/util"),s=t("../../../common/scripts/lib/config"),u=t("../../../common/scripts/lib/error-handler"),l=t("../../../common/scripts/helper"),p=t("../../../common/Tracing/scripts/tracing-container");n.LETTER_SCALE=.95,n.TRACE_NODE_POS_X=-256,n.TRACE_NODE_POS_Y=-384;var d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._tracingContainerComponent=null,e._traceGraphics=null,e._letter=null,e._wordTracingContainer=null,e._tracingScale=null,e._sound=null,e}return i(e,t),e.prototype.onLoad=function(){var t=this;cc.director.getCollisionManager().enabled=!1,this._tracingContainer=cc.instantiate(this.tracingContainerPrefab),this._tracingContainer.scale=.75,this._wordTracingContainer.on(l.CONFIG_LOADED,function(){t.setAlphabetToDisplay(t._letter),t.loadSounds(t._letter)})},e.prototype.loadSounds=function(t){var e=this;isNaN(Number(t))?(this.preloadSound(t.toLowerCase(),s.default.dir+l.PHONIC_VOICE),null===this._sound&&this.preloadSound(t.toLowerCase(),s.default.dir+l.LETTER_VOICE),null===this._sound&&this.preloadSound(t.toLowerCase(),s.default.dir+WORD_TRACING_SOUNDS)):a.Util.loadNumericSound(t,function(t){e._sound=t})},e.prototype.preloadSound=function(t,e){var n=this,i=e+t;cc.resources.load(i,cc.AudioClip,function(t,e){t||null===e||(n._sound=e)})},e.prototype.pronounce=function(){this._sound&&(this._soundID=a.Util.play(this._sound,!1))},e.prototype.setAlphabetToDisplay=function(t){var e=this;this._tracingContainerComponent=this._tracingContainer.getComponent(p.default),this._tracingContainerComponent.tracingLetter=t,this._tracingContainerComponent.traceGenerationMode=!1,this.node.addChild(this._tracingContainer),null!==this._tracingScale?this._tracingContainerComponent._traceGraphicsComponent.adjustedScale=this._tracingScale:this._tracingContainerComponent._traceGraphicsComponent.adjustedScale=n.LETTER_SCALE,this._traceGraphics=this._tracingContainerComponent.traceGraphics,this._tracingContainer.setPosition(new cc.Vec2(n.TRACE_NODE_POS_X,n.TRACE_NODE_POS_Y)),this.node.on("letterEnabledEvent",function(t,n){void 0===n&&(n=0),e._order===t&&e.scheduleOnce(function(){e._traceGraphics.emit("enabledGraphics")},n)}),this.node.width=this._tracingContainer.width},e.prototype.onDestroy=function(){cc.audioEngine.stopAllEffects()},Object.defineProperty(e.prototype,"letter",{set:function(t){this._letter=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"wordTracingContainer",{set:function(t){this._wordTracingContainer=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"order",{get:function(){return this._order},set:function(t){this._order=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tracingScale",{get:function(){return this._tracingScale},set:function(t){this._tracingScale=t},enumerable:!1,configurable:!0}),o([c(cc.Prefab)],e.prototype,"tracingContainerPrefab",void 0),o([u.default()],e.prototype,"onLoad",null),o([u.default()],e.prototype,"setAlphabetToDisplay",null),e=o([r],e)}(cc.Component);n.SingleNumberTracing=d,cc._RF.pop()},{"../../../common/Tracing/scripts/tracing-container":void 0,"../../../common/scripts/helper":void 0,"../../../common/scripts/lib/config":void 0,"../../../common/scripts/lib/error-handler":void 0,"../../../common/scripts/util":void 0}],writeset:[function(t,e,n){"use strict";cc._RF.push(e,"9b9b8DQ5iFEVLfnKGfxdWGv","writeset");var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),o=this&&this.__decorate||function(t,e,n,i){var o,r=arguments.length,c=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(c=(r<3?o(c):r>3?o(e,n,c):o(e,n))||c);return r>3&&c&&Object.defineProperty(e,n,c),c};Object.defineProperty(n,"__esModule",{value:!0}),n.WriteSet=n.TRACE_HEIGHT=void 0;var r=cc._decorator.ccclass,c=cc._decorator.property,a=cc.Layout,s=t("../../../common/scripts/lib/config"),u=t("../../../common/scripts/util"),l=t("./singlenumbertracing"),p=t("../../../common/scripts/helper");n.TRACE_HEIGHT=768;var d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.wordsPrefab=null,e.animsPrefab=null,e.singleLetterPrefab=null,e.b1=null,e.b2=null,e._currentConfig=null,e._numericTracingContainer=null,e._words=null,e._anims=null,e._currentLetterIndex=0,e._touchAllowedOnAnimLayout=!1,e}return i(e,t),e.prototype.onLoad=function(){var t=this;if(cc.director.getCollisionManager().enabled=!0,this._currentConfig=this.processConfiguration(s.default.getInstance().data[0]),null!==this._currentConfig){this._words=cc.instantiate(this.wordsPrefab),this.node.addChild(this._words),this._anims=cc.instantiate(this.animsPrefab),this.node.addChild(this._anims),this._numericTracingContainer=this.node,this._numericTracingContainer.scale*=1,this._speakCount=0,this.buildNumbersWithGrid(),this.subScribeToTracingEvents(),this.node.emit(p.CONFIG_LOADED);var e=Number(this._currentConfig.count)<=100?[this._currentConfig.count]:[String(Number(this._currentConfig.count)-Number(this._currentConfig.count)%10),String(Number(this._currentConfig.count)%10)];u.Util.speakEquation(e,function(e){t.emitLetterEnabledEvent(t._layout.node.getChildByName(t._originalLetterName+"0"),0)})}},e.prototype.createSprite=function(t,e,n){var i=e>25?cc.instantiate(this.b2):cc.instantiate(this.b1);i.scale=.75,t.addChild(i)},e.prototype.buildLayout=function(){var t=this;this._layout=this._words.getComponent(cc.Layout),this._layout.node.zIndex=2,this._layout.padding=20,this._layout.spacingX=125,this._layout.spacingY=0,this._layout.resizeMode=a.ResizeMode.CONTAINER,this._words.scale=l.LETTER_SCALE,this._characters.forEach(function(e,i){var o=cc.instantiate(t.singleLetterPrefab);o.height=n.TRACE_HEIGHT,o.scale=1.25,t._originalLetterName=o.name,o.name=t._originalLetterName+i;var r=o.getComponent(l.SingleNumberTracing);r.tracingScale=.75,r.wordTracingContainer=t.node,r.order=i,r.letter=e,t._layout.node.addChild(o),0===i&&(t._currentLetterIndex=i)}),this._layout.updateLayout()},e.prototype.buildGrid=function(){this._animLayout=this._anims.getComponent(cc.Layout),this._animLayout.node.zIndex=1,this._animLayout.node.setPosition(new cc.Vec2(cc.winSize.width/2,0)),this._animLayout.resizeMode=a.ResizeMode.CHILDREN,this.adjustLayout(Number(this._currentConfig.count)),this._animLayout.updateLayout()},e.prototype.adjustLayout=function(t){if(t<=25){this._animLayout.spacingX=0,this._animLayout.cellSize=new cc.Size(176,30);var e=176*Math.floor(t/5)+10*Math.floor(t/5)+176;this._anims.width=e,this._anims.height=160,this.generateSprites(t)}else{this._animLayout.cellSize=new cc.Size(20,20),this._animLayout.spacingX=10;e=20*Math.floor(t/10)+10*Math.floor(t/10)+20;this._anims.width=e,this._anims.height=210,this.generateSprites(t)}},e.prototype.buildNumbersWithGrid=function(){this.buildGrid(),this.buildLayout(),this._words.width=cc.winSize.width,this._words.height=cc.winSize.height/2,this._words.setPosition(new cc.Vec2(50,25)),this._anims.setPosition(new cc.Vec2(0,250))},e.prototype.generateSprites=function(t){for(var e=0;e<t;e++)this.createSprite(this._animLayout.node,t,e+1)},e.prototype.subScribeToTracingEvents=function(){var t=this;this.node.on(p.TRACING_FINISHED,function(e){e.stopPropagation(),t.tracingFinished()}),this.node.on(p.TRACING_CORRECT,function(e){e.stopPropagation(),t.node.emit("correct")}),this.node.on(p.TRACING_WRONG,function(e){e.stopPropagation(),t.node.emit("wrong")})},e.prototype.emitLetterEnabledEvent=function(t,e){t.emit("letterEnabledEvent",e,1)},e.prototype.tracingFinished=function(){this.pronounceAndTrigger()},e.prototype.individualLetterSound=function(){this._characters.length>1&&this._layout.node.getChildByName(this._originalLetterName+(this._currentLetterIndex-1)).getComponent(l.SingleNumberTracing).pronounce()},e.prototype.pronounceAndTrigger=function(){var t=this;this._currentLetterIndex++,this.individualLetterSound(),this._currentLetterIndex===this._characters.length?this.scheduleOnce(function(){t.node.emit("nextProblem")},1):this.emitLetterEnabledEvent(this._layout.node.getChildByName(this._originalLetterName+this._currentLetterIndex),this._currentLetterIndex)},e.prototype.processConfiguration=function(t){void 0===t&&(t=[]);var e=[].concat.apply([],t),n=e[0],i=e[1],o=e[2],r=e[3];return this._characters=Array.from(r),{level:n,workSheet:i,problemNo:o,count:r}},e.prototype.onDestroy=function(){cc.audioEngine.stopAllEffects()},e.prototype.updateSpeakCount=function(){this._speakCount++},Object.defineProperty(e.prototype,"speakCount",{get:function(){return this._speakCount},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"touchAllowedOnAnimLayout",{get:function(){return this._touchAllowedOnAnimLayout},enumerable:!1,configurable:!0}),o([c(cc.Prefab)],e.prototype,"wordsPrefab",void 0),o([c(cc.Prefab)],e.prototype,"animsPrefab",void 0),o([c(cc.Prefab)],e.prototype,"singleLetterPrefab",void 0),o([c(cc.Prefab)],e.prototype,"b1",void 0),o([c(cc.Prefab)],e.prototype,"b2",void 0),e=o([r],e)}(cc.Component);n.WriteSet=d,cc._RF.pop()},{"../../../common/scripts/helper":void 0,"../../../common/scripts/lib/config":void 0,"../../../common/scripts/util":void 0,"./singlenumbertracing":"singlenumbertracing"}]},{},["singlenumbertracing","writeset"]);