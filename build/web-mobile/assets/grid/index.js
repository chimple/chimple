window.__require=function t(o,e,n){function i(c,s){if(!e[c]){if(!o[c]){var l=c.split("/");if(l=l[l.length-1],!o[l]){var a="function"==typeof __require&&__require;if(!s&&a)return a(l,!0);if(r)return r(l,!0);throw new Error("Cannot find module '"+c+"'")}c=l}var d=e[c]={exports:{}};o[c][0].call(d.exports,function(t){return i(o[c][1][t]||t)},d,d.exports,t,o,e,n)}return e[c].exports}for(var r="function"==typeof __require&&__require,c=0;c<n.length;c++)i(n[c]);return i}({CommonBlock:[function(t,o,e){"use strict";cc._RF.push(o,"67f43WsyVpLZ7sWQJdjmnZ6","CommonBlock");var n=this&&this.__extends||function(){var t=function(o,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var e in o)o.hasOwnProperty(e)&&(t[e]=o[e])})(o,e)};return function(o,e){function n(){this.constructor=o}t(o,e),o.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}(),i=this&&this.__decorate||function(t,o,e,n){var i,r=arguments.length,c=r<3?o:null===n?n=Object.getOwnPropertyDescriptor(o,e):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,o,e,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(c=(r<3?i(c):r>3?i(o,e,c):i(o,e))||c);return r>3&&c&&Object.defineProperty(o,e,c),c};Object.defineProperty(e,"__esModule",{value:!0}),e.DEFAULT_FONT_COLOR=void 0;var r=cc._decorator.property,c=cc.Label.Overflow,s=t("../../../common/scripts/lib/error-handler"),l=t("../../../common/scripts/chimple-label");e.DEFAULT_FONT_COLOR=cc.Color.BLACK;var a=function(t){function o(){var o=null!==t&&t.apply(this,arguments)||this;return o.textFont=null,o.slotSelectedPrefab=null,o._contentText=null,o._fontSize=null,o._fontColor=null,o._questionSound=null,o.highlightNode=null,o._isHighlightNodePresent=!1,o}return n(o,t),Object.defineProperty(o.prototype,"contentText",{get:function(){return this._contentText},set:function(t){this._contentText=t},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"fontSize",{get:function(){return this._fontSize},set:function(t){this._fontSize=t},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"fontColor",{get:function(){return this._fontColor},set:function(t){this._fontColor=t},enumerable:!1,configurable:!0}),o.prototype.createLabelNode=function(t,o,n,i,r){void 0===o&&(o=""),void 0===n&&(n="10"),void 0===i&&(i=null),void 0===r&&(r=!0);var s=new cc.Node(o),a=s.addComponent(l.default);a.string=r?o:"",a.font=t,a.overflow=c.NONE;var d=e.DEFAULT_FONT_COLOR;i&&(d=d.fromHEX(i)),s.color=d,s.addComponent(cc.LabelOutline).width=3;var h=parseInt(n);return a.fontSize=h,a.lineHeight=h,s.position=new cc.Vec2(0,.1*h),s},o.prototype.getRandom=function(t,o){return Math.random()*(o-t)+t},o.prototype.addHighLightedNode=function(){!this._isHighlightNodePresent&&this.highlightNode&&(this._isHighlightNodePresent=!0,this.highlightNode.width=this.node.width,this.highlightNode.height=this.node.height,this.node.addChild(this.highlightNode))},o.prototype.removeHighLightedNode=function(){this._isHighlightNodePresent&&this.highlightNode&&(this._isHighlightNodePresent=!1,this.node.removeChild(this.highlightNode))},i([r({type:cc.Font})],o.prototype,"textFont",void 0),i([r(cc.Prefab)],o.prototype,"slotSelectedPrefab",void 0),i([s.default()],o.prototype,"createLabelNode",null),i([s.default()],o.prototype,"addHighLightedNode",null),i([s.default()],o.prototype,"removeHighLightedNode",null),o}(cc.Component);e.default=a,cc._RF.pop()},{"../../../common/scripts/chimple-label":void 0,"../../../common/scripts/lib/error-handler":void 0}],answerblock:[function(t,o,e){"use strict";cc._RF.push(o,"736a5xa/ABAMYiLpVMzh3hK","answerblock");var n=this&&this.__extends||function(){var t=function(o,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var e in o)o.hasOwnProperty(e)&&(t[e]=o[e])})(o,e)};return function(o,e){function n(){this.constructor=o}t(o,e),o.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}(),i=this&&this.__decorate||function(t,o,e,n){var i,r=arguments.length,c=r<3?o:null===n?n=Object.getOwnPropertyDescriptor(o,e):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,o,e,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(c=(r<3?i(c):r>3?i(o,e,c):i(o,e))||c);return r>3&&c&&Object.defineProperty(o,e,c),c};Object.defineProperty(e,"__esModule",{value:!0});var r=t("./CommonBlock"),c=t("./grid"),s=t("./wordblock"),l=t("./questionblock"),a=t("../../../common/scripts/util"),d=t("../../../common/scripts/lib/config"),h=cc.Vec2,u=t("../../../common/scripts/lib/error-handler"),p=cc._decorator,f=p.ccclass,g=p.property,_=function(t){function o(){var o=null!==t&&t.apply(this,arguments)||this;return o.originalPosition=new h(0,0),o.finishPosition=new h(0,0),o.matchRect=null,o.match=!1,o.moved=!1,o._sound=null,o._explode=null,o._startPos=null,o._isRTL=!1,o.wrongMoveAudio=null,o.rightMoveAudio=null,o.problemClear=null,o.explodeParticle=null,o.questionBlocksMap=new Map,o}return n(o,t),o.prototype.onLoad=function(){var t=this;this.node.on(c.TouchEvents.TOUCH_START,this.onTouchStart,this),this.node.on(c.TouchEvents.TOUCH_END,this.onTouchEnd,this),this.node.on(c.TouchEvents.TOUCH_MOVE,this.onTouchMove,this),this.node.on(c.TouchEvents.TOUCH_CANCEL,this.onTouchEnd,this),this.fontColor="#654321";var o=this.createLabelNode(this.textFont,this.contentText,this.fontSize,this.fontColor);this._isRTL=d.default.i.direction==d.Direction.RTL,this._isRTL?(this.node.scaleX*=-c.SCALE,this.node.scaleY*=c.SCALE):this.node.scale*=c.SCALE,this.node.addChild(o),this.node.width=c.Grid._maxNodeWidth,this.node.height=c.Grid._maxNodeHeight,this.highlightNode=cc.instantiate(this.slotSelectedPrefab),a.Util.loadGameSound(this.contentText,function(o){t._sound=o})},o.prototype.start=function(){var t=this.contentText+c.PLACEHOLDER_PAIR,o=this.node.parent.getChildByName("ground");this.pairingPlaceHolderBlock=o.getChildByName(t).getComponent(s.default);var e=this.pairingPlaceHolderBlock.node.getBoundingBox();this.matchRect=cc.Rect.fromMinMax(cc.v2(e.x+40,e.y+40),cc.v2(e.x+e.width-40,e.y+e.height-40)),this.finishPosition=this.pairingPlaceHolderBlock.node.position;var n=cc.moveTo(.3,this.originalPosition);this.node.runAction(n)},o.prototype.checkRTLAndScale=function(t){return this._isRTL?-t*c.SCALE:t*c.SCALE},o.prototype.renderAnswerHolder=function(t){if(this.render(t),t.combinedQAndA){var o=t.content,e=[];t.combinedQAndA.split("-").map(function(t){e.push(t)}),this.questionBlocksMap.set(o,e)}},o.prototype.render=function(t){var o=t.xPositions[t.index];this.originalPosition=new h(o,-375),this.grid=t.wordMatrix,this.fontSize=c.FONT_SIZE,this.contentText=t.content,this.node.setPosition(this.originalPosition.x,this.originalPosition.y),t.parentNode.addChild(this.node)},o.prototype.onTouchStart=function(t){var o=this,e=this.node.getParent().convertToNodeSpaceAR(t.getLocation());this._startPos=e,this.match?(new cc.Tween).target(this.node).to(.1,{scaleX:this.checkRTLAndScale(1.1),scaleY:1.1*c.SCALE},{progress:null,easing:"sineOut"}).call(function(){o.speak()}).start():(this.moved=!1,(new cc.Tween).target(this.node).to(.1,{scaleX:this.checkRTLAndScale(1.1),scaleY:1.1*c.SCALE},{progress:null,easing:"sineOut"}).call(function(){o.speak()}).start())},o.prototype.speak=function(){try{this._sound?(this._soundID=a.Util.play(this._sound,!1),-1===this._soundID&&a.Util.speakPhonicsOrLetter(this.contentText,function(){})):a.Util.speakPhonicsOrLetter(this.contentText,function(){})}catch(t){}},o.prototype.onTouchMove=function(t){var o=this;this.moved=!0;var e=new cc.Vec2(1/c.MATRIX_CONTAINER_SCALE*t.getDelta().x,1/c.MATRIX_CONTAINER_SCALE*t.getDelta().y);(this.node.setPosition(this.node.position.add(cc.v2(this._isRTL?e.neg().x:e.x,e.y))),this.node.getBoundingBox().intersects(this.matchRect))?(this.match=!0,this.pairingPlaceHolderBlock.addHighLightedNode(),this.questionBlocksMap.get(this.contentText).forEach(function(t){o.node.parent.getChildByName("ground").getChildByName(t).getComponent(l.default).addHighLightedNode()})):(this.match=!1,this.pairingPlaceHolderBlock.removeHighLightedNode(),this.questionBlocksMap.get(this.contentText).forEach(function(t){o.node.parent.getChildByName("ground").getChildByName(t).getComponent(l.default).removeHighLightedNode()}));(new cc.Tween).target(this.node).call(function(){cc.audioEngine.stopEffect(o._sound)}).to(.15,{scaleX:this.checkRTLAndScale(1),scaleY:c.SCALE},{progress:null,easing:"sineOut"}).start()},o.prototype.onTouchEnd=function(t){var o=this.node.getParent().convertToNodeSpaceAR(t.getLocation()).sub(this._startPos);(new cc.Tween).target(this.node).to(.15,{scaleX:this.checkRTLAndScale(1),scaleY:c.SCALE},{progress:null,easing:"sineOut"}).start();var e=o.magSqr()>=50;this.match?this.matchFound():(this.match=!1,this.matchNotFound(e))},o.prototype.matchFound=function(){var t=this;this.match=!0,this.node.off(c.TouchEvents.TOUCH_MOVE),this.node.off(c.TouchEvents.TOUCH_END),this.node.parent.emit("correct"),this.moveToPos(this.finishPosition).call(function(){t.removeHighLightedNode(),t.sparkle(),t.rightMoveAudio&&a.Util.playSfx(t.rightMoveAudio),t.grid.scheduleOnce(function(){t.unSparkle(),t.grid.wordMatched(t.contentText)},.5),t.questionBlocksMap.get(t.contentText).forEach(function(o){t.node.parent.getChildByName("ground").getChildByName(o).getComponent(l.default).removeHighLightedNode()}),t.moved=!1}).start()},o.prototype.matchNotFound=function(t){var o=this;this.moveToPos(this.originalPosition).call(function(){o.moved&&t&&(o.wrongMoveAudio&&a.Util.playSfx(o.wrongMoveAudio),o.node.parent.emit("wrong"),o.moved=!1)}).start()},o.prototype.moveToPos=function(t){return(new cc.Tween).target(this.node).to(.25,{position:this.node.position,scaleX:this.checkRTLAndScale(1),scaleY:c.SCALE},{progress:null,easing:"elasticOut"}).to(.15,{position:t},{progress:null,easing:"quadOut"})},o.prototype.onDestroy=function(){cc.audioEngine.stopAllEffects()},o.prototype.sparkle=function(){this._explode=cc.instantiate(this.explodeParticle),this._explode.position=this.node.position,this.node.parent.addChild(this._explode)},o.prototype.unSparkle=function(){null!=this._explode&&(this.node.removeChild(this._explode),this._explode=null)},i([g({type:cc.AudioClip})],o.prototype,"wrongMoveAudio",void 0),i([g({type:cc.AudioClip})],o.prototype,"rightMoveAudio",void 0),i([g({type:cc.AudioClip})],o.prototype,"problemClear",void 0),i([g(cc.Prefab)],o.prototype,"explodeParticle",void 0),i([u.default()],o.prototype,"onLoad",null),i([u.default()],o.prototype,"start",null),i([u.default()],o.prototype,"checkRTLAndScale",null),i([u.default()],o.prototype,"renderAnswerHolder",null),i([u.default()],o.prototype,"render",null),i([u.default()],o.prototype,"onTouchStart",null),i([u.default()],o.prototype,"speak",null),i([u.default()],o.prototype,"onTouchMove",null),i([u.default()],o.prototype,"onTouchEnd",null),i([u.default()],o.prototype,"matchFound",null),i([u.default()],o.prototype,"matchNotFound",null),i([u.default()],o.prototype,"moveToPos",null),i([u.default()],o.prototype,"sparkle",null),i([u.default()],o.prototype,"unSparkle",null),o=i([f],o)}(r.default);e.default=_,cc._RF.pop()},{"../../../common/scripts/lib/config":void 0,"../../../common/scripts/lib/error-handler":void 0,"../../../common/scripts/util":void 0,"./CommonBlock":"CommonBlock","./grid":"grid","./questionblock":"questionblock","./wordblock":"wordblock"}],grid:[function(t,o,e){"use strict";cc._RF.push(o,"3ca74VIctlE4JZY6uSw5DYe","grid");var n=this&&this.__extends||function(){var t=function(o,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var e in o)o.hasOwnProperty(e)&&(t[e]=o[e])})(o,e)};return function(o,e){function n(){this.constructor=o}t(o,e),o.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}(),i=this&&this.__decorate||function(t,o,e,n){var i,r=arguments.length,c=r<3?o:null===n?n=Object.getOwnPropertyDescriptor(o,e):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,o,e,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(c=(r<3?i(c):r>3?i(o,e,c):i(o,e))||c);return r>3&&c&&Object.defineProperty(o,e,c),c};Object.defineProperty(e,"__esModule",{value:!0}),e.Grid=e.TouchEvents=e.BLOCK_TYPE=e.PLACEHOLDER_PAIR=e.FONT_SIZE=e.HALF=e.SCALE=e.MATRIX_CONTAINER_SCALE=e.V_MARGIN=e.H_MARGIN=e.H_GAP=e.V_GAP=e.GAME_SOUND=void 0;var r,c=cc._decorator.ccclass,s=cc._decorator.property,l=t("../../../common/scripts/lib/config"),a=t("./answerblock"),d=t("./wordblock"),h=cc.Vec2,u=t("./questionblock"),p=t("../../../common/scripts/util"),f=t("../../../common/scripts/lib/error-handler");e.GAME_SOUND="games/grid/sound/",e.V_GAP=18,e.H_GAP=20,e.H_MARGIN=50,e.V_MARGIN=30,e.MATRIX_CONTAINER_SCALE=.85,e.SCALE=1,e.HALF=.5,e.FONT_SIZE="65",e.PLACEHOLDER_PAIR="-PAIR",function(t){t[t.H_QUESTION=0]="H_QUESTION",t[t.V_QUESTION=1]="V_QUESTION",t[t.ANSWER=2]="ANSWER",t[t.PLACEHOLDER=3]="PLACEHOLDER"}(r=e.BLOCK_TYPE||(e.BLOCK_TYPE={})),function(t){t.TOUCH_START="touchstart",t.TOUCH_END="touchend",t.TOUCH_MOVE="touchmove",t.TOUCH_CANCEL="touchCancel"}(e.TouchEvents||(e.TouchEvents={}));var g=function(t){function o(){var o=null!==t&&t.apply(this,arguments)||this;return o.groundPrefab=null,o.questionBlockPrefab=null,o.answerBlockPrefab=null,o.wordBlockPrefab=null,o.gameLoadAudio=null,o.currentConfig=null,o._remainingAnswers=[],o._matchedCounterInCurrentRun=0,o._helpDragNode=null,o._helpDropNode=null,o._isRTL=!1,o}var g;return n(o,t),g=o,o.prototype.onLoad=function(){var t=this;g._horizontalPositions=[],g._verticalPositions=[],this.currentConfig=this.processConfiguration(l.default.getInstance().data[0]),this._isRTL=l.default.i.direction==l.Direction.RTL,p.Util.playSfx(this.gameLoadAudio),null!==this.currentConfig&&(this.matrixContainer=this.node,this._isRTL?(this.matrixContainer.scaleX*=-e.MATRIX_CONTAINER_SCALE,this.matrixContainer.scaleY*=e.MATRIX_CONTAINER_SCALE):this.matrixContainer.scale*=e.MATRIX_CONTAINER_SCALE,this.currentConfig.horizontalProblem=this.currentConfig.horizontalProblem,this.currentConfig.verticalProblem=this.shuffle(this.currentConfig.verticalProblem),this.buildGround(),this.renderWordMatrix(this.mapToWordMatrixElements(this.currentConfig.horizontalProblem),this.questionBlockPrefab,r.H_QUESTION),this.renderWordMatrix(this.mapToWordMatrixElements(this.currentConfig.verticalProblem),this.questionBlockPrefab,r.V_QUESTION),this.buildAnswersAndPlaceHolders(this.currentConfig.horizontalProblem,this.currentConfig.verticalProblem,this.currentConfig.aHorizontalProblem),this.scheduleOnce(function(){p.Util.showHelp(t._helpDragNode,t._helpDropNode)},.5))},o.prototype.mapToWordMatrixElements=function(t){return t.map(function(t){return{text:t}})},o.prototype.processConfiguration=function(t){void 0===t&&(t=[]);var o=[].concat.apply([],t),e=o[0],n=o[1],i=o[2],r=o[3],c=o[4],s=o[5],l=s||c;return{level:e,workSheet:n,problemNo:i,verticalProblem:this.shuffle(r.split(",")),horizontalProblem:c.split(","),aHorizontalProblem:l.split(",")}},o.prototype.getRandom=function(t,o){return Math.random()*(o-t)+t},o.prototype.buildGround=function(){var t=this.currentConfig.horizontalProblem.length,o=this.currentConfig.verticalProblem.length,n=this.currentConfig.horizontalProblem.reduce(function(t,o){return t.length>o.length?t:o}),i=this.currentConfig.verticalProblem.reduce(function(t,o){return t.length>o.length?t:o}),r=cc.instantiate(this.questionBlockPrefab).getComponent(u.default),c=r.createLabelNode(r.textFont,n+i+i+i,e.FONT_SIZE,"#654321");this._isRTL?(c.scaleX=-e.SCALE,c.scaleY=e.SCALE):c.scale=e.SCALE,g._maxNodeWidth=c.getBoundingBox().width+1.3*e.H_MARGIN,g._maxNodeHeight=c.getBoundingBox().height+e.V_MARGIN,this._ground=cc.instantiate(this.groundPrefab);var s=5*e.V_MARGIN+g._maxNodeWidth+t*g._maxNodeWidth,l=8*e.V_MARGIN+g._maxNodeHeight+o*g._maxNodeHeight;this.ground.setContentSize(new cc.Size(s,l)),this.matrixContainer.addChild(this.ground)},o.prototype.renderWordMatrix=function(t,o,e){var n=this,i=t.length;t.forEach(function(t,c){var s=JSON.parse(JSON.stringify(t)),l=cc.instantiate(o);switch(e){case r.H_QUESTION:case r.V_QUESTION:var h=l.getComponent(u.default),p={wordMatrix:n,parentNode:n.ground,content:s.text,blockType:e,index:c,totalBlocks:i};h.render(p);break;case r.ANSWER:var f=l.getComponent(a.default),g={wordMatrix:n,parentNode:n.matrixContainer,content:s.text,combinedQAndA:s.questionRelatedText,blockType:e,index:c,totalBlocks:i,xPositions:s.xPositions};f.renderAnswerHolder(g),0===c&&(n._helpDragNode=l);break;case r.PLACEHOLDER:var _=l.getComponent(d.default),m={wordMatrix:n,parentNode:n.ground,content:s.placeHolderText,blockType:e,index:c,totalBlocks:i,position:s.placeHolderPosition};_.render(m),0===c&&(n._helpDropNode=l)}})},o.prototype.flattenDeep=function(t){var o=this;return t.reduce(function(t,e){return Array.isArray(e)?t.concat(o.flattenDeep(e)):t.concat(e)},[])},o.prototype.buildAnswersAndPlaceHolders=function(t,o,e){this._remainingAnswers=this.computeAnswers(t,o,e),this.renderWordMatrix(this._remainingAnswers,this.wordBlockPrefab,r.PLACEHOLDER),this.renderWordMatrix(this.slices(this._remainingAnswers,t.length),this.answerBlockPrefab,r.ANSWER)},o.prototype.computeAnswers=function(t,o,n){console.log("horizontalConfigs",t),console.log("aHorizontalConfigs",n);var i=this.flattenDeep(o.map(function(o,i){return t.map(function(t,r){return{text:o+n[r],placeHolderPosition:new h(g._horizontalPositions[r],g._verticalPositions[i]),placeHolderText:o+n[r]+e.PLACEHOLDER_PAIR,questionRelatedText:o+"-"+t,xPositions:Array.from(new Set(g._horizontalPositions))}})}));return this.shuffle(i)},o.prototype.slices=function(t,o){return this._matchedCounterInCurrentRun=0,t.slice(0,o)},o.prototype.shuffle=function(t){for(var o,e,n=t.length;n>0;)e=Math.floor(Math.random()*n),o=t[--n],t[n]=t[e],t[e]=o;return t},o.addToHorizontalPositions=function(t){g._horizontalPositions.push(t)},o.addToVerticalPositions=function(t){g._verticalPositions.push(t)},Object.defineProperty(o.prototype,"ground",{get:function(){return this._ground},enumerable:!1,configurable:!0}),o.prototype.wordMatched=function(t){this._matchedCounterInCurrentRun++,this._remainingAnswers=this._remainingAnswers.filter(function(o){return o.text!==t}),this._remainingAnswers.length<=0?this.node.emit("nextProblem"):this._matchedCounterInCurrentRun===this.currentConfig.horizontalProblem.length&&this.renderWordMatrix(this.slices(this._remainingAnswers,this.currentConfig.horizontalProblem.length),this.answerBlockPrefab,r.ANSWER)},o._maxNodeWidth=0,o._maxNodeHeight=0,o._horizontalPositions=[],o._verticalPositions=[],i([s(cc.Prefab)],o.prototype,"groundPrefab",void 0),i([s(cc.Prefab)],o.prototype,"questionBlockPrefab",void 0),i([s(cc.Prefab)],o.prototype,"answerBlockPrefab",void 0),i([s(cc.Prefab)],o.prototype,"wordBlockPrefab",void 0),i([s({type:cc.AudioClip})],o.prototype,"gameLoadAudio",void 0),i([f.default()],o.prototype,"onLoad",null),i([f.default()],o.prototype,"mapToWordMatrixElements",null),i([f.default()],o.prototype,"buildGround",null),i([f.default()],o.prototype,"renderWordMatrix",null),i([f.default()],o.prototype,"buildAnswersAndPlaceHolders",null),i([f.default()],o.prototype,"computeAnswers",null),i([f.default()],o.prototype,"slices",null),i([f.default()],o.prototype,"wordMatched",null),o=g=i([c],o)}(cc.Component);e.Grid=g,cc._RF.pop()},{"../../../common/scripts/lib/config":void 0,"../../../common/scripts/lib/error-handler":void 0,"../../../common/scripts/util":void 0,"./answerblock":"answerblock","./questionblock":"questionblock","./wordblock":"wordblock"}],ground:[function(t,o,e){"use strict";cc._RF.push(o,"16f0fFVfwRFAojrnIPvN0ch","ground");var n=this&&this.__extends||function(){var t=function(o,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var e in o)o.hasOwnProperty(e)&&(t[e]=o[e])})(o,e)};return function(o,e){function n(){this.constructor=o}t(o,e),o.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}(),i=this&&this.__decorate||function(t,o,e,n){var i,r=arguments.length,c=r<3?o:null===n?n=Object.getOwnPropertyDescriptor(o,e):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,o,e,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(c=(r<3?i(c):r>3?i(o,e,c):i(o,e))||c);return r>3&&c&&Object.defineProperty(o,e,c),c};Object.defineProperty(e,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,s=(r.property,function(t){function o(){return null!==t&&t.apply(this,arguments)||this}return n(o,t),o=i([c],o)}(cc.Component));e.default=s,cc._RF.pop()},{}],questionblock:[function(t,o,e){"use strict";cc._RF.push(o,"fec20HTyIZFwZJfUjwQdlER","questionblock");var n=this&&this.__extends||function(){var t=function(o,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var e in o)o.hasOwnProperty(e)&&(t[e]=o[e])})(o,e)};return function(o,e){function n(){this.constructor=o}t(o,e),o.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}(),i=this&&this.__decorate||function(t,o,e,n){var i,r=arguments.length,c=r<3?o:null===n?n=Object.getOwnPropertyDescriptor(o,e):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,o,e,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(c=(r<3?i(c):r>3?i(o,e,c):i(o,e))||c);return r>3&&c&&Object.defineProperty(o,e,c),c};Object.defineProperty(e,"__esModule",{value:!0});var r=t("./CommonBlock"),c=t("./grid"),s=cc._decorator.property,l=t("../../../common/scripts/lib/config"),a=t("../../../common/scripts/util"),d=t("../../../common/scripts/lib/error-handler"),h=cc._decorator.ccclass,u=function(t){function o(){var o=null!==t&&t.apply(this,arguments)||this;return o.slotSelectedPrefab=null,o.highlightNode=null,o._isHighlightNodePresent=!1,o._sound=null,o._isRTL=!1,o}return n(o,t),o.prototype.onLoad=function(){var t=this;this.node.on(c.TouchEvents.TOUCH_START,this.onTouchStart,this),this.node.on(c.TouchEvents.TOUCH_MOVE,this.onTouchMove,this),this.node.on(c.TouchEvents.TOUCH_END,this.onTouchEnd,this),this.node.on(c.TouchEvents.TOUCH_CANCEL,this.onTouchEnd,this),this.fontColor="#654321";var o=this.createLabelNode(this.textFont,this.contentText,this.fontSize,this.fontColor);this.node.addChild(o),this.highlightNode=cc.instantiate(this.slotSelectedPrefab),this._isRTL=l.default.i.direction==l.Direction.RTL,a.Util.loadGameSound(this.contentText,function(o){t._sound=o}),this._isRTL&&(this.node.scaleX=-1)},o.prototype.onTouchMove=function(t){var o=t.getLocation(),e=this.node.getParent().convertToNodeSpaceAR(o);this.node.getBoundingBox().contains(e)||this.touchEnded()},o.prototype.onTouchStart=function(t){var o=this;(new cc.Tween).target(this.node).call(function(){o.addHighLightedNode(),o.speak()}).to(.15,{scaleX:this.checkRTLAndScale(1.1),scaleY:1.1*c.SCALE},{progress:null,easing:"sineOut"}).start()},o.prototype.speak=function(){try{this._sound?(this._soundID=a.Util.play(this._sound,!1),-1===this._soundID&&a.Util.speakPhonicsOrLetter(this.contentText,function(){})):a.Util.speakPhonicsOrLetter(this.contentText,function(){})}catch(t){}},o.prototype.onTouchEnd=function(t){this.touchEnded()},o.prototype.touchEnded=function(){var t=this;(new cc.Tween).target(this.node).to(.15,{scaleX:this.checkRTLAndScale(1.1),scaleY:1.1*c.SCALE},{progress:null,easing:"sineOut"}).call(function(){t.removeHighLightedNode()}).start()},o.prototype.checkRTLAndScale=function(t){return t*c.SCALE*(this._isRTL?-1:1)},o.prototype.render=function(t){this.node.name=t.content,this.contentText=t.content,this.node.width=c.Grid._maxNodeWidth,this.node.height=c.Grid._maxNodeHeight,this.fontSize=c.FONT_SIZE,this.node.scale*=c.SCALE;var o,e=0;switch(t.blockType){case c.BLOCK_TYPE.H_QUESTION:var n=parseFloat(((t.index+1)/(t.totalBlocks+1)).toFixed(2));o=t.parentNode.getBoundingBox().width*(this.node.anchorX-n)+.5*this.node.getBoundingBox().width,e=t.parentNode.getBoundingBox().height*c.HALF-2.35*c.V_MARGIN,this.node.setPosition(o,e),c.Grid.addToHorizontalPositions(o);break;case c.BLOCK_TYPE.V_QUESTION:this.node.width-=c.H_MARGIN;n=parseFloat(((t.index+1)/(t.totalBlocks+1)).toFixed(2));o=t.parentNode.getBoundingBox().x+this.node.getBoundingBox().width*c.HALF+c.H_MARGIN,e=t.parentNode.getBoundingBox().height*(this.node.anchorY-n)-.7*this.node.getBoundingBox().height,this.node.setPosition(o,e),c.Grid.addToVerticalPositions(e)}t.parentNode.addChild(this.node)},o.prototype.onDestroy=function(){cc.audioEngine.stopAllEffects()},i([s(cc.Prefab)],o.prototype,"slotSelectedPrefab",void 0),i([d.default()],o.prototype,"onLoad",null),i([d.default()],o.prototype,"speak",null),i([d.default()],o.prototype,"checkRTLAndScale",null),i([d.default()],o.prototype,"render",null),o=i([h],o)}(r.default);e.default=u,cc._RF.pop()},{"../../../common/scripts/lib/config":void 0,"../../../common/scripts/lib/error-handler":void 0,"../../../common/scripts/util":void 0,"./CommonBlock":"CommonBlock","./grid":"grid"}],wordblock:[function(t,o,e){"use strict";cc._RF.push(o,"838aexRwfVPA6gdgGhMuC9w","wordblock");var n=this&&this.__extends||function(){var t=function(o,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var e in o)o.hasOwnProperty(e)&&(t[e]=o[e])})(o,e)};return function(o,e){function n(){this.constructor=o}t(o,e),o.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}(),i=this&&this.__decorate||function(t,o,e,n){var i,r=arguments.length,c=r<3?o:null===n?n=Object.getOwnPropertyDescriptor(o,e):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,o,e,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(c=(r<3?i(c):r>3?i(o,e,c):i(o,e))||c);return r>3&&c&&Object.defineProperty(o,e,c),c};Object.defineProperty(e,"__esModule",{value:!0});var r=t("./CommonBlock"),c=t("./grid"),s=t("../../../common/scripts/lib/config"),l=t("../../../common/scripts/lib/error-handler"),a=cc._decorator,d=a.ccclass,h=(a.property,function(t){function o(){return null!==t&&t.apply(this,arguments)||this}return n(o,t),o.prototype.onLoad=function(){this.fontColor="#654321";var t=this.createLabelNode(this.textFont,this.contentText,this.fontSize,this.fontColor,!1);this.node.addChild(t),this.node.width=c.Grid._maxNodeWidth+c.H_GAP,this.node.height=c.Grid._maxNodeHeight+c.V_GAP,this.highlightNode=cc.instantiate(this.slotSelectedPrefab),s.default.i.direction==s.Direction.RTL&&(this.node.scaleX=-1)},o.prototype.render=function(t){this.fontSize=c.FONT_SIZE,this.node.name=t.content,this.contentText=t.content,this.node.setPosition(t.position.x,t.position.y),t.parentNode.addChild(this.node),s.default.i.direction==s.Direction.RTL&&(this.node.scaleX=-1)},i([l.default()],o.prototype,"onLoad",null),i([l.default()],o.prototype,"render",null),o=i([d],o)}(r.default));e.default=h,cc._RF.pop()},{"../../../common/scripts/lib/config":void 0,"../../../common/scripts/lib/error-handler":void 0,"./CommonBlock":"CommonBlock","./grid":"grid"}]},{},["CommonBlock","answerblock","grid","ground","questionblock","wordblock"]);